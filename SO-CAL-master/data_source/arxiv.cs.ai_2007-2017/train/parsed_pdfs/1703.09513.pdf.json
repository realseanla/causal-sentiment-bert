{
  "name" : "1703.09513.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Mining Best Closed Itemsets for Projection-antimonotonic Constraints in Polynomial Time",
    "authors" : [ "Aleksey Buzmakov", "Sergei O. Kuznetsov", "Amedeo Napoli" ],
    "emails" : [ "avbuzmakov@hse.ru,", "skuznetsov@hse.ru,", "amedeo.napoli@loria.fr" ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "Interestingness measures were proposed to overcome the problem of combinatorial explosion of the number of valid patterns that can be discovered in a\n1\nar X\niv :1\n70 3.\n09 51\n3v 1\ndataset [VT14]. For example, pattern support, i.e., the number of transactions covered by the pattern, is one of the most famous measures of pattern quality. In particular, support satisfies the property of anti-monotonicity (aka “a priori principle”), i.e., the larger the pattern is the smaller the support is [MTV94, AS94]. Many other measures can be mentioned such as pattern stability [Kuz07, ROK08], margin closeness [MTU11], MCCS [SDB13], cosine interest [CWW14], pattern robustness [TMC14], etc.\nSome of these measures (e.g., support, robustness for generators [TMC14], or upper bound constraint of MCCS [SDB13]) are “globally anti-monotonic”, i.e., for any two patterns X v Y (where v stays for containment or subsumption relation in the pattern language) we have M(X) ≥ M(Y ), where M is a measure. When a measure is anti-monotonic, it is relatively easy to find patterns whose measure is higher than a certain threshold (e.g. patterns with a support higher than a threshold). In contrast some other measures are called “locally anti-monotonic”, i.e., for any pattern X there is an immediate subpattern Y ≺ X such that M(Y ) ≥ M(X). The corresponding constraint induces an accessible system [BHPW10] in itemset data. Indeed, for any itemset selected by a locally anti-monotonic constraint, one can always find a smaller selected itemset different only in one item. The good strategy in this case is extension of a pattern Y only to patterns X such that M(X) ≤ M(Y ). For example, cosine interest [CWW14] is “locally anti-monotonic,” some other examples can be found in [BHPW10].\nThe most difficult case is when a nonmonotonic measure is not even locally anti-monotonic. The valid patterns can be selected by postpruning, i.e., by finding a (large) set of patterns satisfying an anti-monotonic constraint and pruning them w.r.t. the chosen nonmonotonic measure [ROK08, MTU11, TMC14]. For that one can rely on certain heuristics such as the one used in leap search [YCHY08]. More elaborated approaches allow constructing a measure from (anti-)monotonic primitives [SC05, CRB08]. These approaches find a good anti-monotonic relaxation of the measure for the dataset in hand. Another interesting approach for dealing with non-monotonic constraints is search for a closure operator on the set of patterns adequate for the constraint in question [SC08].\nIn this paper we deal with a recently introduced algorithm Σοφια, i.e. Sofia, for “Searching for Optimal Formal Intents Algorithm”. Σοφια was applied for an interval-tuple data [BKN15]. In this paper we apply Σοφια for extracting the best itemsets w.r.t. a wide class of constraints. We introduce the polynomial version of the algorithm by accordingly adjusting the threshold and deeply studying the properties of the involved measures. Our algorithm is applicable to a class of measures called “projection-antimonotonic measures” or more precisely “measures anti-monotonic w.r.t. a chain of projections”. This class includes globally anti-monotonic measures such as support, locally anti-monotonic measures such as cosine interest and some of the nonmonotonic measures such as stability or robustness of closed patterns. We should notice that this class of measures is not covered by the previously introduced approaches. In particular, for the primitive-based approaches [SC05, CRB08] it is not clear how one can\nexpress certain measures from our class, e.g., stability and robustness, by means of the primitives. On the other hand, the approach for finding adequate closure [SC08] could be applied for stability and robustness, but the number of classes of equivalences that should be enumerated is likely to be high and accordingly the efficiency of the approach is likely to be low. Furthermore, neither of these approaches ensure a polynomial complexity of the algorithm.\nIn the experimental part of the paper we show that Σοφια can be efficiently used to mine itemesets w.r.t. a constraint based on Δ-measure, a polynomially computable analog of stability and robustness. It significantly outperforms the postpruning approaches based on best known algorithms for mining closed itemsets. We should mention that comparison of Σοφια with primitive-based approaches or with the approach for finding adequate closure is not possible since it requires a heavy study of efficiently expressing stability and robustness in terms of the primitives.\nIn the rest of the paper we work with itemsets and accordingly we use the word ’itemset’ instead of ’pattern’. The remainder of the paper is organized as follows. Since the lattice of closed itemsets (concept lattice) is of high importance for concise representation of itemsets [PBTL99], we use the language of Formal Concept Analysis (FCA) [GW99] and pattern structures [GK01] which are introduced in Section 2. Then, Σοφια algorithm is detailed in Section 3 for projection-antimonotonic measures. In the next section we discuss cosine interest, robustness, and stability that are examples of such measures. Experiments and a discussion on Σοφια efficiency are proposed in Section 5, before the conclusion."
    }, {
      "heading" : "2 Preliminaries",
      "text" : ""
    }, {
      "heading" : "2.1 Binary Dataset",
      "text" : "FCA is a very convenient formalism for describing models of itemset mining and knowledge discovery [GW99]. Since [PBTL99] lattices of closed itemsets (concept lattices) and closed descriptions are used for concise representation of association rules. FCA gives a formalism for itemset mining. For more complex data such as sequences, graphs, interval tuples, and logical formulas one can use an extension of the basic model, called pattern structures [GK01]. With pattern structures one defines closed descriptions that give a concise representation of association rules for different types of descriptions with a partial order of “partwhole” (e.g., subgraph isomorphism order) or “is a” (e.g., “class-subclass”) giving rise to a semilattical similarity operation u [KS05, KKN11].\nA binary dataset is a triple D = (T, I, R), where T is a set of transaction identifiers, I is a set of items and R ⊆ T × I is incidence relation giving information about items related to every transaction. A pattern structure or a (general) dataset is a triple (T, (D,u), δ), where (D,u) is a semilattice of “descriptions” with similarity operation u inducing natural partial order (D,v) given by x v y ⇔ x u y = x and δ : T → D is a mapping from transactions\nto their descriptions. Then, a binary dataset is (T, (2I ,∩), δ), where u is ∩, v is ⊆, and δ(t) = {i ∈ I | (t, i) ∈ R}. We use the pattern structure representation in order to iteratively modify the pattern space which is discussed later. Any subset of T is called a tidset and any subset of I is called an itemset. An example of a dataset is given in Figure 1a.\nThe following mappings give a Galois connection between the powerset of transactions and the semilattice of descriptions, e.g. (2I ,∩).\nd(A) := l\nt∈A δ(t), for A ⊆ T\nt(x) := {t ∈ T | x v δ(t)}, for x ∈ D\nIn case of a binary dataset, the mapping d(A) returns the maximal itemset common to all transactions in A, while the mapping t(x) returns the set of all transactions whose descriptions are supersets of x. One can define closure operators and the corresponding closed tidsets and closed descriptions: ct := t ◦ d and cd := d◦t are closure operators, while the closed tidset A and closed itemset x are given by ct(A) = A and cd(x) = x. As stated in [PBTL99], this type of closure (based on Galois connection and u operation) is equivalent for itemsets to the closure wrt. “counting inference”, which is common in data mining. However, the former definition unifies very important notions of “maximal common part”, closure, and lattices of closed patterns, so we shall keep to it in this paper.\nA concept of a dataset (T, (D,u), δ) is a pair (A, x), where A ⊆ T , called extent and x ⊂ I, called intent, such that d(A) = x and t(x) = A. In this case both A and x are closed tidset and itemset, respectively. The set of concepts is partially ordered w.r.t. inclusion on extents, i.e., (A1, x1) ≤ (A2, x2) iff A1 ⊆ A2 (or, equivalently, x2 v x1), forming a lattice. An example of a lattice corresponding to the binary dataset in Figure 1a is given in Figure 1b.\nIn the reminder we need some results from pattern structures for justifying our approach. Moreover, our approach is also applicable to more complex data given by general datasets (pattern structures). For example, Σοφια was successfully applied to interval-tuple datasets [BKN15]."
    }, {
      "heading" : "2.2 Projections of Datasets",
      "text" : "The approach proposed in this paper is based on projections introduced for reducing complexity of computing with pattern structures [GK01].\nA projection ψ : D → D is an “interior operator”, i.e., it is (1) monotone (x v y ⇒ ψ(x) v ψ(y)), (2) contractive (ψ(x) v x) and (3) idempotent (ψ(ψ(x)) = ψ(x)). A projected dataset ψ(D) = ψ((T, (D,u), δ)) is a dataset (T, (Dψ,uψ), ψ◦ δ), where ψ(D) = {x ∈ D | ∃x∗ ∈ D : ψ(x∗) = x} is the fixed set of ψ and ∀x, y ∈ D,x uψ y := ψ(x u y).\nIn the case of binary datasets projections correspond to removal of some items, with the respective change of the dataset (T, (2I ,∩), δ). The projection of an itemset X ⊆ I corresponding to removal of a set of items Y ⊆ I is given by\nψ(X) = X ∩ (I \\ Y ) = X \\ Y. (1)\nGiven a projection ψ we call ψ(D) = {x ∈ D | ψ(x) = x} the fixed set of ψ. The fixed set contains those itemsets that contain no items from the set Y (the set of removed items). The projections are ordered w.r.t. inclusion of the fixed points (or by inclusion of the sets of removed items in the case of binary data), i.e., ψ1 < ψ2, if ψ1(D) ⊆ ψ2(D), we say that ψ1 is simpler than ψ2 or that ψ2 is more detailed than ψ1.\nOur algorithm is based on this order on projections. The simpler a projection ψ is, the less itemsets we can find in ψ(D), and the less computational efforts one should take. Thus, we compute a set of itemsets for a simpler projection, then we remove unpromising itemsets, extend our dataset and the found itemsets with more items (to a more detailed projection). This allows us to reduce the size of the pattern space with a simpler projection and lower computational complexity."
    }, {
      "heading" : "3 Σοφια Algorithm",
      "text" : ""
    }, {
      "heading" : "3.1 Anti-monotonicity w.r.t. a Projection",
      "text" : "Our algorithm is based on the projection-antimonotonicity. Many interestingness measures for itemsets, e.g., stability [Kuz07], robustness of closed item-\nsets [TMC14], or cosine interest [CWW14], are not (anti-)monotonic w.r.t. inclusion order on itemsets. A measure M is called anti-monotonic if for two itemsets x v y, M(x) ≥ M(y). For instance, support is an anti-monotonic measure w.r.t. itemset inclusion order and it allows for efficient generation of itemsets with support larger than a threshold [AS94, MTV94, PBTL99]. The projection-antimonotonicity is a generalization of standard anti-monotonicity and allows for efficient processing a larger set of interestingness measures.\nGiven a projection ψ corresponding to the removal of items Y , preimages of an itemset X (we assume X ∩ Y = ∅) for ψ is the set of itemsets {Z} such that ψ(Z) = X. It can be seen that the set of preimages is given by Preimages(Y) = {Z ⊆ I | X ⊆ Z ⊆ X ∪ Y }. In particular X is also a preimage of itself.\nAn anti-monotonic measure M w.r.t. projection ψ (or just a projectionantimonotonic measure) is a measure which does not increase its value on any premiage of any itemset X for ψ. Since any preimage of X is a superset of X, then any anti-monotonic measure is also a projection-antimonotonic measure.\nExample 1. Let us consider the dataset in Figure 1a. If M is an interestingness measure w.r.t. a projection ψ and ψ removes item i5, then M({i3}) ≥ M({i3, i5}). However it is not necessary that M({i3}) ≥M({i3, i4}).\nThus, given a measure M anti-monotonic w.r.t. a projection ψ, if y is an itemset such that Mψ(y) < θ, then M(x) < θ for any preimage x of y for ψ. Hence, if, given an itemset y of ψ(D), one can find all itemsets x of D such that ψ(x) = y, it is possible to find the itemsets in ψ(D) and then to prune them w.r.t. Mψ, and finally to compute the preimages of the pruned set of itemsets only. It allows one to earlier cut unpromising branches of the search space or adjust a threshold for finding only a limited number of best itemsets.\nHowever, given just one projection, it can be hard to efficiently discover the best itemsets, since the projection is either hard to compute or the number of unpromising itemsets that can be pruned is not high. Corespondingly we need a chain of projections ψ0 < ψ1 < · · · < ψk = 1, where concepts for ψ0(D) can be easily computed and 1 is the identity projection, i.e., (∀x)1(x) = x. For example, to find frequent itemsets, we typically search for small frequent itemsets and then extend them to larger ones. It corresponds to the extension to a more detailed projection. In particular for binary dataset a chain of projections can be instantiated as a consequent update of a binary dataset with new items.\nChain of projections is a generalization of accessible system [BHPW10]. Given a set of items I and a subset of its powerset F ⊆ 2I , the system (I,F) is accessible if ∀X ∈ F \\ {∅} there is i ∈ I such that X \\ {i} ∈ F . Any constraint (or measure) on 2I produces a system of sets. If this system is accessible, then the measure is locally anti-monotonic.\nProposition 1. A chain of projections can be represented as a sequence of systems (Ii,Fi) such that Ii ⊂ Ii+1 and any element x ∈ Fi+1 is either (1) x ∈ Fi, or (2) ∃e ∈ Ii+1 \\Ii such that (x\\{e}) ∈ Fi, (3) or x accesible in Fi+1.\nData: A dataset D, a chain of projections Ψ = {ψ0, ψ1, · · · , ψk}, an anti-monotonic measure M for the chain Ψ, and a threshold θ for M.\n1 Function ExtendProjection(i, θ, Pi−1) Data: i is the projection number to which we should extend (0 < i ≤ k), θ is a\nthreshold value for M, and Pi−1 is the set of itemsets for the projection ψi−1.\nResult: The set Pi of all itemsets with the value of measure M higher than the threshold θ for ψi.\n2 Pi ←− ∅; 3 foreach p ∈ Pi−1 do 4 Pi ←− Pi ∪ Preimages(i,p) 5 foreach p ∈ Pi do 6 if Mψi (p) ≤ θ then 7 Pi ←− Pi \\ {p} 8 Function Algorithm θ-Σοφια\nResult: The set P of all itemsets with a value of M higher than the threshold θ for D.\n9 P ←− FindPatterns(θ, ψ0); 10 foreach 0 < i ≤ k do 11 P ←− ExtendProjection(i, θ,P);\nAlgorithm 1: θ-Σοφια\nProof. (1) by idempotency of projections, (2) by contractivity, (3) for deletion of several items."
    }, {
      "heading" : "3.2 Algorithms",
      "text" : "Data: A dataset D, a chain of projections Ψ = {ψ0, ψ1, · · · , ψk}, an anti-monotonic measure M for the chain Ψ, and a threshold L for the maximal number of preserved itemsets.\n1 Function Algorithm Σοφια Result: The threshold θ ensuring that the cardinality of the set P is bounded by\nL in any step of the algorithm. The set P of all itemsets with the value of measure M higher than the threshold θ.\n2 θ ←− θminP ←− FindPatterns(ψ0); 3 foreach 0 < i ≤ k do 4 θ ←− AdjustTheta(θ, L,P); 5 P ←− PrunePatterns(θ,P); 6 P ←− ExtendProjection(i, θ,P);\nAlgorithm 2: Σοφια for finding itemsets in D with the bounded cardinality of the set P.\nGiven a dataset D and a measure anti-monotonic w.r.t. a chain of projections, if we are able to find all preimages of any element in the fixed set of a projection ψi that belong to a fixed set of the next projection ψi+1, then we can find all itemsets of the dataset D with a value ofM higher than a given threshold θ. We call the respective algorithm θ-Σοφια (Algorithm 1). In line 9 we find all itemsets for the dataset ψ0(D) satisfying the constraint w.r.t. the measure M. Then in lines 10-11 we iteratively extend projections from simpler to more\ndetailed ones. The extension is done by constructing the set Pi of preimages of the set Pi−1 (lines 2-4) and then by removing the itemsets that do not satisfy the constraint from Pi (lines 5-7). This listing provides a sketch of the algorithm omitting possible engineering improvements for the sake of simplicity. Most of the known improvements are applicable here, i.e., the ones from [UKA05]. In particular, a canonical order on itemsets is used for mining closed pattern (the theoretical basis for such mining is given in next subsections).\nThe algorithm is sound and complete, since first, an itemset p is included into the set of preimages of p (since ψ(p) = p) and second, if M(p) < θ, then we remove the itemset p from the set P and the measure value of any preimage of p is less than θ by the projection chain anti-monotonicity of M. The worst case time complexity for the general case of patterns of θ-Σοφια algorithm is\nT(θ-Σοφια) = T(FindPatterns(ψ0))+\n+ k · max 0<i≤k |Pi| · (T(Preimages) + T(M)), (2)\nwhere k is the number of projections in the chain, T(X ) is the time for computing the operation X . Since projection ψ0 can be chosen to be very simple, in a typical case the complexity of FindPatterns(θ, ψ0) can be low or even constant. The complexities of Preimages and M depend on the measure, the chain of projections, and the kind of patterns. In many cases max\n0<i≤k |Pi| can\nbe exponential in the size of the input, because the number of patterns can be exponential. It can be a difficult task to define the threshold θ such that the maximal cardinality of Pi is not larger than a given number. Thus, we introduce Σοφια algorithm (Algorithm 2), which automatically adjusts threshold θ ensuring that max\n0<i≤k |Pi| < L. Here L can be considered as a constraint on the\nmemory used by the algorithm. The only difference of Σοφια w.r.t. θ-Σοφια is that after performing an operation that changes the set P (lines 2 and 6 in Algorithm 2) it adjusts θ in such a way that the cardinality of P does not exceed the parameter L. It can be seen from (2) that Σοφια has polynomial time complexity if M and Preimages are polynomial. Indeed, according to (1) if a projection removes only one item, the cardinality of Preimages is always 2. Thus, the worst case complexity for θ-Σοφια is\nT(θ-Σοφιαbinary) = |I| · max0<i≤N|Pi| · T(M). (3)\nWe notice that every Pi is a solution for the projected dataset. Thus, this algorithm has incremental polynomial delay. However, if we fix the available memory L, the complexity of Σοφια for binary data is |I| · L · T(M), i.e., it becomes input polynomial modulo complexity of the measure.\nTo wrap up, in this subsection we have introduced an algorithm for finding top-K itemsets in polynomial time. It is important to notice that the found set of itemsets is exactly the best itemsets w.r.t. to Δ-measure and should not be mixed up with an approximation.\nEfficiency Considerations\nRecently much work have been done in finding good strategies of enumerating (closed) patterns. Most of them start from the smallest patterns and then iteratively generate larger patterns. It can be naturally expressed as a chain of functions ψi that are contractive (ψi(X) v X) and idempotent (ψi(ψi(X)) = ψi(X)). These functions can be ordered by inclusion of fixed sets because of idempotency. Since these functions are contractive, only patterns larger than a pattern X are preimages of X. Thus, most of the approaches for itemset mining can be formalized by means of a chain of such functions. However, in this work we require a chain of projections, i.e., functions ψi, to be also monotonic. It allows us to efficiently mine robust and stable patterns discussed in Section 4. This additional monotonicity still allows one to formalize developed approaches for itemset mining as a chain of projections. However, in this work we does not discuss this formalization and focus on the efficient mining of patterns for nonmonotonic constraints."
    }, {
      "heading" : "3.3 Σοφια Algorithm for Closed Itemsets",
      "text" : "Closed frequent itemsets are widely used as a condensed representation of all frequent itemsets since [PBTL99]. Here we show how one can adapt our algorithm for closed patterns. A closed pattern in ψi−1(D) is not necessarily closed in ψi(D). Indeed, if we take the example in Figure 1, the pattern {i1} is closed in (T, {i1, i2}, R2) but no more closed in (T, {i1, i2, i3}, R3). However, the extents (closed tidsets) of ψ(D) are extents of D [GK01]. Thus, we associate the closed patterns with extents, and then work with extents instead of patterns, i.e., a dataset D = (T, (2I ,∩), δ) is transformed into DC = (T, (DC ,uC), δC), where DC = 2\nT . Moreover, for all a, b ∈ DC we have a uC b = t(d(a) u d(b)), where t and d operators are computed in D and δC(t ∈ T ) = {t}. Hence, every pattern p in DC corresponds to a closed pattern d(p) in 2\nI . A projection ψ of D induces a projection ψC of DC , given by ψC(A ⊆ T ) = t(ψ(d(A))) with t and d computed for D.\nIn the next section we discuss some measures that are anti-monotonic w.r.t. a projection (rather than just anti-monotonic). In the end of the next section we provide an example of how Σοφια works."
    }, {
      "heading" : "4 Itemset Constraints",
      "text" : ""
    }, {
      "heading" : "4.1 Cosine Interest of an Itemset",
      "text" : "The first projection-antimonotonic measure we consider is cosine interest [CWW14]. It is defined by\nCosine(X) = |t(X)| |X| √∏\ni∈X |t({i})| , (4)\ni.e., a cosine interest of X is the support of X over the geometric mean of supports of single items from X. As the authors of [CWW14] have shown this measure is not (anti-)monotonic. Then, they also have shown that if we traverse the search space from less supported items to more supported items the cosine interest never decreases. Indeed, given an itemset X and an item i such that i 6∈ X and (∀j ∈ X)|t({i})| ≥ |t({j})|, we can see that Cosine(X) ≥ Cosine(X ∪ {i}) since the itemset support cannot increase while the geometric mean cannot decrease in this case.\nTo work with cosine interest we can define a projection chain that adds items from less supported ones to more supported, i.e., ψ1 corresponds to removal of all but the least frequent item from the dataset, ψ2 corresponds to removal of all but two least frequent items and so on. Then, cosine interesting itemsets can be mined by Σοφια. However this measure is locally anti-monotonic, in the next subsection we consider two proper nonmonotonic measures."
    }, {
      "heading" : "4.2 Stability and Robustness of an Itemset",
      "text" : "Stability [Kuz07] and robustness [TMC14] are similar measures when applied to closed itemsets. They measure independence of an itemset w.r.t. subsampling. Stability can only be applied to closed itemsets, while robustness is defined for any type of itemset constraints (closed itemsets, generators, etc.). However, in case of closed itemsets neither of them is (anti-)monotonic. Indeed, when robustness is based on an anti-monotonic constraint, it is anti-monotonic. However, closedness of itemsets is not an anti-monotonic constraint. Since stability and robustness are similar, we define them on a similar basis.\nGiven a dataset D = (T, I, R), a triple (S, I, R) where S ⊆ T is called a subdataset of D. If we give a weight to every subdataset of D, then we can find the sum of weights of all subdatasets of D where an itemset X is closed. This sum gives us stability or robustness of the closed itemset X depending on how we define the weights of subdatasets.\nIn the case of stability the weights w of all subdatasets Ds of D are equal, i.e., w(Ds) = 2−|T |. In this case we consider every subdataset equally probable and compute the probability that the itemset X is closed.\nExample 2. Consider example in Figure 1a. The set of concepts (the pattern of every concept is a closed itemset) is shown in Figure 1b. Stability of every closed itemset is shown in Table 1. Let us consider the highlighted itemset X = {i3}. There are 25 possible subdatasets. Only in the following 10 subdatasets X is not closed (only the set of transactions for every subdataset is given):\n∅, {t1}, . . . , {t5}, {t1, t5}, {t2, t5}, {t3, t5}, {t4, t5}. Thus, stability of X can be found as Stab(X) = 1− 10 · 2−5 = 0.69.\nIt should be noticed that stability of all comparable itemsets in the lattice is smaller than stability of X, which highlights the nonmonotonicity of stability.\nIn the case of robustness the weights w of subdatasets are computed differently. These weights depend on a parameter 0 ≤ α ≤ 1 denoting the probability of a transaction to be retained in the dataset. The weight of a subdataset Ds = (S, I, R) of D = (T, I, R) corresponds to the probability of obtaining Ds by removing every single transaction from D with probability 1− α: w(Ds) = α|S| · (1− α)|T |−|S|.\nExample 3. Consider example in Figure 1a. Robustness for α = 0.9 for every closed itemset is shown in Table 1. Let us consider the highlighted itemset X = {i3}. It is not closed in the same as above 10 subdatasets but their weights are different (the weights are shown in superscripts): ∅w=10 −5 , {t1}w=9·10 −5 , . . . , {t5}w=9·10 −5 , {t1, t5}w=8.1·10 −4 , {t2, t5}w=8.1·10 −4 , {t3, t5}w=8.1·10 −4 , {t4, t5}w=8.1·10 −4 . Thus, robustness of X for α = 0.9 is equal to Rbstα=0.9(X) = 0.9963. It can be verified that robustness is not an anti-monotonic measure.\nIt is not hard to show that independently of the weights w of subdatasets, stability and robustness are anti-monotonic measures w.r.t. any projection.\nProposition 2. Stability and robustness are anti-monotonic measures w.r.t. any projection.\nProof. Here we want to show that for any projection ψ if a pattern X is closed in a subdataset Ds then ψ(X) is closed in ψ(Ds), where Ds = (S, I, R) is a subdataset of D = (T, I, R) with S ⊆ T . We note that if X is closed in Ds it is also closed in D. And since ψ(X) closed in ψ(D), then for projection ψC from Section 3.3 we have d(ψC(t(X))) = ψ(X). Hence, we can work with images of ψ on closed patterns in order to find the corresponding images of ψC .\nLet Y = d(t(ψ(X)) ∩ S) be a closure of ψ(X) in Ds. Since ψ(X) v X, then t(ψ(X)) ⊇ t(X). Hence S ∩ t(ψ(X)) ⊇ S ∩ t(X). Then Y = d(S ∩ t(ψ(X))) v d(S ∩ t(X)) = X, since Y is the closure of ψ(X) in ψ(Ds) and X is the closure of X in Ds. Thus, we have Y v X and ct(Y ) v ct(X) = X. Because of monotonicity of projections one has ψ(ct(Y )) v ψ(X) and hence Y v ψ(X).\nSince Y is the closure of ψ(X) in Ds, then Y w ψ(X). Hence Y = ψ(X).\nEstimates of Stability and Robustness\nFor both stability and robustness it is shown that the corresponding constraint is NP-hard [Kuz07, TMC14]. Thus, for efficient mining, estimates of stability and robustness are essential. Here we introduce a fast computable estimate of robustness in the same way we did it for stability in [BKN14].\nLet us consider closed itemsets X and Y such that X ⊂ Y . Can we define the subdatasets where X is not closed? Let us define ∆(X,Y ) as the cardinality of the set of transactions described by X but not by Y : ∆(X,Y ) = t(X) \\ t(Y ).\nThis set is not empty since X 6= Y and they are closed. It is clear that X is not closed in any subdataset that removes all transactions from ∆(X,Y ), since Y is a larger itemset with the same support. Then, Stab(X) ≤ 1− 2−∆(X,Y ) and Rbst(X) ≤ 1 − (1 − α)∆(X,Y ) for any closed itemset Y ⊃ X. In particular, we can put Y to the closest closed superitemset of X.\nIn the same way we can take all immediate closed superitemsets of X and take into account all the subdatasets where X is not closed. Since some of the subdatasets are probably counted several times we get the lower bound, i.e., Stab(X) ≥ 1−\n∑ Y≺X 2−∆(X,Y ) and Rbst(X) ≥ 1− ∑ Y≺X (1− α)∆(X,Y ).\nProposition 3. Stability and robustness are bounded as follows, where X ≺ Y means that X is an immediate closed subitemset of Y :\n1− ∑\nY≺X 2 −∆(X,Y ) ≤ Stab(X) ≤ 1− 2−∆(X,Y ) (5)\n1− ∑\nY≺X (1− α)∆(X,Y ) ≤ Rbst(X) ≤ 1− (1− α)∆(X,Y ) (6)\nIn particular we can see that when α = 0.5 the estimates are exactly the same. As it is recently shown [BKN14], the estimate of stability is quite precise for the concepts with stability close to 1. Then, when α > 0.5 the precision of the estimate of robustness is even more precise.\nThese estimates can be computed in polynomial time in contrast to stability and robustness. And thus we can use one of the bounds as a proxy to stability and robustness. It can be seen that the rankings based on the upper bound of stability and robustness are exactly the same as the ranking based on ∆(X) = min Y≺X ∆(X,Y ). Although for the lower bound of stability and robustness it is hard to show the projection anti-monotonicity, we can show it for the upper bound. In the following ∆(X) is called Δ-measure.\nProposition 4. Δ-measure is an anti-monotonic measure w.r.t. any projection.\nProof. We remind that for dealing with closed patterns the tidsets are considered as patterns as discussed in Section 3.3. By properties of projections, if an extent (the tidset of a concept) is found in ψ(D), it is necessarily found in D [GK01]. Let us consider a tidset E of a concept and a tidset of its descendant Ec in ψ(D), where a descendant concept is a concept with a smaller tidset and larger itemset. Let us suppose that Ep is a preimage of E for the projection ψ. Since Ec and Ep are extents in D, the set Ecp = Ec ∩ Ep is an extent in D (the intersection of two closed sets is a closed set). Since Ep is a preimage of E, then Ep 6⊆ Ec (otherwise, Ep is a preimage of Ec and not of E). Then, Ecp 6= Ep and Ecp ⊆ Ep. Hence, ∆(Ep) ≤ |Ep \\Ecp| ≤ |E \\Ec|. So, given a preimage Ep of E, (∀Ec < E)∆(Ep) ≤ |E \\Ec|, i.e., ∆(Ep) ≤ ∆(E). Thus, we can use Δ-measure in combination with Σοφια algorithm.\nExample 4. Consider example in Figure 1a. Δ-measure for every closed itemset is shown in Table 1. Let us consider the highlighted itemset X = {i3} with support equal to 4. The closest superitemsets of X are {i1, i3}, {i2, i3}, {i3, i4},\nand {i3, i5}, all having support equal to one. Thus, Δ-measure of X is equal to ∆(X) = 4−1 = 3. It can be noticed that Δ-measure is not an (anti-)monotonic measure.\nΔ-measure is related to the work of margin-closeness of an itemset [MTU11]. In this work, given a set of patterns, e.g., frequent closed patterns, the authors rank them by the minimal distance in their support to the closest superpattern divided by the support of the pattern. In our case, the minimal distance is exactly the Δ-measure of the pattern."
    }, {
      "heading" : "4.3 Example of Stable Itemsets in Binary Data",
      "text" : "Let us consider the example in Figure 1 and show how we can find all Δ-stable itemsets with threshold θ = 2. We have a binary dataset D = (T, {i1, · · · , i6}, R). Let us denote Ii = {i1, · · · , ii}. The sets Ii correspond to a chain of projections.\nIn Table 2 all closed itemsets are given by the corresponding tidsets, i.e., by elements of DC . For simplicity we write 1234 instead of {t1, t2, t3, t4}. For every element Δ-measure is shown for every Ii. A cell is shown in gray if the itemset is no more considered (the value of Δ is less than 2).\nFor example, in the transition from I2 to I3 the set 1234 is discovered with ∆(1234) = 3, but ∆(12345) = 5− 4 = 1 which is less than θ = 2. Thus, itemset 12345 is discarded and highlighted gray. The global process is as follows (for the example in Figure 1). In the empty binary dataset (T, ∅, R) the first itemset 12345 is considered. Then, in (T, {i1}, R) a possible preimage of 12345 can be either 12345 or 12345 ∩ t({i1}) = 1. The set 12345 is Δ-stable (∆(12345) = 4), while 1 is not Δ-stable (∆(1) = 1) and is discarded. Then, the process continues with (T, {i1, i2}, R) and 12345 is kept while 12345 ∩ t({i2}) = 2 is removed for the same reason as 1. After that, with (T, {i1, i2, i3}, R) two preimages are still considered, 12345 and 1234. This time ∆(1234) = 3, while ∆(12345) = 1\nand the set 12345 is discarded. The process continues in the same way with ∆(1234) = 3 and all other possible elements are discarded."
    }, {
      "heading" : "5 Experiments and Discussion",
      "text" : ""
    }, {
      "heading" : "5.1 Comparing Computational Efficiency",
      "text" : "In the first experiment we show the computational efficiency of Σοφια coded in C++1. We use public available big datasets from FIMI2, LUCS [Coe03], and UCI [FA10] repositories. The experiments are carried out on an “Intel(R) Core(TM) i7-2600 CPU @ 3.40GHz” computer with 8Gb of memory under Ubuntu 14.04.\nWe should note two points here. First, to the best of our knowledge Σοφια is the first algorithm that computes top Δ-stable and robust itemsets, so there are no direct competitors. Moreover, computing Δ-measure for an itemset requires either a known partial order of itemsets or a search for its descendants (closed supersets). Thus, as an approximate competitors we decided to use two algorithms LCMv3 [UKA05] and Charm-L [ZH05]. The first one is one of the most efficient algorithm for itemset mining that should be followed by Δ-measure computation for every concept. Charm-L is less efficient than LCMv3, but allows\n1 The implementation is available at https://github.com/AlekseyBuzmakov/FCAPS 2 http://fimi.ua.ac.be/data/\none to find the partial order of itemsets necessary for the fast computation of Δ-measure.\nSecond, the current implementation of Σοφια does not use most of the modern optimization techniques, e.g., like in LCMv3 [UKA05]. The current implementation relies only on the so-called conditional database, i.e., where for every tidset X the items that belong to all transactions from t(X) and the items that belong to neither transactions from t(X) are recorded [UKA05]. But nevertheless, the computation with the current implementation is efficient.\nThe experiment is organized as following. First, Σοφια finds around the 1000 most Δ-stable itemsets and the maximal support threshold ensuring to find all these the most Δ-stable itemsets. Among them we find the most Δ-stable itemset (or itemsets if they have the same value ofΔ-measure) and the corresponding support threshold. So LCMv3 and Charm-L are additionally provided with an oracle returning the required support thresholds. For these two thresholds we run LCMv3 and Charm-L algorithm and register the computation time. In addition for LCMv3 we register also the time needed for computing Δ-measure, while for Charm-L this time is insignificant. In Table 3 for every dataset we give the results corresponding to every threshold, and the corresponding thresholds for support and Δ-measure. For example, for dataset chess we run two experiments. In the first one we search for top-3 Δ-stable itemsets having the same value (234) for Δ-measure. The less frequent itemsets among these three has support equal to 1145, thus, LCMv3 and Charm-L should be run with this support threshold in order to enumerate all of these itemsets. LCMv3 finds the corresponding frequent closed itemset in 1.67 seconds, then it takes more than 100 seconds for computing Δ-measure. Charm-L takes more than 100 seconds and Σοφια requires only 0.03 seconds. In the second experiment for dataset chess we search for top-928 Δ-stable itemsets, all of them have support at least 277 and Δ-measure 98.\nWe boldify the computation time for an algorithm in Table 3, if it is better than the time of the competitors. We can see that even LCMv3 alone does not always beat Σοφια, while the additional time for LCMv3 for computing Δmeasure is always significant. There are only two cases when Σοφια is slightly worse (FIMI-mushroom and LUCS-waveform). For both cases the most stable itemset has a very high support and only a couple of itemsets are frequent enough in both datasets. In contrast, if the frequency of the most Δ-stable itemsets is not high, then Σοφια is many times faster than even LCMv3 alone.\nIn these experiments we do not provide the found itemsets since the main focus of our paper is efficiency. However, we highlight that Δ-stable patterns are not trivial and can be found deep in the lattice of patterns [MLB+15]."
    }, {
      "heading" : "5.2 Scalability",
      "text" : "We can study scalability of Σοφια from different points of view. First, we can measure the time necessary for finding top-L concepts, i.e., how the memory limitation L changes the efficiency. It is shown in Table 4 for the same datasets. We can see that the computation time changes linearly w.r.t. the memory limitation L as it is expected from Eq. (3).\nFinally, we check how computation time depends on the size of the dataset. For that we run our experiments for L = 1000, and vary the number of transactions in a dataset. We permute several time the order of transactions of the dataset. For every permutation we construct datasets containing certain amount (the size of the dataset) of the first transactions from this permutation. The computation time is averaged over the permutations. Figure 2 shows the computation time necessary to process a certain fraction of transactions in the dataset. Time is given as a fraction of time for processing the whole dataset. We can see that computation time changes linearly w.r.t. the fraction of processed transactions. Σοφια allows limiting the memory in use; thus, as long as the program fits within the memory, which is controllable, the scalability of our approach is linear w.r.t. to the size of the dataset, and consequently can be applied to very huge datasets."
    }, {
      "heading" : "6 Conclusion",
      "text" : "In this paper we have introduced a new class of interestingness measures, socalled projection-antimonotonic measures. This wide class of measures includes classical anti-monotonic, locally anti-monotonic, and some nonmonotonic measures. We have introduced algorithm Σοφια, which allows one to efficiently mine patterns w.r.t. projection-antimonotonic measures. We have studied stability and robustness, two projection-antimonotonic measures, and have introduced polynomial estimates of them, called Δ-measure. Finally, in the experimental part we have showed that Σοφια can findΔ-stable itemsets much more efficiently than postpruning approaches.\nMany directions for future work are promising. First, we should work on adaptation of Σοφια for dealing with different kinds of pattern structures, e.g., based on sequences or graphs [KS05]. Second, Σοφια allows one to introduce new data mining approaches by means of projections of special kind, thus, it is interesting to study possible classes of projections. Finally, besides robustness\nand stability we a study of other projection-antimonotonic measures is important."
    } ],
    "references" : [ {
      "title" : "Fast algorithms for mining association rules",
      "author" : [ "Rakesh Agrawal", "Ramakrishnan Srikant" ],
      "venue" : "In Proc. 20th int. conf. very large data bases, VLDB,",
      "citeRegEx" : "Agrawal and Srikant.,? \\Q1994\\E",
      "shortCiteRegEx" : "Agrawal and Srikant.",
      "year" : 1994
    }, {
      "title" : "Listing closed sets of strongly accessible set systems with applications to data mining",
      "author" : [ "Mario Boley", "Tamás Horváth", "Axel Poigné", "Stefan Wrobel" ],
      "venue" : "Theor. Comput. Sci.,",
      "citeRegEx" : "Boley et al\\.,? \\Q2010\\E",
      "shortCiteRegEx" : "Boley et al\\.",
      "year" : 2010
    }, {
      "title" : "Scalable Estimates of Concept Stability",
      "author" : [ "Aleksey Buzmakov", "Sergei O. Kuznetsov", "Amedeo Napoli" ],
      "venue" : "Form. Concept Anal.,",
      "citeRegEx" : "Buzmakov et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Buzmakov et al\\.",
      "year" : 2014
    }, {
      "title" : "The LUCS-KDD Discretised and normalised ARM and CARM Data Library",
      "author" : [ "F. Coenen" ],
      "venue" : "Department of Computer Science, The University of Liverpool,",
      "citeRegEx" : "Coenen.,? \\Q2003\\E",
      "shortCiteRegEx" : "Coenen.",
      "year" : 2003
    }, {
      "title" : "DataPeeler: Constraint-Based Closed Pattern Mining in n-ary Relations",
      "author" : [ "Löıc Cerf", "Céline Robardet", "Jean-François Boulicaut" ],
      "venue" : "In SDM’08 Proc. Eighth SIAM Int. Conf. Data Min.,",
      "citeRegEx" : "Cerf et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Cerf et al\\.",
      "year" : 2008
    }, {
      "title" : "Scaling up cosine interesting pattern discovery: A depth-first method",
      "author" : [ "Jie Cao", "Zhiang Wu", "Junjie Wu" ],
      "venue" : "Inf. Sci. (Ny).,",
      "citeRegEx" : "Cao et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Cao et al\\.",
      "year" : 2014
    }, {
      "title" : "Pattern Structures and Their Projections",
      "author" : [ "Bernhard Ganter", "Sergei O. Kuznetsov" ],
      "venue" : "Concept. Struct. Broadening Base,",
      "citeRegEx" : "Ganter and Kuznetsov.,? \\Q2001\\E",
      "shortCiteRegEx" : "Ganter and Kuznetsov.",
      "year" : 2001
    }, {
      "title" : "Formal Concept Analysis: Mathematical Foundations",
      "author" : [ "Bernhard Ganter", "Rudolf Wille" ],
      "venue" : "Springer, 1st edition,",
      "citeRegEx" : "Ganter and Wille.,? \\Q1999\\E",
      "shortCiteRegEx" : "Ganter and Wille.",
      "year" : 1999
    }, {
      "title" : "Revisiting Numerical Pattern Mining with Formal Concept Analysis",
      "author" : [ "Mehdi Kaytoue", "Sergei O. Kuznetsov", "Amedeo Napoli" ],
      "venue" : "IJCAI",
      "citeRegEx" : "Kaytoue et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Kaytoue et al\\.",
      "year" : 2011
    }, {
      "title" : "Learning Closed Sets of Labeled Graphs for Chemical Applications",
      "author" : [ "Sergei O. Kuznetsov", "Mikhail V. Samokhin" ],
      "venue" : "Inductive Log. Program. SE - 12,",
      "citeRegEx" : "Kuznetsov and Samokhin.,? \\Q2005\\E",
      "shortCiteRegEx" : "Kuznetsov and Samokhin.",
      "year" : 2005
    }, {
      "title" : "On stability of a formal concept",
      "author" : [ "Sergei O. Kuznetsov" ],
      "venue" : "Ann. Math. Artif. Intell.,",
      "citeRegEx" : "Kuznetsov.,? \\Q2007\\E",
      "shortCiteRegEx" : "Kuznetsov.",
      "year" : 2007
    }, {
      "title" : "Discovering structural alerts for mutagenicity using stable emerging molecular patterns",
      "author" : [ "Jean-Philippe Métivier", "Alban Lepailleur", "Aleksey Buzmakov", "Guillaume Poezevara", "Bruno Crémilleux", "Sergei Kuznetsov", "Jérémie Le Goff", "Amédéo Napoli", "Ronan Bureau", "Bertrand Cuissart" ],
      "venue" : "J. Chem. Inf. Model.,",
      "citeRegEx" : "Métivier et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Métivier et al\\.",
      "year" : 2015
    }, {
      "title" : "Efficient mining of all margin-closed itemsets with applications in temporal knowledge discovery and classification by compression",
      "author" : [ "Fabian Moerchen", "Michael Thies", "Alfred Ultsch" ],
      "venue" : "Knowl. Inf. Syst.,",
      "citeRegEx" : "Moerchen et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Moerchen et al\\.",
      "year" : 2011
    }, {
      "title" : "Efficient Algorithms for Discovering Association Rules",
      "author" : [ "Heikki Mannila", "Hannu Toivonen", "A Inkeri Verkamo" ],
      "venue" : "In Knowl. Discov. Data Min.,",
      "citeRegEx" : "Mannila et al\\.,? \\Q1994\\E",
      "shortCiteRegEx" : "Mannila et al\\.",
      "year" : 1994
    }, {
      "title" : "Efficient Mining of Association Rules Using Closed Itemset Lattices",
      "author" : [ "Nicolas Pasquier", "Yves Bastide", "Rafik Taouil", "Lotfi Lakhal" ],
      "venue" : "Inf. Syst.,",
      "citeRegEx" : "Pasquier et al\\.,? \\Q1999\\E",
      "shortCiteRegEx" : "Pasquier et al\\.",
      "year" : 1999
    }, {
      "title" : "On succinct representation of knowledge community taxonomies with formal concept analysis",
      "author" : [ "Camille Roth", "Sergei A. Obiedkov", "Derrick G. Kourie" ],
      "venue" : "Int. J. Found. Comput. Sci.,",
      "citeRegEx" : "Roth et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Roth et al\\.",
      "year" : 2008
    }, {
      "title" : "Optimizing constraint-based mining by automatically relaxing constraints",
      "author" : [ "Arnaud Soulet", "Bruno Crémilleux" ],
      "venue" : "In Proc. 5th IEEE Inter- Natl. Conf. Data Min. (ICDM",
      "citeRegEx" : "Soulet and Crémilleux.,? \\Q2005\\E",
      "shortCiteRegEx" : "Soulet and Crémilleux.",
      "year" : 2005
    }, {
      "title" : "Adequate condensed representations of patterns",
      "author" : [ "Arnaud Soulet", "Bruno Crémilleux" ],
      "venue" : "Data Min. Knowl. Discov.,",
      "citeRegEx" : "Soulet and Crémilleux.,? \\Q2008\\E",
      "shortCiteRegEx" : "Soulet and Crémilleux.",
      "year" : 2008
    }, {
      "title" : "Interesting pattern mining in multi-relational data",
      "author" : [ "Eirini Spyropoulou", "Tijl De Bie", "Mario Boley" ],
      "venue" : "Data Min. Knowl. Discov.,",
      "citeRegEx" : "Spyropoulou et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Spyropoulou et al\\.",
      "year" : 2013
    }, {
      "title" : "Finding Robust Itemsets under Subsampling",
      "author" : [ "Nikolaj Tatti", "Fabian Moerchen", "Toon Calders" ],
      "venue" : "ACM Trans. Database Syst.,",
      "citeRegEx" : "Tatti et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Tatti et al\\.",
      "year" : 2014
    }, {
      "title" : "LCM Ver.3: Collaboration of Array, Bitmap and Prefix Tree for Frequent Itemset Mining",
      "author" : [ "Takeaki Uno", "Masashi Kiyomi", "Hiroki Arimura" ],
      "venue" : "In Proc. 1st Int. Work. Open Source Data Min. Freq. Pattern Min. Implementations,",
      "citeRegEx" : "Uno et al\\.,? \\Q2005\\E",
      "shortCiteRegEx" : "Uno et al\\.",
      "year" : 2005
    }, {
      "title" : "Interesting Patterns",
      "author" : [ "Jilles Vreeken", "Nikolaj Tatti" ],
      "venue" : "Freq. Pattern Min.,",
      "citeRegEx" : "Vreeken and Tatti.,? \\Q2014\\E",
      "shortCiteRegEx" : "Vreeken and Tatti.",
      "year" : 2014
    }, {
      "title" : "Mining significant graph patterns by leap search",
      "author" : [ "Xifeng Yan", "Hong Cheng", "Jiawei Han", "Philip S. Yu" ],
      "venue" : "In Proc. 2008 ACM SIGMOD Int. Conf. Manag. data - SIGMOD",
      "citeRegEx" : "Yan et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Yan et al\\.",
      "year" : 2008
    }, {
      "title" : "Efficient algorithms for mining closed itemsets and their lattice structure",
      "author" : [ "Mohammed J. Zaki", "Ching-Jui Hsiao" ],
      "venue" : "IEEE Trans. Knowl. Data Eng.,",
      "citeRegEx" : "Zaki and Hsiao.,? \\Q2005\\E",
      "shortCiteRegEx" : "Zaki and Hsiao.",
      "year" : 2005
    } ],
    "referenceMentions" : [ ],
    "year" : 2017,
    "abstractText" : "The exponential explosion of the set of patterns is one of the main challenges in pattern mining. This chalenge is approached by introducing a constraint for pattern selection. One of the first constraints proposed in pattern mining is support (frequency) of a pattern in a dataset. Frequency is an anti-monotonic function, i.e., given an infrequent pattern, all its superpatterns are not frequent. However, many other constraints for pattern selection are neither monotonic nor anti-monotonic, which makes it difficult to generate patterns satisfying these constraints. In order to deal with nonmonotonic constraints we introduce the notion of “projection antimonotonicity” and Σοφια algorithm that allow generating best patterns for a class of nonmonotonic constraints. Cosine interest, robustness, stability of closed itemsets, and the associated Δ-measure are among these constraints. Σοφια starts from light descriptions of transactions in dataset (a small set of items in the case of itemset description) and then iteratively adds more information to these descriptions (more items with indication of tidsets they describe). In the experiments, we compute best itemsets w.r.t. some measures and show the advantage of our approach over postpruning approaches.",
    "creator" : "LaTeX with hyperref package"
  }
}