{
  "name" : "1606.05313.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Unsupervised Risk Estimation Using Only Conditional Independence Structure",
    "authors" : [ "Jacob Steinhardt", "Percy Liang" ],
    "emails" : [ "jsteinhardt@cs.stanford.edu", "pliang@cs.stanford.edu" ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "How can we assess the accuracy of a model when the test distribution is very different than the training distribution? To address this question, we study the problem of unsupervised risk estimation (Donmez et al., 2010)—that is, given a loss function L(θ;x, y) and a fixed model θ, estimate the risk R(θ) def= Ex,y∼p∗ [L(θ;x, y)] with respect to a test distribution p∗(x, y), given access only to m unlabeled examples x(1:m) ∼ p∗(x). Unsupervised risk estimation lets us estimate model accuracy on a novel input distribution, and is thus important for building reliable machine learning systems. Beyond evaluating a single model, it also provides a way of harnessing unlabeled data for learning: by minimizing the estimated risk over θ, we can perform unsupervised learning and domain adaptation.\nUnsupervised risk estimation is impossible without some assumptions on p∗, as otherwise p∗(y | x)— about which we have no observable information—could be arbitrary. How satisfied we should be with an estimator depends on how strong its underlying assumptions are. In this paper, we present an approach which rests on surprisingly weak assumptions—that p∗ satisfies certain conditional independencies, but not that it lies in any parametric family or is close to the training distribution.\nTo give a flavor for our results, suppose that y ∈ {1, . . . , k} and that the loss decomposes as a sum of three parts: L(θ;x, y) = ∑3 v=1 fv(θ;xv, y), where x1, x2, and x3 are independent conditioned on y. In this case, we can estimate the risk to error in poly(k)/ 2 samples, independently of the dimension of x or θ; the dependence on k is roughly cubic in practice. In Sections 2 and 3 we generalize this result to capture both the log and exponential losses, and extend beyond the multiclass case to allow y to be the hidden state of a hidden Markov model.\nSome intuition is provided in Figure 1. At a fixed value of x, we can think of each fv as “predicting” that y = j if fv(xv, j) is low and fv(xv, j′) is high for j′ 6= j. Since f1, f2, and f3 all provide independent signals about y, their rate of agreement gives information about the model accuracy. If f1, f2, and f3 all predict that y = 1, then it is likely that the true y equals 1 and the loss is small. Conversely, if f1, f2, and f3 all predict different values of y, then the loss is likely larger. This\nar X\niv :1\n60 6.\n05 31\n3v 1\n[ cs\n.L G\n] 1\n6 Ju\nn 20\nintuition is formalized by Dawid and Skene (1979) when the fv take values in a discrete set (e.g. when the fv measure the 0/1-loss of independent classifiers); they model (f1, f2, f3) as a mixture of independent categorical variables, and use this to impute y as the label of the mixture component. Several others have extended this idea (e.g. Zhang et al., 2014; Platanios, 2015; Jaffe et al., 2015), but continue to focus on the 0/1 loss (with a single exception that we discuss below).\nWhy have continuous losses such as the log loss been ignored, given their utility for gradient-based learning? The issue is that while the 0/1-loss only involves a discrete prediction in {1, . . . , k} (the predicted output), the log loss involves predictions in Rk (the predicted probability distribution over outputs). The former can be fully modeled by a k-dimensional family, while the latter requires infinitely many parameters. We could assume that the predictions are distributed according to some parametric family, but if that assumption is wrong then our risk estimates will be wrong as well.\nTo sidestep this issue, we make use of the method of moments; while the method of moments has seen recent use in machine learning for fitting non-convex latent variable models (e.g. Anandkumar et al., 2012), it has a much older history in the econometrics literature, where it has been used as a tool for making causal identifications under structural assumptions, even when an explicit form for the likelihood is not known (Anderson and Rubin, 1949; 1950; Sargan, 1958; 1959; Hansen, 1982; Powell, 1994; Hansen, 2014). It is upon this older literature that we draw conceptual inspiration, though our technical tools are more closely based on the newer machine learning approaches. The key insight is that certain moment equations–e.g., E[f1f2 | y] = E[f1 | y]E[f2 | y]– can be derived from the assumed independencies; we then show how to estimate the risk while relying only on these moment conditions, and not on any parametric assumptions about the xv or fv. Moreover, these moment equations also hold for the gradient of fv , which enables efficient unsupervised learning.\nOur paper is structured as follows. In Section 2, we present our basic framework, and state and prove our main result on estimating the risk given f1, f2, and f3. In Section 3, we extend our framework in several directions, including to hidden Markov models. In Section 4, we present a gradient-based learning algorithm and show that the sample complexity needed for learning is d · poly(k)/ 2, where d is the dimension of θ. In Section 5, we investigate how our method performs empirically.\nRelated Work. While the formal problem of unsupervised risk estimation was only posed recently by Donmez et al. (2010), several older ideas from domain adaptation and semi-supervised learning are also relevant. The covariate shift assumption assumes access to labeled samples from a base distribution p0(x, y) for which p∗(y | x) = p0(y | x). If p∗(x) and p0(x) are close together, we can approximate p∗ by p0 via sample re-weighting (Shimodaira, 2000; Quiñonero-Candela et al., 2009). If p∗ and p0 are not close, another approach is to assume a well-specified discriminative model family Θ, such that p0(y | x) = p∗(y | x) = pθ∗(y | x) for some θ∗ ∈ Θ; then we need only heed finite-sample error in the estimation of θ∗ (Blitzer et al., 2011; Li et al., 2011). Both assumptions are somewhat stringent — re-weighting only allows small perturbations, and mis-specified models are common in practice. Indeed, many authors report that mis-specification can lead to severe issues in semi-supervised settings (Merialdo, 1994; Nigam et al., 1998; Cozman and Cohen, 2006; Liang and Klein, 2008; Li and Zhou, 2015).\nAs mentioned above, our approach is closer in spirit to that of Dawid and Skene (1979) and its extensions. Similarly to Zhang et al. (2014) and Jaffe et al. (2015), we use the method of moments for estimating latent-variable models However, those papers use it as a tool for parameter estimation in the face of non-convexity, rather than as a way to sidestep model mis-specification. The insight that moments are robust to model mis-specification lets us extend beyond the simple discrete settings they consider in order to handle more complex continuous and structured losses. Another approach to handling continuous losses is given in the intriguing work of Balasubramanian et al. (2011), who show that the distribution of losses L | y is often close to Gaussian in practice, and use this to estimate\nthe risk. A key difference from all of this prior work is that we are the first to perform gradient-based learning and the first to handle a structured loss (in our case, the log loss for hidden Markov models)."
    }, {
      "heading" : "2 Framework and Estimation Algorithm",
      "text" : "We will focus on multiclass classification; we assume an unknown true distribution p∗(x, y) over X × Y , where Y = {1, . . . , k}, and are given unlabeled samples x(1), . . . , x(m) drawn i.i.d. from p∗(x). Given parameters θ ∈ Rd and a loss function L(θ;x, y), our goal is to estimate the risk of θ on p∗: R(θ) def= Ex,y∼p∗ [L(θ;x, y)]. Throughout, we will make the 3-view assumption: Assumption 1 (3-view). Under p∗, x can be split into x1, x2, x3, which are conditionally independent given y (see Figure 2). Moreover, the loss decomposes additively across views: L(θ;x, y) = A(θ;x)− ∑3 v=1 fv(θ;xv, y), for some functions A and fv .\nNote that if we have v > 3 views x1, . . . , xv, then we can always partition the views into blocks x′1 = x1:bv/3c, x ′ 2 = xbv/3c+1:b2v/3c, x ′ 3 = xb2v/3c+1:v . Assumption 1 then holds for x ′ 1, x ′ 2, x ′ 3.\n1 In addition, it suffices for just the fv to be independent rather than the xv .\nWe will give some examples where Assumption 1 holds, then state and prove our main result. We start with logistic regression, which will be our primary focus later on:\nExample 1 (Logistic Regression). Suppose that we have a log-linear model pθ(y | x) = exp ( θ> (φ1(x1, y) + φ2(x2, y) + φ3(x3, y))−A(θ;x) ) , where x1, x2, and x3 are independent conditioned on y. If our loss function is the log-loss L(θ;x, y) = − log pθ(y | x), then Assumption 1 holds with fv(θ;xv, y) = θ>φv(xv, y), and A(θ;x) equal to the partition function of pθ.\nWe next consider the hinge loss, for which Assumption 1 does not hold. However, it does hold for a modified hinge loss, where we apply the hinge separately to each view:\nExample 2 (Modified Hinge Loss). Suppose that L(θ;x, y) = ∑3 v=1(1 + maxj 6=y θ\n>φv(xv, j)− θ>φv(xv, y))+. In other words, L is the sum of 3 hinge losses, one for each view. Then Assumption 1 holds with A = 0, and −fv equal to the hinge loss for view v.\nThere is nothing special about the hinge loss; for instance, we could instead take a sum of 0/1-losses.\nOur final example shows that linearity is not necessary for Assumption 1 to hold; the model can be arbitrarily non-linear in each view xv , as long as the predictions are combined additively at the end:\nExample 3 (Neural Networks). Suppose that for each view v we have a neural network whose output is a prediction vector (fv(θ;xv, j))kj=1. Suppose further that we add together the predictions f1+f2+ f3, apply a soft-max, and evaluate using the log loss; then L(θ;x, y) = A(θ;x)− ∑3 v=1 fv(θ;xv, y), where A(θ;x) is the log-normalization constant of the softmax, and hence L satisfies Assumption 1.\nWith these examples in hand, we are ready for our main result on recovering the risk R(θ). The key is to recover the conditional risk matrices Mv ∈ Rk×k, defined as\n(Mv)ij = E[fv(θ;xv, i) | y = j]. (1)\n1 For v = 2 views, recovering R is related to non-negative matrix factorization (Lee and Seung, 2001). Exact identification ends up being impossible, though obtaining upper bounds is likely possible.\nIn the case of the 0/1-loss, the Mv are confusion matrices; in general, (Mv)ij measures how strongly we predict class i when the true class is j. If we could recover these matrices along with the marginal class probabilities πj def = p∗(y = j), then estimating the risk would be straightforward; indeed,\nR(θ) = E[A(θ;x)]− k∑ j=1 πj 3∑ v=1 (Mv)j,j , (2)\nwhere E[A(θ;x)] can be estimated from unlabeled data alone.\nCaveat: Class permutation. Suppose that at training time, we learn to predict whether an image contains the digit 0 or 1. At test time, nothing changes except the definitions of 0 and 1 are reversed. It is clearly impossible to detect this from unlabeled data; mathematically, this manifests asMv only being recoverable up to column permutation. We will end up computing the minimum risk over these permutations, which we call the optimistic risk and denote R̃(θ) def= minσ∈Sym(k) Ex,y∼p∗ [L(θ;x, σ(y))]. This equals the true risk as long as θ is at least aligned with the correct labels in the sense that Ex[L(θ;x, j) | y = j] ≤ Ex[L(θ;x, j′) | y = j] for j′ 6= j. The optimal σ can then be computed from Mv and π in O ( k3 ) time using maximum weight bipartite matching; see Section A for details.\nOur main result, Theorem 1, says that we can recover both Mv and π up to permutation, with a number of samples that is polynomial in k; in practice the dependence on k seems roughly cubic.\nTheorem 1. Suppose Assumption 1 holds. Then, for any , δ ∈ (0, 1), we can estimate Mv and π up to column permutation, to error (in Frobenius and∞-norm respectively). Our algorithm requires\nm = poly ( k, π−1min, λ −1, τ ) · log(2/δ) 2 samples to succeed with probability 1− δ, where\nπmin def = k min j=1 p∗(y = j), τ def = E [∑ v,jfv(θ;xv, j) 2 ] , and λ def= 3 min v=1 σk(Mv), (3)\nand σk denotes the kth singular value. Moreover, the algorithm runs in time m · poly(k).\nNote that estimates for Mv and π imply an estimate for R̃ via (2). Importantly, the sample complexity in Theorem 1 depends on the number of classes k, but not on the dimension d of θ. Moreover, Theorem 1 holds even if p∗ lies outside the model family θ, and even if the train and test distributions are very different (in fact, the result is totally agnostic to how the model θ was produced). The only requirement is that the 3-view assumption holds for p∗.\nLet us interpret each term in (3). First, τ tracks the variance of the loss, and we should expect the difficulty of estimating the risk to increase with this variance. The log(2/δ) 2 term is typical and shows up even when estimating the parameter of a Bernoulli variable to accuracy from m samples. The π−1min term appears because, if one of the classes is very rare, we need to wait a long time to observe even a single sample from that class, and even longer to estimate the risk on that class accurately.\nPerhaps least intuitive is the λ−1 term, which is large e.g. when two classes have similar conditional risk vectors E[(fv(θ;xv, i))ki=1 | y = j]. To see why this matters, consider an extreme where x1, x2, and x3 are independent not only of each other but also of y. Then p∗(y) is completely unconstrained, and it is impossible to estimate R at all. Why does this not contradict Theorem 1? The answer is that in this case, all rows of Mv are equal and hence λ = 0, λ−1 =∞, and we need infinitely many samples for Theorem 1 to hold; λ thus measures how close we are to this degenerate case.\nProof of Theorem 1. We now outline a proof of Theorem 1. Recall the goal is to estimate the conditional risk matrices Mv, defined as (Mv)ij = E[fv(θ;xv, i) | y = j]; from these we can recover the risk itself using (2). The key insight is that certain moments of p∗(y | x) can be expressed as polynomial functions of the matrices Mv, and therefore we can solve for the Mv even without explicitly estimating p∗. Our approach follows the technical machinery behind the spectral method of moments (e.g., Anandkumar et al., 2012), which we explain below for completeness.\nDefine the loss vector hv(xv) = (fv(θ;xv, i))ki=1. The conditional independence of the xv means that E[h1(x1)h2(x2)\n> | y] = E[h1(x1) | y]E[h2(x2) | y]>, and similarly for higher-order conditional moments. There is thus low-rank structure in the moments of h, which we can exploit. More precisely,\nAlgorithm 1 Algorithm for estimating R̃(θ) from unlabeled data.\n1: Input: unlabeled samples x(1), . . . , x(m) ∼ p∗(x). 2: Estimate the left-hand-side of each term in (4) using x(1:m). 3: Compute approximations M̂v and π̂v to Mv and π using tensor decomposition. 4: Compute σ maximizing ∑k j=1 π̂σ(j) ∑3 v=1(M̂v)j,σ(j) using maximum bipartite matching.\n5: Output: estimated 1m ∑m i=1A(θ;x (i))− ∑k j=1 π̂σ(j) ∑3 v=1(M̂v)j,σ(j).\nby marginalizing over y, we obtain the following equations, where ⊗ denotes outer product:\nE[hv(xv)] = Mvπ, E[hv(xv)hv′(xv′) >] = Mv diag(π)M > v′ for v 6= v′, and\nE[h1(x1)⊗h2(x2)⊗h3(x3)]i1,i2,i3 = k∑ j=1 πj · (M1)i1,j(M2)i2,j(M3)i3,j ∀i1, i2, i3. (4)\nThe left-hand-side of each equation can be estimated from unlabeled data; we can then solve for Mv and π using tensor decomposition (Lathauwer, 2006; Comon et al., 2009; Anandkumar et al., 2012; 2013; Kuleshov et al., 2015). In particular, we can recover M and π up to permutation: that is, we recover M̂ and π̂ such that Mi,j ≈ M̂i,σ(j) and πj ≈ π̂σ(j) for some permutation σ ∈ Sym(k). This then yields Theorem 1; see Section B for a full proof.\nAssumption 1 therefore yields a set of moment equations (4) that, when solved, let us estimate the risk without any labels y. To summarize the procedure, we (i) approximate the left-hand-side of each term in (4) by sample averages; (ii) use tensor decomposition to solve for π and Mv; (iii) use maximum matching to compute the permutation σ; and (iv) use (2) to obtain R̃ from π and Mv ."
    }, {
      "heading" : "3 Extensions",
      "text" : "Theorem 1 provides a basic building block which admits several extensions to more complex model structures. We go over several cases below, omitting most proofs to avoid tedium.\nExtension 1 (Hidden Markov Model). Most importantly, the latent variable y need not belong to a small discrete set; we can handle structured output spaces such as a hidden Markov model as long as p∗ matches the HMM structure. This is a substantial generalization of previous work on unsupervised risk estimation, which was restricted to multiclass classification.\nSuppose that pθ(y1:T | x1:T ) ∝ ∏T t=2 fθ(yt−1, yt) · ∏T t=1 gθ(yt, xt), with log-loss L(θ;x, y) = − log pθ(y1:T | x1:T ). We can exploit the decomposition\n− log pθ(y1:T | x1:T ) = T∑ t=2\n− log pθ(yt−1, yt | x1:T )︸ ︷︷ ︸ def = `t\n− T∑ t=1\n− log pθ(yt | x1:T )︸ ︷︷ ︸ def = `′t . (5)\nAssuming that p∗ is Markovian with respect to y, each of the losses `t, `′t satisfies Assumption 1 (see Figure 2; for `t, the views are x1:t−2, xt−1:t, xt+1:T , and for `′t they are x1:t−1, xt, xt+1:T ). We use Theorem 1 to estimate each E[`t], E[`′t] individually, and thus also the full risk E[L]. (Note that we actually estimate the risk for y2:T−1 | x1:T due to the 3-view assumption failing at the boundaries.) In general, the idea in (5) applies to any structured output problem that is a sum of local 3-view structures. It would be interesting to extend our results to other structures such as more general graphical models (Chaganty and Liang, 2014) and parse trees (Hsu et al., 2012).\nExtension 2 (Exponential Loss). We can also relax the additivity condition L = A− f1 − f2 − f3. For instance, suppose L(θ;x, y) = exp(−θ> ∑3 v=1 φv(xv, y)) is the exponential loss. We can use Theorem 1 to estimate the matrices Mv corresponding to fv(θ;xv, y) = exp(−θ>φv(xv, y)). Then\nR(θ) = E [ 3∏ v=1 fv(θ;xv, y) ] = ∑ j πj 3∏ v=1 E [fv(θ;xv, j) | y = j] (6)\nby conditional independence. Therefore, the risk can be estimated as ∑ j πj ∏3 v=1(Mv)j,j . More\ngenerally, it suffices to have L(θ;x, y) = A(θ;x) + ∑n i=1 ∏3 v=1 f v i (θ;xv, y) for some functions f v i .\nExtension 3 (Mediating Variable). Assuming that x1:3 are independent conditioned only on y may not be realistic; there might be multiple subclasses of a label (e.g., multiple ways to write the digit 4) which would induce systematic correlations across views. To address this, we show that independence need only hold conditioned on a mediating variable z, rather than on the label y itself.\nLet z be a refinement of y (in the sense that z → y is deterministic) which takes on k′ values, and suppose that the views x1, x2, x3 are independent conditioned on z, as in Figure 2. Then we can estimate the risk as long as we can extend the loss vector hv = (fv)ki=1 to a function h ′ v : Xv → Rk ′ , such that h′v(xv)i = fv(xv, i) and the matrix (M ′ v)ij = E[h ′ v(xv)i | z = j] has full rank. The reason is that we can recover the matrices M ′v , and then, letting r be the map from z to y, we can express the risk as R(θ) = E[A(θ;x)] + ∑k′ j=1 p ∗(z = j) ∑3 v=1(M ′ v)r(j),j .\nSummary. Our framework applies to the log loss and exponential loss; to hidden Markov models; and to cases where there are latent variables mediating the independence structure."
    }, {
      "heading" : "4 From Estimation to Learning",
      "text" : "We now turn our attention to unsupervised learning, i.e., minimizingR(θ) over θ ∈ Rd. Unsupervised learning is impossible without some additional information, since even if we could learn the k classes, we wouldn’t know which class had which label. Thus we assume that we have a small amount of information to break this symmetry, in the form of a seed model θ0:\nAssumption 2 (Seed Model). We have access to a “seed model” θ0 such that R̃(θ0) = R(θ0).\nAssumption 2 merely asks for θ0 to be aligned with the true labels on average. We can obtain θ0 from a small amount of labeled data (semi-supervised learning) or by training in a nearby domain (domain adaptation). We define gap(θ0) to be the difference between R(θ0) and the next smallest permutation of the classes, which will affect the difficulty of learning.\nFor simplicity we will focus on the case of logistic regression, and show how to learn given only Assumptions 1 and 2. However, our algorithm extends to general losses, as we show in Section E.\nLearning from moments. Note that for logistic regression (Examples 1), the unobserved components of L(θ;x, y) are linear in the sense that fv(θ;xv, y) = θ>φv(xv, y) for some φv . We therefore have\nR(θ) = E[A(θ;x)]− θ>φ̄, where φ̄ def= 3∑ v=1 E[φv(xv, y)]. (7)\nFrom (7), we see that it suffices to estimate φ̄, after which all terms on the right-hand-side of (7) are known. Given an approximation φ̂ to φ̄ (we will show how to obtain φ̂ below), we can learn a near-optimal θ by solving the following convex optimization problem:\nθ̂ = arg min ‖θ‖2≤ρ\nE[A(θ;x)]− θ>φ̂. (8)\nIn practice we would need to approximate E[A(θ;x)] by samples, but we ignore this for simplicity (it only contributes lower-order terms to the error). The `2-constraint on θ imparts robustness to errors in φ̄. In particular (see Section C for a proof):\nLemma 1. Suppose ‖φ̂−φ̄‖2 ≤ . Then the output θ̂ from (8) satisfiesR(θ̂) ≤ min‖θ‖2≤ρR(θ)+2 ρ.\nAssuming that the optimal parameter θ∗ has `2-norm at most ρ, Lemma 1 guarantees that R(θ̂) ≤ R(θ∗) + 2 ρ. We will see below that computing φ̂ requires d · poly ( k, π−1min, λ −1, τ ) / 2 samples.\nComputing φ̂. Estimating φ̄ can be done in a manner similar to estimating R(θ) itself. In addition to the conditional risk matrix Mv ∈ Rk×k, we compute the conditional moment matrix Gv ∈ Rdk×k defined by (Gv)i+kr,j def = E[φv(θ;xv, i)r | y = j]. We then have φ̄r = ∑k j=1 πj ∑3 v=1(Gv)j+kr,j .\nWe can solve for G1, G2, and G3 using the same tensor algorithm as in Theorem 1. Some care is needed to avoid explicitly forming the (kd)× (kd)× (kd) tensor that would result from the third term in (4), as this would require O ( k3d3 ) memory and is thus intractable for even moderate values of d. We take a standard approach based on random projections (Halko et al., 2011) and described in\nSection 6.1.2 of Anandkumar et al. (2013). We refer the reader to the aforementioned references for details, and cite only the final sample complexity and runtime (see Section D for a proof sketch):\nTheorem 2. Suppose that Assumption 1 holds and that θ0 ∈ Θ0. Let δ < 1 and < min(1, gap(θ0)). Then, given m = poly ( k, π−1min, λ −1, τ ) · log(2/δ) 2 samples, where λ and τ are as defined in (3), with probability 1 − δ we can recover Mv and π to error , and Gv to error (B/τ) , where B2 = E[ ∑ i,v ‖φv(xv, i)‖22] measures the `2-norm of the features. The algorithm runs in time O (d (m+ poly(k))), and the errors are in Frobenius norm for M and G, and∞-norm for π.\nInterpretation. Whereas before we estimated Mv to error , now we estimate Gv (and hence φ̄) to error (B/τ) . To achieve error in estimating Gv requires (B/τ)2 · poly ( k, π−1min, λ −1, τ ) log(2/δ) 2 samples, which is (B/τ)2 times as large as in Theorem 1. The quantity (B/τ)2 typically grows as O(d), and so the sample complexity needed to estimate φ̄ is typically d times larger than the sample complexity needed to estimate R. This matches the behavior of the supervised case where we need d times as many samples for learning as compared to (supervised) risk estimation of a fixed model.\nSummary. We have shown how to perform unsupervised logistic regression, given only a seed model θ0. This enables unsupervised learning under surprisingly weak assumptions (only the multi-view and seed model assumptions) even for mis-specified models and zero train-test overlap, and without assuming covariate shift. See Section E for learning under more general losses."
    }, {
      "heading" : "5 Experiments",
      "text" : "To better understand the behavior of our algorithms, we perform experiments on a version of the MNIST data set that is modified to ensure that the 3-view assumption holds. To create an image, we sample a class in {0, . . . , 9}, then sample 3 images at random from that class, letting every third pixel come from the respective image. This guarantees that there will be 3 conditionally independent views. To explore train-test variation, we dim pixel p in the image by exp (a (‖p− p0‖2 − 0.4)), where p0 is the image center and the distance is normalized to have maximum value 1. We show example images for a = 0 (train) and a = 5 (a possible test distribution) in Figure 3.\nRisk estimation. We use unsupervised risk estimation (Theorem 1) to estimate the risk of a model trained on a = 0 and tested on various values of a ∈ [0, 10]. We trained the model with AdaGrad (Duchi et al., 2010) on 10, 000 training examples, and used 10, 000 test examples to estimate the risk. To solve for π and M in (4), we first use the tensor power method implemented by Chaganty and Liang (2013) to initialize, and then locally minimize a weighted `2-norm of the moment errors with L-BFGS. For comparison, we compute the validation error for a = 0 (i.e., assume train = test), as well as the predictive entropy ∑ j −pθ(j | x) log pθ(j | x) on the test set (i.e., assume the predictions are well-calibrated). The results are shown in Figure 4a; both the tensor method in isolation and tensor + L-BFGS estimate the risk accurately, with the latter performing slightly better.\nDomain adaptation. We next evaluate our learning algorithm. For θ0 we used the trained model at a = 0, and constrained ‖θ‖2 ≤ 10 in (8). The results are shown in Figure 4b. For small values of a, our algorithm performs worse than the baseline of directly using θ0. However, our algorithm is far more robust as a increases, and tracks the performance of an oracle that was trained on the same distribution as the test examples.\nSemi-supervised learning. Because we only need to provide our algorithm with a seed model, we can perform semi-supervised domain adaptation — train a model from a small amount of labeled data at a = 0, then use unlabeled data to learn a better model on a new distribution. Concretely, we obtained θ0 from only 300 labeled examples. Tensor decomposition sometimes led to bad initializations in this regime, in which case we obtained a different θ0 by training with a smaller step size. The results are shown in Figure 4c. Our algorithm generally performs well, but has higher variability than before, seemingly due to higher condition number of the matrices Mv .\nSummary. Our experiments show that given 3 views, we can estimate the risk and perform domain adaptation, even from a small amount of labeled data."
    }, {
      "heading" : "6 Discussion",
      "text" : "We have presented a method for estimating the risk from unlabeled data, which relies only on conditional independence structure and hence makes no parametric assumptions about the true distribution. Our approach applies to a large family of losses and extends beyond classification tasks to hidden Markov models. We can also perform unsupervised learning given only a seed model that can distinguish between classes in expectation; the seed model can be trained on a related domain, on a small amount of labeled data, or any combination of the two, and thus provides a pleasingly general formulation highlighting the similarities between domain adaptation and semi-supervised learning.\nPrevious approaches to domain adaptation and semi-supervised learning have also exploited multiview structure. Given two views, Blitzer et al. (2011) perform domain adaptation with zero source/target overlap (covariate shift is still assumed). Two-view approaches (e.g. co-training and CCA) are also used in semi-supervised learning (Blum and Mitchell, 1998; Ando and Zhang, 2007; Kakade and Foster, 2007; Balcan and Blum, 2010). These methods all assume some form of low noise or low regret, as do, e.g., transductive SVMs (Joachims, 1999). By focusing on the central problem of risk estimation, our work connects multi-view learning approaches for domain adaptation and semi-supervised learning, and removes covariate shift and low-noise/low-regret assumptions (though we make stronger independence assumptions, and specialize to discrete prediction tasks).\nIn addition to reliability and unsupervised learning, our work is motivated by the desire to build machine learning system with contracts, a challenge recently posed by Bottou (2015); the goal is for machine learning systems to satisfy a well-defined input-output contract in analogy with software systems (Sculley et al., 2015). Theorem 1 provides the contract that under the 3-view assumption the test error is close to our estimate of the test error; this contrasts with the typical weak contract that if train and test are similar, then the test error is close to the training error. One other interesting contract is given by Shafer and Vovk (2008), who provide prediction regions that contain the true prediction with probability 1− in the online setting, even in the presence of model mis-specification. The most restrictive part of our framework is the three-view assumption, which is inappropriate if the views are not completely independent or if the data have structure that is not captured in terms of multiple views. Since Balasubramanian et al. (2011) obtain results under Gaussianity (which would be implied by many somewhat dependent views), we are optimistic that unsupervised risk estimation is possible for a wider family of structures. Along these lines, we end with the following questions:\nOpen question. In the 3-view setting, suppose the views are not completely independent. Is it still possible to estimate the risk? How does the degree of dependence affect the number of views needed?\nOpen question. Given only two independent views, can one obtain an upper bound on the risk R(θ)?\nThe results of this paper have caused us to adopt the following perspective: To handle unlabeled data, we should make generative structural assumptions, but still optimize discriminative model performance. This hybrid approach allows us to satisfy the traditional machine learning goal of predictive accuracy, while handling lack of supervision and under-specification in a principled way. Perhaps, then, what is needed for learning is to understand the structure of a domain."
    }, {
      "heading" : "A Details of Computing R̃ from M and π",
      "text" : "In this section we show how, given M , and π, we can efficiently compute\nR̃(θ) = E[A(θ;x)]− max σ∈Sym(k) k∑ j=1 πσ(j) 3∑ v=1 (Mv)j,σ(j). (9)\nThe only bottleneck is the maximum over σ ∈ Sym(k), which would naïvely require considering k! possibilities. However, we can instead cast this as a form of maximum matching. In particular, form the k × k matrix\nXi,j = πi 3∑ v=1 (Mv)j,i. (10)\nThen we are looking for the permutation σ such that ∑k j=1Xσ(j),j is maximized. If we consider each Xi,j to be the weight of edge (i, j) in a complete bipartite graph, then this is equivalent to asking for a matching of i to j with maximum weight, hence we can maximize over σ using any maximum-weight matching algorithm such as the Hungarian algorithm, which runs in O ( k3 )\ntime (Tomizawa, 1971; Edmonds and Karp, 1972)."
    }, {
      "heading" : "B Proof of Theorem 1",
      "text" : "Preliminary reductions. Our goal is to estimate M and π to error (with probability of failure 1− δ) in poly ( k, π−1min, λ −1, τ ) · log(1/δ) 2 samples. Note that if we can estimate M and π to error with any fixed probability of success 1− δ0 ≥ 34 , then we can amplify the probability of success to 1 − δ at the cost of O (log(1/δ)) times as many samples (the idea is to make several independent estimates, then throw out any estimate that is more than 2 away from at least half of the others; all the remaining estimates will then be within distance 3 of the truth with high probability).\nEstimating M . Estimating π and M is mostly an exercise in interpreting Theorem 7 of Anandkumar et al. (2012), which we recall below, modifying the statement slightly to fit our language. Here κ denotes condition number (which is the ratio of σ1(M) to σk(M), since all matrices in question have k columns).\nTheorem 3 (Anandkumar et al. (2012)). Let Pv,v′ def = E[hv(x)⊗ hv′(x)], and P1,2,3 def = E[h1(x)⊗ h2(x)⊗ h3(x)]. Also let P̂v,v′ and P̂1,2,3 be sample estimates of Pv,v′ , P1,2,3 that are (for technical convenience) estimated from independent samples of size m. Let ‖T‖F denote the `2-norm of T after unrolling T to a vector. Suppose that:\n• P [ ‖P̂v,v′ − Pv,v′‖2 ≤ Cv,v′ √ log(1/δ)\nm\n] ≥ 1− δ for {v, v′} ∈ {{1, 2}, {1, 3}}, and\n• P [ ‖P̂1,2,3 − P1,2,3‖F ≤ C1,2,3 √ log(1/δ)\nm\n] ≥ 1− δ.\nThen, there exists constants C, m0, δ0 such that the following holds: if m ≥ m0 and δ ≤ δ0 and√ log(k/δ)\nm ≤ C · minj 6=j ′ ‖(M>3 )j − (M>3 )j′‖2 · σk(P1,2) C1,2,3 · k5 · κ(M1)4 · δ log(k/δ)\n· ,√ log(1/δ)\nm ≤ C ·min\n{ minj 6=j′ ‖(M>3 )j − (M>3 )j′‖2 · σk(P1,2)2\nC1,2 · ‖P1,2,3‖F · k5 · κ(M1)4 · δ log(k/δ) , σk(P1,3) C1,3\n} · ,\nthen with probability at least 1− 5δ, we can output M̂3 with the following guarantee: there exists a permutation σ ∈ Sym(k) such that for all j ∈ {1, . . . , k},\n‖(M>3 )j − (M̂>3 )σ(j)‖2 ≤ max j′ ‖(M>3 )j′‖2 · . (11)\nBy symmetry, we can use Theorem 3 to recover each of the matrices Mv, v = 1, 2, 3, up to permutation of the columns. Furthermore, Anandkumar et al. (2012) show in Appendix B.4 of their paper how to match up the columns of the different Mv , so that only a single unknown permutation is applied to each of the Mv simultaneously. We will set δ = 1/180, which yields an overall probability of success of 11/12 for this part of the proof.\nWe now analyze the rate of convergence implied by Theorem 3. Note that we can take C1,2,3 = O (√ E[‖h1‖22‖h2‖22‖h3‖22] ) , and similarly Cv,v′ = O (√ E[‖hv‖22‖hv′‖22] ) . Then, since we only\ncare about polynomial factors, it is enough to note that we can estimate the Mv to error given Z/ 2 samples, where Z is polynomial in the following quantities:\n1. k, 2. max3v=1 κ(Mv), where κ denotes condition number, 3. √\nE[‖h1‖22‖h2‖22‖h3‖22] (minj,j′ ‖(M>v )j−(M>v )j′‖2)·σk(Pv′,v′′ ) , where (v, v′, v′′) is a permutation of (1, 2, 3),\n4. ‖P1,2,3‖2 (minj,j′ ‖(M>v )j−(M>v )j′‖2)·σk(Pv′,v′′ ) , where (v, v′, v′′) is as before, and 5. √\nE[‖hv‖22‖hv′‖22] σk(Pv,v′) .\n6. maxj,v ‖(M>v )j‖2.\nIt suffices to show that each of these quantities are polynomial in k, π−1min, τ , and λ −1.\n(1) k is trivially polynomial in itself. (2) Note that κ(Mv) ≤ σ1(Mv)/λ ≤ ‖Mv‖F /λ. Furthermore, ‖Mv‖2F = ∑ j ‖E[hv | j]‖22 ≤∑\nj E[‖hv‖22 | j] ≤ kτ2. In all, κ(Mv) ≤ √ kτ/λ, which is polynomial in k and τ/λ.\n(3) We first note that minj 6=j′ ‖(M>v )j−(M>v )j′‖2 = √\n2 minj 6=j′ ‖M>v (ej−ej′)‖2/‖ej−ej′‖2 ≥ σk(Mv). Also, σk(Pv′,v′′) = σk(Mv′ diag(π)Mv′′) ≥ σk(Mv′)πminσk(Mv′′). We can thus upperbound the quantity in (3.) by √\nE[‖h1‖22‖h2‖22‖h3‖22]√ 2πminσk(M1)σk(M2)σk(M3) ≤ τ 3 √ 2πminλ3 ,\nwhich is polynomial in π−1min, τ/λ.\n(4) We can perform the same calculations as in (3), but now we have to bound ‖P1,2,3‖2. However, it is easy to see that\n‖P1,2,3‖2 = √ ‖E[h1 ⊗ h2 ⊗ h3]‖22\n≤ √\nE[‖h1 ⊗ h2 ⊗ h3‖22] = √\nE[‖h1‖22‖h2‖22‖h3‖22]\n= √√√√ k∑ j=1 πj 3∏ v=1 E[‖hv‖22 | y = j]\n≤ τ3, which yields the same upper bound as in (3).\n(5) We can again perform the same calculations as in (3), where we now only have to deal with a subset of the variables, thus obtaining a bound of τ 2\nπminλ2 . (6) We have ‖(M>v )j‖2 ≤ √ E[‖hv‖22 | y = j] ≤ τ .\nIn sum, we have shown that with probability 1112 we can estimate each Mv to column-wise ` 2 error using poly ( k, π−1min, λ −1, τ ) / 2 samples; since there are only k columns, we can make the total\n(Frobenius) error be at most while still using poly ( k, π−1min, λ −1, τ ) / 2 samples. It now remains to estimate π.\nEstimating π. This part of the argument follows Appendix B.5 of Anandkumar et al. (2012). Noting that π = M−11 E[h1], we can estimate π as π̂ = M̂1 −1 Ê[h1], where Ê denotes the empirical expectation. Hence, we have\n‖π − π̂‖∞ ≤ ∥∥∥(M̂1−1 −M−11 )E[h1] +M−11 (Ê[h1]−E[h1]) + (M̂1−1 −M−11 )(Ê[h1]−E[h1])∥∥∥∞\n≤ ‖M̂1 −1 −M−11 ‖F︸ ︷︷ ︸ (i) ‖E[h1]‖2︸ ︷︷ ︸ (ii) + ‖M−11 ‖F︸ ︷︷ ︸ (iii) ‖Ê[h1]−E[h1]‖2︸ ︷︷ ︸ (iv) + ‖M̂1 −1 −M−11 ‖F︸ ︷︷ ︸ (i) ‖Ê[h1]−E[h1]‖2︸ ︷︷ ︸ (iv) .\nWe will bound each of these factors in turn:\n(i) ‖M̂1 −1 −M−11 ‖F : let E1 = M̂1 −M1, which by the previous part satisfies ‖E1‖F ≤√ kmaxj ‖(M̂>1 )j − (M>1 )j‖2 = poly ( k, π−1min, λ −1, τ ) / √ m. Therefore:\n‖M̂1 −1 −M−11 ‖F ≤ ‖(M1 + E1)−1 −M −1 1 ‖F\n= ‖M−11 (I + E1M −1 1 ) −1 −M−11 ‖F ≤ ‖M−11 ‖F ‖(I + E1M −1 1 ) −1 − I‖F\n≤ kλ−1σ1 ( I + E1M −1 1 ) −1 − I ) ≤ kλ−1 σ1(E1M −1 1 )\n1− σ1(E1M−11 )\n≤ kλ−2 ‖E1‖F 1− λ−1‖E1‖F\n≤ poly\n( k, π−1min, λ −1, τ )\n1− poly ( k, π−1min, λ −1, τ ) / √ m · 1√ m .\nWe can assume that m ≥ poly ( k, π−1min, λ −1, τ )\nwithout loss of generality (since otherwise we can trivially obtain the desired bound on ‖π − π̂‖∞ by simply guessing the uniform distribution), in which case the above quantity is poly ( k, π−1min, λ −1, τ ) · 1√ m .\n(ii) ‖E[h1]‖2: we have ‖E[h1]‖2 ≤ √ E[‖h1‖22] ≤ τ .\n(iii) ‖M−11 ‖F : since ‖X‖F ≤ √ kσ1(F ), we have ‖M−11 ‖F ≤ √ kλ−1. (iv) ‖Ê[h1]−E[h1]‖2: with any fixed probability (say 11/12), this term is O (√ E[‖h1‖22] m ) =\nO (\nτ√ m\n) .\nIn sum, with probability at least 1112 all of the terms are poly ( k, π−1min, λ −1, τ ) , and at least one factor\nin each term has a 1√ m decay. Therefore, we have ‖π − π̂‖∞ ≤ poly ( k, π−1min, λ −1, τ ) · √ 1 m .\nSince we have shown that we can estimate each of M and π individually with probability 1112 , we can estimate them jointly 56 > 3 4 , thus completing the proof."
    }, {
      "heading" : "C Proof of Lemma 1",
      "text" : "Let B(ρ) = {θ | ‖θ‖2 ≤ ρ}. First note that |θ>(φ̂ − φ̄)| ≤ ‖θ‖2‖φ̂ − φ̄‖2 ≤ ρ for all θ ∈ B(ρ). Letting θ̃ denote the minimizer of R(θ) over B(ρ), we obtain\nR(θ̂) = E[A(θ̂;x)]− θ̂>φ̄ (12) ≤ E[A(θ̂;x)]− θ̂>φ̂+ ρ (13) ≤ E[A(θ̃;x)]− θ̃>φ̂+ ρ (14) ≤ E[A(θ̃;x)]− θ̃>φ̄+ 2 ρ (15) = R(θ̃) + 2 ρ, (16)\nas claimed."
    }, {
      "heading" : "D Proof of Theorem 2",
      "text" : "We note that Theorem 7 of Anandkumar et al. (2012) (and hence Theorem 1 above) does not require that the Mv be k × k, but only that they have k columns (the number of rows can be arbitrary). It thus applies for any matrix M ′v, where the jth columns of M ′ v is equal to E[h ′ v(xv) | j] for some hv : Xv → Rd ′ . In our specific case, we will take h′ : Xv → Rk(d+1), where the first k coordinates of h′(xv) are equal to h(xv) (i.e., (fv(xv, i))ki=1), and the remaining kd coordinates of h ′(xv) are equal to τB ∂ ∂θr fv(θ;xv, i) as in the definition of Gv , where the difference is that we have scaled by a\nfactor of τB . Note that in this case M ′ v = [ Mv τ BGv ] . We let λ′ and τ ′ denote the values of λ and τ for M ′ and h′.\nSince Mv is a submatrix of M ′v , we have σk(M ′ v) ≥ σk(Mv), so λ′ ≥ λ. On the other hand, τ ′ = E[ ∑ v ‖h′v(xv)‖22] (17)\n= E[ ∑ v ‖hv(xv)‖22 + τ2 B2 ∑ v,i ‖∇θfv(θ;xv, i)‖22] (18)\n≤ τ2 + τ 2 B2 E[ ∑ v,i ‖∇θfv(θ;xv, i)‖22] (19)\n= 2τ2, (20)\nso τ ′ ≤ √\n2τ . Since (λ′)−1 = O(λ−1) and τ ′ = O(τ), we still obtain a sample complexity of poly ( k, π−1min, λ −1, τ ) · log(2/δ) 2 . Since θ0 ∈ Θ0 by assumption, we can recover the correct permutation of the columns of Mv (and hence also of Gv , since they are permuted in the same way), which completes the proof."
    }, {
      "heading" : "E Learning with General Losses",
      "text" : "In Section 4, we formed the conditional moment matrix Gv , which stored the conditional expectation E[φv(xv, i) | y = j] for each j and i. However, there was nothing special about computing φ (as opposed to some other moments), and for general losses can form the conditional gradient matrix Gv(θ), defined by\nGv(θ)i+kr,j = E\n[ ∂\n∂θr fv(θ;xv, i) | y = j\n] . (21)\nTheorem 2 applies identically to the matrix Gv(θ) at any fixed θ. We can then compute the gradient ∇θR(θ) using the relationship\n∂\n∂θr R(θ) = E\n[ ∂\n∂θr A(θ;x)\n] − k∑ j=1 πj 3∑ v=1 Gv(θ)j+kr,j . (22)\nFor clarity, we also use Mv(θ) to denote the conditional risk matrix at a value θ. To compute the gradient ∇θR(θ), we jointly estimate Mv(θ0) and Gv(θ) (note the differing arguments of θ0 vs. θ). Since the seed model assumption (Assumption 2) allows us to recover the correct column permutation for Mv(θ0), estimating Gv(θ) jointly with Mv(θ0) ensures that we recover the correct column permutation for Gv(θ) as well.\nThe final ingredient is any gradient descent procedure that is robust to errors in the gradient (so that after T steps with error on each step, the total error is O( ) and not O( T )). Fortunately, this is the case for many gradient descent algorithms, including any algorithm that can be expressed as mirror descent (we omit the details because they are somewhat beyond our scope, but refer the reader to Lemma 21 of (Steinhardt et al., 2015) for a proof of this in the case of exponentiated gradent).\nThe general learning algorithm is given in Algorithm 2:\nAlgorithm 2 General algorithm for learning via gradient descent. 1: Parameters: step size η 2: Input: unlabeled samples x(1), . . . , x(m) ∼ p∗(x), seed model θ0 3: z(1) ← 0 ∈ Rd 4: for t = 1 to T do 5: θ(t) ← arg minθ 12η‖θ − θ0‖ 2 2 − θ>z\n6: Compute (M (t)v , G (t) v ) by jointly estimating Mv(θ0), Gv(θ) from x(1:m). 7: for r = 1 to d do 8: gr ← 1m ∑m i=1 ∂ ∂θr A(θ(t);x(i))− ∑k j=1 πj ∑3 v=1(G (t) v )j+kr,j\n9: z(t+1)r ← z(t)r − gr 10: end for 11: end for 12: Output 1T ( θ(1) + · · ·+ θ(T ) ) ."
    } ],
    "references" : [ {
      "title" : "A method of moments for mixture models and hidden Markov models",
      "author" : [ "A. Anandkumar", "D. Hsu", "S.M. Kakade" ],
      "venue" : "In Conference on Learning Theory (COLT),",
      "citeRegEx" : "Anandkumar et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Anandkumar et al\\.",
      "year" : 2012
    }, {
      "title" : "Tensor decompositions for learning latent variable models",
      "author" : [ "A. Anandkumar", "R. Ge", "D. Hsu", "S.M. Kakade", "M. Telgarsky" ],
      "venue" : null,
      "citeRegEx" : "Anandkumar et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Anandkumar et al\\.",
      "year" : 2013
    }, {
      "title" : "Estimation of the parameters of a single equation in a complete system of stochastic equations",
      "author" : [ "T.W. Anderson", "H. Rubin" ],
      "venue" : "The Annals of Mathematical Statistics,",
      "citeRegEx" : "Anderson and Rubin.,? \\Q1949\\E",
      "shortCiteRegEx" : "Anderson and Rubin.",
      "year" : 1949
    }, {
      "title" : "The asymptotic properties of estimates of the parameters of a single equation in a complete system of stochastic equations",
      "author" : [ "T.W. Anderson", "H. Rubin" ],
      "venue" : "The Annals of Mathematical Statistics,",
      "citeRegEx" : "Anderson and Rubin.,? \\Q1950\\E",
      "shortCiteRegEx" : "Anderson and Rubin.",
      "year" : 1950
    }, {
      "title" : "Two-view feature generation model for semi-supervised learning",
      "author" : [ "R.K. Ando", "T. Zhang" ],
      "venue" : "In Conference on Learning Theory (COLT),",
      "citeRegEx" : "Ando and Zhang.,? \\Q2007\\E",
      "shortCiteRegEx" : "Ando and Zhang.",
      "year" : 2007
    }, {
      "title" : "Unsupervised supervised learning II: Margin-based classification without labels",
      "author" : [ "K. Balasubramanian", "P. Donmez", "G. Lebanon" ],
      "venue" : "Journal of Machine Learning Research (JMLR),",
      "citeRegEx" : "Balasubramanian et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Balasubramanian et al\\.",
      "year" : 2011
    }, {
      "title" : "A discriminative model for semi-supervised learning",
      "author" : [ "M. Balcan", "A. Blum" ],
      "venue" : "Journal of the ACM (JACM),",
      "citeRegEx" : "Balcan and Blum.,? \\Q2010\\E",
      "shortCiteRegEx" : "Balcan and Blum.",
      "year" : 2010
    }, {
      "title" : "Domain adaptation with coupled subspaces",
      "author" : [ "J. Blitzer", "S. Kakade", "D.P. Foster" ],
      "venue" : "In Artificial Intelligence and Statistics (AISTATS),",
      "citeRegEx" : "Blitzer et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Blitzer et al\\.",
      "year" : 2011
    }, {
      "title" : "Combining labeled and unlabeled data with co-training",
      "author" : [ "A. Blum", "T. Mitchell" ],
      "venue" : "In Conference on Learning Theory (COLT),",
      "citeRegEx" : "Blum and Mitchell.,? \\Q1998\\E",
      "shortCiteRegEx" : "Blum and Mitchell.",
      "year" : 1998
    }, {
      "title" : "Two high stakes challenges in machine learning",
      "author" : [ "L. Bottou" ],
      "venue" : "Invited talk at the 32nd International Conference on Machine Learning,",
      "citeRegEx" : "Bottou.,? \\Q2015\\E",
      "shortCiteRegEx" : "Bottou.",
      "year" : 2015
    }, {
      "title" : "Spectral experts for estimating mixtures of linear regressions",
      "author" : [ "A. Chaganty", "P. Liang" ],
      "venue" : "In International Conference on Machine Learning (ICML),",
      "citeRegEx" : "Chaganty and Liang.,? \\Q2013\\E",
      "shortCiteRegEx" : "Chaganty and Liang.",
      "year" : 2013
    }, {
      "title" : "Estimating latent-variable graphical models using moments and likelihoods",
      "author" : [ "A. Chaganty", "P. Liang" ],
      "venue" : "In International Conference on Machine Learning (ICML),",
      "citeRegEx" : "Chaganty and Liang.,? \\Q2014\\E",
      "shortCiteRegEx" : "Chaganty and Liang.",
      "year" : 2014
    }, {
      "title" : "Tensor decompositions, alternating least squares and other tales",
      "author" : [ "P. Comon", "X. Luciani", "A.L.D. Almeida" ],
      "venue" : "Journal of Chemometrics,",
      "citeRegEx" : "Comon et al\\.,? \\Q2009\\E",
      "shortCiteRegEx" : "Comon et al\\.",
      "year" : 2009
    }, {
      "title" : "Risks of semi-supervised learning: How unlabeled data can degrade performance of generative classifiers",
      "author" : [ "F. Cozman", "I. Cohen" ],
      "venue" : "In Semi-Supervised Learning",
      "citeRegEx" : "Cozman and Cohen.,? \\Q2006\\E",
      "shortCiteRegEx" : "Cozman and Cohen.",
      "year" : 2006
    }, {
      "title" : "Maximum likelihood estimation of observer error-rates using the EM algorithm",
      "author" : [ "A.P. Dawid", "A.M. Skene" ],
      "venue" : "Applied Statistics,",
      "citeRegEx" : "Dawid and Skene.,? \\Q1979\\E",
      "shortCiteRegEx" : "Dawid and Skene.",
      "year" : 1979
    }, {
      "title" : "Unsupervised supervised learning I: Estimating classification and regression errors without labels",
      "author" : [ "P. Donmez", "G. Lebanon", "K. Balasubramanian" ],
      "venue" : "Journal of Machine Learning Research (JMLR),",
      "citeRegEx" : "Donmez et al\\.,? \\Q2010\\E",
      "shortCiteRegEx" : "Donmez et al\\.",
      "year" : 2010
    }, {
      "title" : "Adaptive subgradient methods for online learning and stochastic optimization",
      "author" : [ "J. Duchi", "E. Hazan", "Y. Singer" ],
      "venue" : "In Conference on Learning Theory (COLT),",
      "citeRegEx" : "Duchi et al\\.,? \\Q2010\\E",
      "shortCiteRegEx" : "Duchi et al\\.",
      "year" : 2010
    }, {
      "title" : "Theoretical improvements in algorithmic efficiency for network flow problems",
      "author" : [ "J. Edmonds", "R.M. Karp" ],
      "venue" : "Journal of the ACM (JACM),",
      "citeRegEx" : "Edmonds and Karp.,? \\Q1972\\E",
      "shortCiteRegEx" : "Edmonds and Karp.",
      "year" : 1972
    }, {
      "title" : "Finding structure with randomness: Probabilistic algorithms for constructing approximate matrix decompositions",
      "author" : [ "N. Halko", "P.-G. Martinsson", "J. Tropp" ],
      "venue" : "SIAM Review,",
      "citeRegEx" : "Halko et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Halko et al\\.",
      "year" : 2011
    }, {
      "title" : "Large sample properties of generalized method of moments estimators",
      "author" : [ "L.P. Hansen" ],
      "venue" : "Econometrica: Journal of the Econometric Society,",
      "citeRegEx" : "Hansen.,? \\Q1982\\E",
      "shortCiteRegEx" : "Hansen.",
      "year" : 1982
    }, {
      "title" : "Uncertainty outside and inside economic models",
      "author" : [ "L.P. Hansen" ],
      "venue" : "Journal of Political Economy,",
      "citeRegEx" : "Hansen.,? \\Q2014\\E",
      "shortCiteRegEx" : "Hansen.",
      "year" : 2014
    }, {
      "title" : "Identifiability and unmixing of latent parse trees",
      "author" : [ "D. Hsu", "S.M. Kakade", "P. Liang" ],
      "venue" : "In Advances in Neural Information Processing Systems (NIPS),",
      "citeRegEx" : "Hsu et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Hsu et al\\.",
      "year" : 2012
    }, {
      "title" : "Estimating the accuracies of multiple classifiers without labeled data",
      "author" : [ "A. Jaffe", "B. Nadler", "Y. Kluger" ],
      "venue" : "In Artificial Intelligence and Statistics (AISTATS),",
      "citeRegEx" : "Jaffe et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Jaffe et al\\.",
      "year" : 2015
    }, {
      "title" : "Transductive inference for text classification using support vector machines",
      "author" : [ "T. Joachims" ],
      "venue" : "In International Conference on Machine Learning (ICML),",
      "citeRegEx" : "Joachims.,? \\Q1999\\E",
      "shortCiteRegEx" : "Joachims.",
      "year" : 1999
    }, {
      "title" : "Multi-view regression via canonical correlation analysis",
      "author" : [ "S.M. Kakade", "D.P. Foster" ],
      "venue" : "In Conference on Learning Theory (COLT),",
      "citeRegEx" : "Kakade and Foster.,? \\Q2007\\E",
      "shortCiteRegEx" : "Kakade and Foster.",
      "year" : 2007
    }, {
      "title" : "Tensor factorization via matrix factorization",
      "author" : [ "V. Kuleshov", "A. Chaganty", "P. Liang" ],
      "venue" : "In Artificial Intelligence and Statistics (AISTATS),",
      "citeRegEx" : "Kuleshov et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Kuleshov et al\\.",
      "year" : 2015
    }, {
      "title" : "A link between the canonical decomposition in multilinear algebra and simultaneous matrix diagonalization",
      "author" : [ "L.D. Lathauwer" ],
      "venue" : "SIAM Journal of Matrix Analysis and Applications,",
      "citeRegEx" : "Lathauwer.,? \\Q2006\\E",
      "shortCiteRegEx" : "Lathauwer.",
      "year" : 2006
    }, {
      "title" : "Algorithms for non-negative matrix factorization",
      "author" : [ "D.D. Lee", "S.H. Seung" ],
      "venue" : "In Advances in Neural Information Processing Systems (NIPS),",
      "citeRegEx" : "Lee and Seung.,? \\Q2001\\E",
      "shortCiteRegEx" : "Lee and Seung.",
      "year" : 2001
    }, {
      "title" : "Knows what it knows: a framework for self-aware learning",
      "author" : [ "L. Li", "M.L. Littman", "T.J. Walsh", "A.L. Strehl" ],
      "venue" : "Machine learning,",
      "citeRegEx" : "Li et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Li et al\\.",
      "year" : 2011
    }, {
      "title" : "Towards making unlabeled data never hurt",
      "author" : [ "Y. Li", "Z. Zhou" ],
      "venue" : "IEEE Transactions on Pattern Analysis and Machine Intelligence,",
      "citeRegEx" : "Li and Zhou.,? \\Q2015\\E",
      "shortCiteRegEx" : "Li and Zhou.",
      "year" : 2015
    }, {
      "title" : "Analyzing the errors of unsupervised learning",
      "author" : [ "P. Liang", "D. Klein" ],
      "venue" : "In Human Language Technology and Association for Computational Linguistics (HLT/ACL),",
      "citeRegEx" : "Liang and Klein.,? \\Q2008\\E",
      "shortCiteRegEx" : "Liang and Klein.",
      "year" : 2008
    }, {
      "title" : "Tagging English text with a probabilistic model",
      "author" : [ "B. Merialdo" ],
      "venue" : "Computational Linguistics,",
      "citeRegEx" : "Merialdo.,? \\Q1994\\E",
      "shortCiteRegEx" : "Merialdo.",
      "year" : 1994
    }, {
      "title" : "Learning to classify text from labeled and unlabeled documents",
      "author" : [ "K. Nigam", "A. McCallum", "S. Thrun", "T. Mitchell" ],
      "venue" : "In Association for the Advancement of Artificial Intelligence (AAAI),",
      "citeRegEx" : "Nigam et al\\.,? \\Q1998\\E",
      "shortCiteRegEx" : "Nigam et al\\.",
      "year" : 1998
    }, {
      "title" : "Estimating accuracy from unlabeled data",
      "author" : [ "E.A. Platanios" ],
      "venue" : "Master’s thesis,",
      "citeRegEx" : "Platanios.,? \\Q2015\\E",
      "shortCiteRegEx" : "Platanios.",
      "year" : 2015
    }, {
      "title" : "Estimation of semiparametric models",
      "author" : [ "J.L. Powell" ],
      "venue" : "In Handbook of Econometrics,",
      "citeRegEx" : "Powell.,? \\Q1994\\E",
      "shortCiteRegEx" : "Powell.",
      "year" : 1994
    }, {
      "title" : "Dataset shift in machine learning",
      "author" : [ "J. Quiñonero-Candela", "M. Sugiyama", "A. Schwaighofer", "N.D. Lawrence" ],
      "venue" : null,
      "citeRegEx" : "Quiñonero.Candela et al\\.,? \\Q2009\\E",
      "shortCiteRegEx" : "Quiñonero.Candela et al\\.",
      "year" : 2009
    }, {
      "title" : "The estimation of economic relationships using instrumental variables",
      "author" : [ "J.D. Sargan" ],
      "venue" : null,
      "citeRegEx" : "Sargan.,? \\Q1958\\E",
      "shortCiteRegEx" : "Sargan.",
      "year" : 1958
    }, {
      "title" : "The estimation of relationships with autocorrelated residuals by the use of instrumental variables",
      "author" : [ "J.D. Sargan" ],
      "venue" : "Journal of the Royal Statistical Society: Series B (Statistical Methodology),",
      "citeRegEx" : "Sargan.,? \\Q1959\\E",
      "shortCiteRegEx" : "Sargan.",
      "year" : 1959
    }, {
      "title" : "Hidden technical debt in machine learning systems",
      "author" : [ "D. Sculley", "G. Holt", "D. Golovin", "E. Davydov", "T. Phillips", "D. Ebner", "V. Chaudhary", "M. Young", "J. Crespo", "D. Dennison" ],
      "venue" : "In Advances in Neural Information Processing Systems (NIPS),",
      "citeRegEx" : "Sculley et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Sculley et al\\.",
      "year" : 2015
    }, {
      "title" : "A tutorial on conformal prediction",
      "author" : [ "G. Shafer", "V. Vovk" ],
      "venue" : "Journal of Machine Learning Research (JMLR),",
      "citeRegEx" : "Shafer and Vovk.,? \\Q2008\\E",
      "shortCiteRegEx" : "Shafer and Vovk.",
      "year" : 2008
    }, {
      "title" : "Improving predictive inference under covariate shift by weighting the log-likelihood function",
      "author" : [ "H. Shimodaira" ],
      "venue" : "Journal of Statistical Planning and Inference,",
      "citeRegEx" : "Shimodaira.,? \\Q2000\\E",
      "shortCiteRegEx" : "Shimodaira.",
      "year" : 2000
    }, {
      "title" : "Memory, communication, and statistical queries",
      "author" : [ "J. Steinhardt", "G. Valiant", "S. Wager" ],
      "venue" : "Electronic Colloquium on Computational Complexity (ECCC),",
      "citeRegEx" : "Steinhardt et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Steinhardt et al\\.",
      "year" : 2015
    }, {
      "title" : "On some techniques useful for solution of transportation network",
      "author" : [ "N. Tomizawa" ],
      "venue" : "problems. Networks,",
      "citeRegEx" : "Tomizawa.,? \\Q1971\\E",
      "shortCiteRegEx" : "Tomizawa.",
      "year" : 1971
    }, {
      "title" : "Spectral methods meet EM: A provably optimal algorithm for crowdsourcing",
      "author" : [ "Y. Zhang", "X. Chen", "D. Zhou", "M.I. Jordan" ],
      "venue" : null,
      "citeRegEx" : "Zhang et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Zhang et al\\.",
      "year" : 2014
    }, {
      "title" : "Proof of Theorem 2 We note that Theorem 7 of Anandkumar et al. (2012) (and hence Theorem 1 above) does not require that the Mv be k × k, but only that they have k columns (the number of rows can be arbitrary)",
      "author" : [ "D claimed" ],
      "venue" : null,
      "citeRegEx" : "claimed.,? \\Q2012\\E",
      "shortCiteRegEx" : "claimed.",
      "year" : 2012
    } ],
    "referenceMentions" : [ {
      "referenceID" : 15,
      "context" : "How can we assess the accuracy of a model when the test distribution is very different than the training distribution? To address this question, we study the problem of unsupervised risk estimation (Donmez et al., 2010)—that is, given a loss function L(θ;x, y) and a fixed model θ, estimate the risk R(θ) def = Ex,y∼p∗ [L(θ;x, y)] with respect to a test distribution p∗(x, y), given access only to m unlabeled examples x ∼ p∗(x).",
      "startOffset" : 198,
      "endOffset" : 219
    }, {
      "referenceID" : 33,
      "context" : "Several others have extended this idea (e.g. Zhang et al., 2014; Platanios, 2015; Jaffe et al., 2015), but continue to focus on the 0/1 loss (with a single exception that we discuss below).",
      "startOffset" : 39,
      "endOffset" : 101
    }, {
      "referenceID" : 22,
      "context" : "Several others have extended this idea (e.g. Zhang et al., 2014; Platanios, 2015; Jaffe et al., 2015), but continue to focus on the 0/1 loss (with a single exception that we discuss below).",
      "startOffset" : 39,
      "endOffset" : 101
    }, {
      "referenceID" : 2,
      "context" : ", 2012), it has a much older history in the econometrics literature, where it has been used as a tool for making causal identifications under structural assumptions, even when an explicit form for the likelihood is not known (Anderson and Rubin, 1949; 1950; Sargan, 1958; 1959; Hansen, 1982; Powell, 1994; Hansen, 2014).",
      "startOffset" : 225,
      "endOffset" : 319
    }, {
      "referenceID" : 36,
      "context" : ", 2012), it has a much older history in the econometrics literature, where it has been used as a tool for making causal identifications under structural assumptions, even when an explicit form for the likelihood is not known (Anderson and Rubin, 1949; 1950; Sargan, 1958; 1959; Hansen, 1982; Powell, 1994; Hansen, 2014).",
      "startOffset" : 225,
      "endOffset" : 319
    }, {
      "referenceID" : 19,
      "context" : ", 2012), it has a much older history in the econometrics literature, where it has been used as a tool for making causal identifications under structural assumptions, even when an explicit form for the likelihood is not known (Anderson and Rubin, 1949; 1950; Sargan, 1958; 1959; Hansen, 1982; Powell, 1994; Hansen, 2014).",
      "startOffset" : 225,
      "endOffset" : 319
    }, {
      "referenceID" : 34,
      "context" : ", 2012), it has a much older history in the econometrics literature, where it has been used as a tool for making causal identifications under structural assumptions, even when an explicit form for the likelihood is not known (Anderson and Rubin, 1949; 1950; Sargan, 1958; 1959; Hansen, 1982; Powell, 1994; Hansen, 2014).",
      "startOffset" : 225,
      "endOffset" : 319
    }, {
      "referenceID" : 20,
      "context" : ", 2012), it has a much older history in the econometrics literature, where it has been used as a tool for making causal identifications under structural assumptions, even when an explicit form for the likelihood is not known (Anderson and Rubin, 1949; 1950; Sargan, 1958; 1959; Hansen, 1982; Powell, 1994; Hansen, 2014).",
      "startOffset" : 225,
      "endOffset" : 319
    }, {
      "referenceID" : 40,
      "context" : "If p∗(x) and p0(x) are close together, we can approximate p∗ by p0 via sample re-weighting (Shimodaira, 2000; Quiñonero-Candela et al., 2009).",
      "startOffset" : 91,
      "endOffset" : 141
    }, {
      "referenceID" : 35,
      "context" : "If p∗(x) and p0(x) are close together, we can approximate p∗ by p0 via sample re-weighting (Shimodaira, 2000; Quiñonero-Candela et al., 2009).",
      "startOffset" : 91,
      "endOffset" : 141
    }, {
      "referenceID" : 7,
      "context" : "If p∗ and p0 are not close, another approach is to assume a well-specified discriminative model family Θ, such that p0(y | x) = p∗(y | x) = pθ∗(y | x) for some θ∗ ∈ Θ; then we need only heed finite-sample error in the estimation of θ∗ (Blitzer et al., 2011; Li et al., 2011).",
      "startOffset" : 235,
      "endOffset" : 274
    }, {
      "referenceID" : 28,
      "context" : "If p∗ and p0 are not close, another approach is to assume a well-specified discriminative model family Θ, such that p0(y | x) = p∗(y | x) = pθ∗(y | x) for some θ∗ ∈ Θ; then we need only heed finite-sample error in the estimation of θ∗ (Blitzer et al., 2011; Li et al., 2011).",
      "startOffset" : 235,
      "endOffset" : 274
    }, {
      "referenceID" : 31,
      "context" : "Indeed, many authors report that mis-specification can lead to severe issues in semi-supervised settings (Merialdo, 1994; Nigam et al., 1998; Cozman and Cohen, 2006; Liang and Klein, 2008; Li and Zhou, 2015).",
      "startOffset" : 105,
      "endOffset" : 207
    }, {
      "referenceID" : 32,
      "context" : "Indeed, many authors report that mis-specification can lead to severe issues in semi-supervised settings (Merialdo, 1994; Nigam et al., 1998; Cozman and Cohen, 2006; Liang and Klein, 2008; Li and Zhou, 2015).",
      "startOffset" : 105,
      "endOffset" : 207
    }, {
      "referenceID" : 13,
      "context" : "Indeed, many authors report that mis-specification can lead to severe issues in semi-supervised settings (Merialdo, 1994; Nigam et al., 1998; Cozman and Cohen, 2006; Liang and Klein, 2008; Li and Zhou, 2015).",
      "startOffset" : 105,
      "endOffset" : 207
    }, {
      "referenceID" : 30,
      "context" : "Indeed, many authors report that mis-specification can lead to severe issues in semi-supervised settings (Merialdo, 1994; Nigam et al., 1998; Cozman and Cohen, 2006; Liang and Klein, 2008; Li and Zhou, 2015).",
      "startOffset" : 105,
      "endOffset" : 207
    }, {
      "referenceID" : 29,
      "context" : "Indeed, many authors report that mis-specification can lead to severe issues in semi-supervised settings (Merialdo, 1994; Nigam et al., 1998; Cozman and Cohen, 2006; Liang and Klein, 2008; Li and Zhou, 2015).",
      "startOffset" : 105,
      "endOffset" : 207
    }, {
      "referenceID" : 7,
      "context" : "intuition is formalized by Dawid and Skene (1979) when the fv take values in a discrete set (e.",
      "startOffset" : 27,
      "endOffset" : 50
    }, {
      "referenceID" : 0,
      "context" : "Anandkumar et al., 2012), it has a much older history in the econometrics literature, where it has been used as a tool for making causal identifications under structural assumptions, even when an explicit form for the likelihood is not known (Anderson and Rubin, 1949; 1950; Sargan, 1958; 1959; Hansen, 1982; Powell, 1994; Hansen, 2014). It is upon this older literature that we draw conceptual inspiration, though our technical tools are more closely based on the newer machine learning approaches. The key insight is that certain moment equations–e.g., E[f1f2 | y] = E[f1 | y]E[f2 | y]– can be derived from the assumed independencies; we then show how to estimate the risk while relying only on these moment conditions, and not on any parametric assumptions about the xv or fv. Moreover, these moment equations also hold for the gradient of fv , which enables efficient unsupervised learning. Our paper is structured as follows. In Section 2, we present our basic framework, and state and prove our main result on estimating the risk given f1, f2, and f3. In Section 3, we extend our framework in several directions, including to hidden Markov models. In Section 4, we present a gradient-based learning algorithm and show that the sample complexity needed for learning is d · poly(k)/ , where d is the dimension of θ. In Section 5, we investigate how our method performs empirically. Related Work. While the formal problem of unsupervised risk estimation was only posed recently by Donmez et al. (2010), several older ideas from domain adaptation and semi-supervised learning are also relevant.",
      "startOffset" : 0,
      "endOffset" : 1505
    }, {
      "referenceID" : 0,
      "context" : "Anandkumar et al., 2012), it has a much older history in the econometrics literature, where it has been used as a tool for making causal identifications under structural assumptions, even when an explicit form for the likelihood is not known (Anderson and Rubin, 1949; 1950; Sargan, 1958; 1959; Hansen, 1982; Powell, 1994; Hansen, 2014). It is upon this older literature that we draw conceptual inspiration, though our technical tools are more closely based on the newer machine learning approaches. The key insight is that certain moment equations–e.g., E[f1f2 | y] = E[f1 | y]E[f2 | y]– can be derived from the assumed independencies; we then show how to estimate the risk while relying only on these moment conditions, and not on any parametric assumptions about the xv or fv. Moreover, these moment equations also hold for the gradient of fv , which enables efficient unsupervised learning. Our paper is structured as follows. In Section 2, we present our basic framework, and state and prove our main result on estimating the risk given f1, f2, and f3. In Section 3, we extend our framework in several directions, including to hidden Markov models. In Section 4, we present a gradient-based learning algorithm and show that the sample complexity needed for learning is d · poly(k)/ , where d is the dimension of θ. In Section 5, we investigate how our method performs empirically. Related Work. While the formal problem of unsupervised risk estimation was only posed recently by Donmez et al. (2010), several older ideas from domain adaptation and semi-supervised learning are also relevant. The covariate shift assumption assumes access to labeled samples from a base distribution p0(x, y) for which p∗(y | x) = p0(y | x). If p∗(x) and p0(x) are close together, we can approximate p∗ by p0 via sample re-weighting (Shimodaira, 2000; Quiñonero-Candela et al., 2009). If p∗ and p0 are not close, another approach is to assume a well-specified discriminative model family Θ, such that p0(y | x) = p∗(y | x) = pθ∗(y | x) for some θ∗ ∈ Θ; then we need only heed finite-sample error in the estimation of θ∗ (Blitzer et al., 2011; Li et al., 2011). Both assumptions are somewhat stringent — re-weighting only allows small perturbations, and mis-specified models are common in practice. Indeed, many authors report that mis-specification can lead to severe issues in semi-supervised settings (Merialdo, 1994; Nigam et al., 1998; Cozman and Cohen, 2006; Liang and Klein, 2008; Li and Zhou, 2015). As mentioned above, our approach is closer in spirit to that of Dawid and Skene (1979) and its extensions.",
      "startOffset" : 0,
      "endOffset" : 2581
    }, {
      "referenceID" : 0,
      "context" : "Anandkumar et al., 2012), it has a much older history in the econometrics literature, where it has been used as a tool for making causal identifications under structural assumptions, even when an explicit form for the likelihood is not known (Anderson and Rubin, 1949; 1950; Sargan, 1958; 1959; Hansen, 1982; Powell, 1994; Hansen, 2014). It is upon this older literature that we draw conceptual inspiration, though our technical tools are more closely based on the newer machine learning approaches. The key insight is that certain moment equations–e.g., E[f1f2 | y] = E[f1 | y]E[f2 | y]– can be derived from the assumed independencies; we then show how to estimate the risk while relying only on these moment conditions, and not on any parametric assumptions about the xv or fv. Moreover, these moment equations also hold for the gradient of fv , which enables efficient unsupervised learning. Our paper is structured as follows. In Section 2, we present our basic framework, and state and prove our main result on estimating the risk given f1, f2, and f3. In Section 3, we extend our framework in several directions, including to hidden Markov models. In Section 4, we present a gradient-based learning algorithm and show that the sample complexity needed for learning is d · poly(k)/ , where d is the dimension of θ. In Section 5, we investigate how our method performs empirically. Related Work. While the formal problem of unsupervised risk estimation was only posed recently by Donmez et al. (2010), several older ideas from domain adaptation and semi-supervised learning are also relevant. The covariate shift assumption assumes access to labeled samples from a base distribution p0(x, y) for which p∗(y | x) = p0(y | x). If p∗(x) and p0(x) are close together, we can approximate p∗ by p0 via sample re-weighting (Shimodaira, 2000; Quiñonero-Candela et al., 2009). If p∗ and p0 are not close, another approach is to assume a well-specified discriminative model family Θ, such that p0(y | x) = p∗(y | x) = pθ∗(y | x) for some θ∗ ∈ Θ; then we need only heed finite-sample error in the estimation of θ∗ (Blitzer et al., 2011; Li et al., 2011). Both assumptions are somewhat stringent — re-weighting only allows small perturbations, and mis-specified models are common in practice. Indeed, many authors report that mis-specification can lead to severe issues in semi-supervised settings (Merialdo, 1994; Nigam et al., 1998; Cozman and Cohen, 2006; Liang and Klein, 2008; Li and Zhou, 2015). As mentioned above, our approach is closer in spirit to that of Dawid and Skene (1979) and its extensions. Similarly to Zhang et al. (2014) and Jaffe et al.",
      "startOffset" : 0,
      "endOffset" : 2634
    }, {
      "referenceID" : 0,
      "context" : "Anandkumar et al., 2012), it has a much older history in the econometrics literature, where it has been used as a tool for making causal identifications under structural assumptions, even when an explicit form for the likelihood is not known (Anderson and Rubin, 1949; 1950; Sargan, 1958; 1959; Hansen, 1982; Powell, 1994; Hansen, 2014). It is upon this older literature that we draw conceptual inspiration, though our technical tools are more closely based on the newer machine learning approaches. The key insight is that certain moment equations–e.g., E[f1f2 | y] = E[f1 | y]E[f2 | y]– can be derived from the assumed independencies; we then show how to estimate the risk while relying only on these moment conditions, and not on any parametric assumptions about the xv or fv. Moreover, these moment equations also hold for the gradient of fv , which enables efficient unsupervised learning. Our paper is structured as follows. In Section 2, we present our basic framework, and state and prove our main result on estimating the risk given f1, f2, and f3. In Section 3, we extend our framework in several directions, including to hidden Markov models. In Section 4, we present a gradient-based learning algorithm and show that the sample complexity needed for learning is d · poly(k)/ , where d is the dimension of θ. In Section 5, we investigate how our method performs empirically. Related Work. While the formal problem of unsupervised risk estimation was only posed recently by Donmez et al. (2010), several older ideas from domain adaptation and semi-supervised learning are also relevant. The covariate shift assumption assumes access to labeled samples from a base distribution p0(x, y) for which p∗(y | x) = p0(y | x). If p∗(x) and p0(x) are close together, we can approximate p∗ by p0 via sample re-weighting (Shimodaira, 2000; Quiñonero-Candela et al., 2009). If p∗ and p0 are not close, another approach is to assume a well-specified discriminative model family Θ, such that p0(y | x) = p∗(y | x) = pθ∗(y | x) for some θ∗ ∈ Θ; then we need only heed finite-sample error in the estimation of θ∗ (Blitzer et al., 2011; Li et al., 2011). Both assumptions are somewhat stringent — re-weighting only allows small perturbations, and mis-specified models are common in practice. Indeed, many authors report that mis-specification can lead to severe issues in semi-supervised settings (Merialdo, 1994; Nigam et al., 1998; Cozman and Cohen, 2006; Liang and Klein, 2008; Li and Zhou, 2015). As mentioned above, our approach is closer in spirit to that of Dawid and Skene (1979) and its extensions. Similarly to Zhang et al. (2014) and Jaffe et al. (2015), we use the method of moments for estimating latent-variable models However, those papers use it as a tool for parameter estimation in the face of non-convexity, rather than as a way to sidestep model mis-specification.",
      "startOffset" : 0,
      "endOffset" : 2658
    }, {
      "referenceID" : 0,
      "context" : "Anandkumar et al., 2012), it has a much older history in the econometrics literature, where it has been used as a tool for making causal identifications under structural assumptions, even when an explicit form for the likelihood is not known (Anderson and Rubin, 1949; 1950; Sargan, 1958; 1959; Hansen, 1982; Powell, 1994; Hansen, 2014). It is upon this older literature that we draw conceptual inspiration, though our technical tools are more closely based on the newer machine learning approaches. The key insight is that certain moment equations–e.g., E[f1f2 | y] = E[f1 | y]E[f2 | y]– can be derived from the assumed independencies; we then show how to estimate the risk while relying only on these moment conditions, and not on any parametric assumptions about the xv or fv. Moreover, these moment equations also hold for the gradient of fv , which enables efficient unsupervised learning. Our paper is structured as follows. In Section 2, we present our basic framework, and state and prove our main result on estimating the risk given f1, f2, and f3. In Section 3, we extend our framework in several directions, including to hidden Markov models. In Section 4, we present a gradient-based learning algorithm and show that the sample complexity needed for learning is d · poly(k)/ , where d is the dimension of θ. In Section 5, we investigate how our method performs empirically. Related Work. While the formal problem of unsupervised risk estimation was only posed recently by Donmez et al. (2010), several older ideas from domain adaptation and semi-supervised learning are also relevant. The covariate shift assumption assumes access to labeled samples from a base distribution p0(x, y) for which p∗(y | x) = p0(y | x). If p∗(x) and p0(x) are close together, we can approximate p∗ by p0 via sample re-weighting (Shimodaira, 2000; Quiñonero-Candela et al., 2009). If p∗ and p0 are not close, another approach is to assume a well-specified discriminative model family Θ, such that p0(y | x) = p∗(y | x) = pθ∗(y | x) for some θ∗ ∈ Θ; then we need only heed finite-sample error in the estimation of θ∗ (Blitzer et al., 2011; Li et al., 2011). Both assumptions are somewhat stringent — re-weighting only allows small perturbations, and mis-specified models are common in practice. Indeed, many authors report that mis-specification can lead to severe issues in semi-supervised settings (Merialdo, 1994; Nigam et al., 1998; Cozman and Cohen, 2006; Liang and Klein, 2008; Li and Zhou, 2015). As mentioned above, our approach is closer in spirit to that of Dawid and Skene (1979) and its extensions. Similarly to Zhang et al. (2014) and Jaffe et al. (2015), we use the method of moments for estimating latent-variable models However, those papers use it as a tool for parameter estimation in the face of non-convexity, rather than as a way to sidestep model mis-specification. The insight that moments are robust to model mis-specification lets us extend beyond the simple discrete settings they consider in order to handle more complex continuous and structured losses. Another approach to handling continuous losses is given in the intriguing work of Balasubramanian et al. (2011), who show that the distribution of losses L | y is often close to Gaussian in practice, and use this to estimate",
      "startOffset" : 0,
      "endOffset" : 3184
    }, {
      "referenceID" : 27,
      "context" : "1 For v = 2 views, recovering R is related to non-negative matrix factorization (Lee and Seung, 2001).",
      "startOffset" : 80,
      "endOffset" : 101
    }, {
      "referenceID" : 26,
      "context" : "The left-hand-side of each equation can be estimated from unlabeled data; we can then solve for Mv and π using tensor decomposition (Lathauwer, 2006; Comon et al., 2009; Anandkumar et al., 2012; 2013; Kuleshov et al., 2015).",
      "startOffset" : 132,
      "endOffset" : 223
    }, {
      "referenceID" : 12,
      "context" : "The left-hand-side of each equation can be estimated from unlabeled data; we can then solve for Mv and π using tensor decomposition (Lathauwer, 2006; Comon et al., 2009; Anandkumar et al., 2012; 2013; Kuleshov et al., 2015).",
      "startOffset" : 132,
      "endOffset" : 223
    }, {
      "referenceID" : 0,
      "context" : "The left-hand-side of each equation can be estimated from unlabeled data; we can then solve for Mv and π using tensor decomposition (Lathauwer, 2006; Comon et al., 2009; Anandkumar et al., 2012; 2013; Kuleshov et al., 2015).",
      "startOffset" : 132,
      "endOffset" : 223
    }, {
      "referenceID" : 25,
      "context" : "The left-hand-side of each equation can be estimated from unlabeled data; we can then solve for Mv and π using tensor decomposition (Lathauwer, 2006; Comon et al., 2009; Anandkumar et al., 2012; 2013; Kuleshov et al., 2015).",
      "startOffset" : 132,
      "endOffset" : 223
    }, {
      "referenceID" : 11,
      "context" : "It would be interesting to extend our results to other structures such as more general graphical models (Chaganty and Liang, 2014) and parse trees (Hsu et al.",
      "startOffset" : 104,
      "endOffset" : 130
    }, {
      "referenceID" : 21,
      "context" : "It would be interesting to extend our results to other structures such as more general graphical models (Chaganty and Liang, 2014) and parse trees (Hsu et al., 2012).",
      "startOffset" : 147,
      "endOffset" : 165
    }, {
      "referenceID" : 18,
      "context" : "We take a standard approach based on random projections (Halko et al., 2011) and described in",
      "startOffset" : 56,
      "endOffset" : 76
    }, {
      "referenceID" : 0,
      "context" : "2 of Anandkumar et al. (2013). We refer the reader to the aforementioned references for details, and cite only the final sample complexity and runtime (see Section D for a proof sketch): Theorem 2.",
      "startOffset" : 5,
      "endOffset" : 30
    }, {
      "referenceID" : 16,
      "context" : "We trained the model with AdaGrad (Duchi et al., 2010) on 10, 000 training examples, and used 10, 000 test examples to estimate the risk.",
      "startOffset" : 34,
      "endOffset" : 54
    }, {
      "referenceID" : 10,
      "context" : "To solve for π and M in (4), we first use the tensor power method implemented by Chaganty and Liang (2013) to initialize, and then locally minimize a weighted `-norm of the moment errors with L-BFGS.",
      "startOffset" : 81,
      "endOffset" : 107
    }, {
      "referenceID" : 8,
      "context" : "co-training and CCA) are also used in semi-supervised learning (Blum and Mitchell, 1998; Ando and Zhang, 2007; Kakade and Foster, 2007; Balcan and Blum, 2010).",
      "startOffset" : 63,
      "endOffset" : 158
    }, {
      "referenceID" : 4,
      "context" : "co-training and CCA) are also used in semi-supervised learning (Blum and Mitchell, 1998; Ando and Zhang, 2007; Kakade and Foster, 2007; Balcan and Blum, 2010).",
      "startOffset" : 63,
      "endOffset" : 158
    }, {
      "referenceID" : 24,
      "context" : "co-training and CCA) are also used in semi-supervised learning (Blum and Mitchell, 1998; Ando and Zhang, 2007; Kakade and Foster, 2007; Balcan and Blum, 2010).",
      "startOffset" : 63,
      "endOffset" : 158
    }, {
      "referenceID" : 6,
      "context" : "co-training and CCA) are also used in semi-supervised learning (Blum and Mitchell, 1998; Ando and Zhang, 2007; Kakade and Foster, 2007; Balcan and Blum, 2010).",
      "startOffset" : 63,
      "endOffset" : 158
    }, {
      "referenceID" : 23,
      "context" : ", transductive SVMs (Joachims, 1999).",
      "startOffset" : 20,
      "endOffset" : 36
    }, {
      "referenceID" : 38,
      "context" : "In addition to reliability and unsupervised learning, our work is motivated by the desire to build machine learning system with contracts, a challenge recently posed by Bottou (2015); the goal is for machine learning systems to satisfy a well-defined input-output contract in analogy with software systems (Sculley et al., 2015).",
      "startOffset" : 306,
      "endOffset" : 328
    }, {
      "referenceID" : 4,
      "context" : "Given two views, Blitzer et al. (2011) perform domain adaptation with zero source/target overlap (covariate shift is still assumed).",
      "startOffset" : 17,
      "endOffset" : 39
    }, {
      "referenceID" : 4,
      "context" : "co-training and CCA) are also used in semi-supervised learning (Blum and Mitchell, 1998; Ando and Zhang, 2007; Kakade and Foster, 2007; Balcan and Blum, 2010). These methods all assume some form of low noise or low regret, as do, e.g., transductive SVMs (Joachims, 1999). By focusing on the central problem of risk estimation, our work connects multi-view learning approaches for domain adaptation and semi-supervised learning, and removes covariate shift and low-noise/low-regret assumptions (though we make stronger independence assumptions, and specialize to discrete prediction tasks). In addition to reliability and unsupervised learning, our work is motivated by the desire to build machine learning system with contracts, a challenge recently posed by Bottou (2015); the goal is for machine learning systems to satisfy a well-defined input-output contract in analogy with software systems (Sculley et al.",
      "startOffset" : 89,
      "endOffset" : 773
    }, {
      "referenceID" : 4,
      "context" : "co-training and CCA) are also used in semi-supervised learning (Blum and Mitchell, 1998; Ando and Zhang, 2007; Kakade and Foster, 2007; Balcan and Blum, 2010). These methods all assume some form of low noise or low regret, as do, e.g., transductive SVMs (Joachims, 1999). By focusing on the central problem of risk estimation, our work connects multi-view learning approaches for domain adaptation and semi-supervised learning, and removes covariate shift and low-noise/low-regret assumptions (though we make stronger independence assumptions, and specialize to discrete prediction tasks). In addition to reliability and unsupervised learning, our work is motivated by the desire to build machine learning system with contracts, a challenge recently posed by Bottou (2015); the goal is for machine learning systems to satisfy a well-defined input-output contract in analogy with software systems (Sculley et al., 2015). Theorem 1 provides the contract that under the 3-view assumption the test error is close to our estimate of the test error; this contrasts with the typical weak contract that if train and test are similar, then the test error is close to the training error. One other interesting contract is given by Shafer and Vovk (2008), who provide prediction regions that contain the true prediction with probability 1− in the online setting, even in the presence of model mis-specification.",
      "startOffset" : 89,
      "endOffset" : 1244
    }, {
      "referenceID" : 4,
      "context" : "co-training and CCA) are also used in semi-supervised learning (Blum and Mitchell, 1998; Ando and Zhang, 2007; Kakade and Foster, 2007; Balcan and Blum, 2010). These methods all assume some form of low noise or low regret, as do, e.g., transductive SVMs (Joachims, 1999). By focusing on the central problem of risk estimation, our work connects multi-view learning approaches for domain adaptation and semi-supervised learning, and removes covariate shift and low-noise/low-regret assumptions (though we make stronger independence assumptions, and specialize to discrete prediction tasks). In addition to reliability and unsupervised learning, our work is motivated by the desire to build machine learning system with contracts, a challenge recently posed by Bottou (2015); the goal is for machine learning systems to satisfy a well-defined input-output contract in analogy with software systems (Sculley et al., 2015). Theorem 1 provides the contract that under the 3-view assumption the test error is close to our estimate of the test error; this contrasts with the typical weak contract that if train and test are similar, then the test error is close to the training error. One other interesting contract is given by Shafer and Vovk (2008), who provide prediction regions that contain the true prediction with probability 1− in the online setting, even in the presence of model mis-specification. The most restrictive part of our framework is the three-view assumption, which is inappropriate if the views are not completely independent or if the data have structure that is not captured in terms of multiple views. Since Balasubramanian et al. (2011) obtain results under Gaussianity (which would be implied by many somewhat dependent views), we are optimistic that unsupervised risk estimation is possible for a wider family of structures.",
      "startOffset" : 89,
      "endOffset" : 1656
    } ],
    "year" : 2016,
    "abstractText" : "We show how to estimate a model’s test error from unlabeled data, on distributions very different from the training distribution, while assuming only that certain conditional independencies are preserved between train and test. We do not need to assume that the optimal predictor is the same between train and test, or that the true distribution lies in any parametric family. We can also efficiently differentiate the error estimate to perform unsupervised discriminative learning. Our technical tool is the method of moments, which allows us to exploit conditional independencies in the absence of a fully-specified model. Our framework encompasses a large family of losses including the log and exponential loss, and extends to structured output settings such as hidden Markov models.",
    "creator" : "LaTeX with hyperref package"
  }
}