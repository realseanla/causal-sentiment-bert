{
  "name" : "1305.2498.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "A Further Generalization of the Finite-Population Geiringer-like Theorem for POMDPs to Allow Recombination Over Arbitrary Set Covers",
    "authors" : [ "Boris Mitavskiy", "Jun He" ],
    "emails" : [ "bom4@aber.ac.uk" ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "In recent years Monte-Carlo sampling methods, such as Monte Carlo tree search, have achieved tremendous success in model free reinforcement learning with, perhaps the most celebrated example, being the computer Go software that has beaten the top human player (see [1], for instance). Unlike the traditional techniques such as the mini-max method (that, by the way, have not succeeded for “Go”), Monte-Carlo Tree search (MCT) is based on running simulated self-plays, called “rollouts” until the end of the game when a terminal state with a known payoff has been encountered. A position in a game is represented by a state-action pair ~s = (s, ~α) where ~α = (α1, α2, . . . , αl(s)) is the collection of actions (or moves) available in a position s. The goal is to evaluate actions through back-propagation and averaging. Much effort in the current research is devoted to widening the range of applicability of the method in the environments with randomness and incomplete information. Recently, a finite population Geiringer Theorem with non-homologous recombination has been adopted to the setting of Monte-Carlo tree search, based on which efficient parallel algorithms that exploit the intrinsic similarities within the state-action space to increase exponentially the size of a simulated sample of rollouts can be developed. The importance of similarity relations when coping with POMDPs is emphasized by other researchers, see, for instance, [2]. The main idea is that the algorithms sample directly from a long term probability distribution of repeated recombination applications defined in terms of the similarities. The only limitation of the new theorem is that the notion of similarity is limited to equivalence relations partitioning the set of state-action pairs. The current work lifts this “curtain of limitation” by allowing the similarity relation to be any set cover of the set of state-action pairs. The reader is strongly encouraged to familiarize themselves with the the first four sections of [3] prior to reading the current sequel paper, where a much more detailed introduction as well as mathematical support is provided.\n∗Email: bom4@aber.ac.uk\nar X\niv :1\n30 5.\n24 98\nv1 [\ncs .A\nI] 1\n1 M"
    }, {
      "heading" : "2 Mathematical Framework and Notation",
      "text" : ""
    }, {
      "heading" : "2.1 Set Cover of the State Space",
      "text" : "Let S denote the set of states (enormous but finite in the current framework). Formally each state ~s ∈ S is an ordered pair (s, ~α) where ~α is the set of actions an agent can possibly take when in the state ~s. Let C denote an arbitrary set cover of S (i.e. C ⊆ P(S) is a collection of subsets of S such that ⋃ O∈C O = S). Given a set O ∈ C, for any two states ~s1 and ~s2 ∈ O we will say that ~s1 and ~s2 are O-similar states and write ~s1\nO∼ ~s2. Intuitively, the sets O represent certain measure of similarity between the states ~s1 and ~s2. In practice, of course, if ~s1\nO∼ ~s2, the corresponding sets of actions ~α1 and ~α2 must be related in some kind of fashion: for instance, one may require that there are functions fO,~s1, ~s2 : ~α1 → ~α2 and fO,~s2, ~s1 : ~α2 → ~α1 that provide a natural similarity correspondence among the actions. Needless to say, the choice or design of such correspondences goes hand in hand with the choice or design of the set cover C. In fact, there is a variety of ways in which this can be modeled depending on the specific applications. We leave the detailed investigations for future research.\nUnlike the framework in [3], the current setting allows various degrees and types of similarity relations that are not limited to partitions of S induced by equivalence relations. Consider, for instance, a set covering induced by a distance function d : S×S → [0, ∞) satisfying the usual axioms of a pseudo-metric: ∀x, y, z ∈ S we have d(x, x) = 0, d(x, y) = d(y, x) and d(x, z) ≤ d(x, y)+d(y, z). Such a pseudo-metric naturally induces a neighborhood structure on the set of states S: C = {B(x, ) |x ∈ S and > 0} where B(x, ) = {y | y ∈ S and d(x, y) < } is a clopen ball1. Notice further that C has a number of subcovers such as, for instance, Cr = {B(x, ) |x ∈ S and r > > 0} where r > 0 and each one of these could be used in specific applications. As mentioned in the introduction, due to an overwhelming number of states as well as incomplete information and randomness, some sort of a coarse graining of the set of states is inevitable in applications. As pointed out in [3], the primary idea of the Geiringer-like theorems for decision making in the environments with randomness and incomplete information is to exploit the similarity relations on the set of states to estimate the average action payoffs based on an exponentially larger sample of rollouts than the one simulated at a relatively little computational expense. The version of the Geiringer-like theorem presented in this paper greatly expands the variety of the similarity relations that can be used in practice, thereby significantly widening the range and the flexibility of applications.\nJust as in [3], a convenient way to represent a similarity relation C on a set of states S is to assign a positive integer to each similarity set O ∈ C in a one-to-one fashion. Each element of a set O labeled by an integer l is then uniquely determined by an additional alphabet symbol. Unlike the case in [3], it is possible for the same state to be labeled in a number of different ways as long as the corresponding integer labels differ. An example appears below.\nExample 2.1. A state space S consisting of 13 states and a set cover C consisting of 7 sets are pictured in figure 1. Notice that 1 = {1a, 1b, 1c}, 3 = {3a, 3b, 3c, 3d}, 2 = 1 ∩ 3 = {1a} = {2a} = {3a}, 5 = {5a, 5b, 5c}, 6 = {6a, 6b, 6c}, 4 = 3 ∩ 6 consists of 2 elements that can be written as pictured on the Venn diagram on figure 1 and, finally, 7 = {7a, 7b, 7c}. For i 6= j we have i ∩ j = ∅ unless {i, j} = {1, 3}, {1, 2}, {3, 2}, {3, 6}, {3, 4} or {4, 6}.\nWe end this section with a couple of simple definitions, the significance of which will become very clear in section 3.4, when we state the main theorem of the current article.\nDefinition 2.1. Given a set of state-action pairs S and a set cover C of S, consider the relation v⊆ S2 defined as x v y ⇐⇒ ∃O ∈ C such that x and y ∈ O and notice that v is a symmetric and reflexive relation. We denote by C the partition induced by the transitive closure of the relation v, we will denote this equivalence relation (the transitive closure) by '.\nRemark 2.1. Apparently, C = C ⇐⇒ C is a partition of S ⇐⇒v=' .\n1Since the set S is finite, the pseudo-metric (i.e. the distance function) can take only finitely many values thereby inducing the discrete topology on the set S (see, for instance, [4] to learn about basic point-set topology). The induced topological space is then totally disconnected so that every open ball is also a closed ball, usually abbreviated as “clopen”. In fact, in such a case it is sufficient to consider only integer-valued pseudo-metrics, yet depending on a specific application it may be sometimes more convenient to consider real or rational valued pseudo-metrics.\nAn example below illustrates definition 2.1\nExample 2.2. Continuing with example 2.1, consider the 13-element set of state-action pairs and the set cover pictured on figure 1. Then the symmetric relation\nv= {(x, y) | i ∈ N with 1 ≤ i ≤ 7, x ∈ i ∧ y ∈ i},\nthe partition C = {1 ∪ 3 ∪ 6, 5, 7} and the equivalence relation ' is the one corresponding to the partition C.\nDefinition 2.2. Given any set O ∈ C, we will say that the unique equivalence class in C, call it O, that contains O is the expansion of the similarity set O.\nExample 2.3. Continuing with examples 2.1 and 2.2, we have 1 = 2 = 3 = 4 = 6 = 1 ∪ 3 ∪ 6 while 5 = 5 and 7 = 7."
    }, {
      "heading" : "2.2 Rollouts and Recombination Operators",
      "text" : "Definition 2.3. Suppose we are given a chance node ~s = (s, ~α) and a sequence {αi}bi=1 of actions in ~α (it is possible that αi = αj for i 6= j). We may then call ~s a root state, or a state in question, the sequence {αi}bi=1, the sequence of moves (actions) under evaluation and the set of moves A = {α |α = αi for some i with 1 ≤ i ≤ b}, the set of actions (or moves) under evaluation.\nDefinition 2.4. A rollout with respect to the state in question ~s = (s, ~α) and an action α ∈ ~α is a sequence of states following the action α and ending with a terminal label f ∈ Σ where Σ is an arbitrary set of labels2, which looks as {(α, s1, s2, . . . , st−1, f)}. For technical reasons which will become obvious later we will also require that si 6= sj for i 6= j (it is possible and common to have si O v sj for various O ∈ C though). We will say that the total number of states in a rollout (which is k− 1 in the notation of this definition) is the height of the rollout.\nRemark 2.2. Notice that in definition 2.4 we included only the initial move α made at the state in question (see definition 2.3) which is the move under evaluation (see definition 2.3). The moves between the intermediate states are chosen randomly or with respect to some dynamically updated distributions and are not evaluated so that there is no reason to consider them.\n2Intuitively, each terminal label in the set Σ represents a terminal state that we can assign a numerical value to via a function φ : Σ → Q. The reason we introduce the set Σ of formal labels as opposed to requiring that each terminal label is a rational number straight away, is to avoid confusion in the upcoming definitions\nA single rollout provides rather little information about an action particularly due to the combinatorial explosion in the branching factor of possible moves of the player and the opponents. Normally a large, yet comparable with total resource limitations, number of rollouts is thrown to evaluate the actions at various positions. The challenging question which the current work addresses is how one can take full advantage of the parallel sequence of rollouts. Since the main idea is motivated by Geiringer theorem which is originated from population genetics ([5]) and later has also been involved in evolutionary computation theory ([6], [7] and [8]) we shall exploit the terminology of the evolutionary computation community here.\nDefinition 2.5. Given a state in question ~s = (s, ~α) and a sequence {αi}bi=1 of moves under evaluation (in the sense of definition 2.3) then a population P with respect to the state ~s = (s, ~α) and the sequence {αi}bi=1 is a sequence of rollouts P = {rl(i)i }bi=1 where ri = {(αi, si1, si2, . . . , sil(i)−1, fi)}. Just as in definition 2.4 we will assume that sik 6= sjq whenever i 6= j (which, in accordance with definition 2.4, is as strong as requiring that sik 6= sjq whenever i 6= j or k 6= q)3 Moreover, we also assume that the terminal labels fi are also all distinct within the same population, i.e. for i 6= j the terminal labels fi 6= fj4 In a very special case when (∃O ∈ C such that sij O v sqk) =⇒ (j = k) we will say that the population P is homologous. Loosely speaking, a homologous population is one where similar states can not appear at different “heights”.\nRemark 2.3. Each rollout r l(i) i in definition 2.5 is started with the corresponding move αi of the sequence of moves under evaluation (see definition 2.3). It is clear that if one were to permute the rollouts without changing the actual sequences of states the corresponding populations should provide identical values for the corresponding actions under evaluation. In fact, most authors in evolutionary computation theory (see [9], for instance) do assume that such populations are equivalent and deal with the corresponding equivalence classes of multisets corresponding to the individuals (these are sequences of rollouts). Nonetheless, when dealing with finite-population Geiringer-like theorems it is convenient for technical reasons (see also [7] and [8]) to assume the ordered multiset model i.e. the populations are considered formally distinct when the individuals are permuted. Incidentally, ordered multiset models are useful for other types of theoretical analysis in [10] and [11].\nExample 2.4. An example of a population of rollouts from the state space S described in example 2.1 with the set cover pictured in figure 1 appears in figure 2.\nThe main idea is that the actions taken at similar states should be interchangeable with some probability depending on the similarity level for a number of reasons such as incomplete information or simply because they are randomly explored during the simulation stage of the MCT algorithm. In the language of evolutionary computing, such a swap of moves is called a crossover. Due to randomness or incomplete information (together with the various similarity relations which can be defined using the expert knowledge of a specific game being analyzed) in order to obtain the most out of a sample (population in our language) of the parallel rollouts it is desirable to explore all possible populations obtained by making various swaps of the corresponding rollouts in similar positions. Computationally this task seems expensive if one were to run the type of genetic programming described precisely below, yet, it turns out that we can predict exactly what the limiting outcome of this “mixing procedure” would be.5 We now continue with the rigorous definitions of crossover. Crossover or recombination operators will be defined in terms of the similarities induced by the set cover much in the same way as it has been done in [3]. Nonetheless, here we are not limited to a single equivalence relation on the set of states, and many more recombination operators will be introduced depending on various similarity sets in C. For this reason it is convenient to introduce the following notion:\nDefinition 2.6. Given a state ~s ∈ S, we say that the collection of sets ~s(C) = {O |O ∈ C and ~s ∈ O} is the collection of similarity sets of the state ~s. Given states ~s1 and ~s2 ∈ S and a set O ∈ ~s1(C) ∩ ~s2(C) we say that (O, ~s1, ~s2) is a recombination-compatible triple.\n3The last assumption that all the states in a population are formally distinct (although they may be similar with respect to various sets in C) will be convenient later to extend the crossover operators from pairs to the entire populations. This assumption does make sense from the intuitive point of view as well since the exact state in most games involving randomness or incomplete information is simply unknown.\n4This assumption does not reduce any generality since one can choose an arbitrary (possibly a many to one) assignment function φ : Σ→ Q, yet the complexity of the statements of our main theorems will be mildly alleviated.\n5In this paper we will need to “inflate” the population first and then take the limit of a sequence of these limiting procedures as the inflation factor increases. All of this will be rigorously presented and discussed in subsection 3.4; see also [3].\nExample 2.5. Continuing with example 2.1, for the states 1b and 3a we have 1b(C) = {1} and 3a(C) = {1, 2, 3} so that (1, 1b, 3a) is a recombination-compatible triple while (2, 1b, 3a) is not.\nFor every recombination compatible triple we can introduce the following two recombination operators:\nDefinition 2.7. Given two rollouts\nr1 = (α1, ~s1, ~s2, . . . , ~sl(1)−1, f)\nand r2 = (α2, ~t1, ~t2, . . . ,~tl(2)−1, g)\nof lengths k(1) and k(2) respectively that share no state in common (i.e., as in definition 2.4, ) there are two (non-homologous) crossover (or recombination) operators we introduce here. For a recombination-compatible triple (O, ~u, ~v) define the one-point non-homologous crossover transformation as follows: χO, ~u,~v(r1, r2) = (r̂1, r̂2) where\nr̂1 = (α1, ~s1, ~s2, . . . , ~sk−1, ~tq, ~tq+1, . . . ,~tl(2)−1, g)\nand r̂2 = (α2, ~t1, ~t2, . . . ,~tq−1, ~sk, ~sk+1, . . . , ~sl(1)−1, f)\nif [either (~sk = ~u and ~tq = ~v) or vise versa: (~sk = ~v and ~tq = ~u)] and (r̂1, r̂2) = (r1, r2) otherwise. Likewise, we introduce a single position swap crossover: νO, ~u,~v(r1, r2) = (r̃1, r̃2) where\nr̃1 = (α1, ~s1, ~s2, . . . , ~sk−1, ~tq, ~sk+1, . . . , ~sl(1)−1, f)\nwhile r̃2 = (α2, ~t1, ~t2, . . . ,~tq−1, ~sk, ~tq+1, . . . ,~tl(2)−1, g)\nif [either (~sk = ~u and ~tq = ~v) or vise versa: (~sk = ~v and ~tq = ~u)] and (r̂1, r̂2) = (r1, r2) otherwise. In addition, a singe swap crossover is defined not only on the pairs of rollouts but also on a single rollout swapping the positions of the O-similar states ~u and ~v in the analogous manner: If\nr = (α, ~s1, . . . , ~sj−1, ~sj , ~sj+1, . . . , ~sk−1, ~sk, ~sk+1, . . . , ~sl−1, f)\nand [either (~sk = ~u and ~sq = ~v) or vise versa: (~sk = ~v and ~sq = ~u)] then\nνO, ~u,~v(r) = (α, ~s1, . . . , ~sj−1, ~sk, ~sj+1, . . .\n. . . , ~sk−1, ~sj , ~sk+1, . . . , ~sl−1, f\nif [either (~sj = ~u and ~sk = ~v) or vise versa: (~sj = ~v and ~tk = ~u)] and, of course, νO, ~u,~v(r) fixes r (i.e. νO, ~u,~v(r) = r) otherwise.\nRemark 2.4. Notice that definition 2.7 makes sense thanks to the assumption that no rollout contains an identical pair of states in definition 2.4.\nRemark 2.5. Intuitively, performing one point crossover means that the corresponding player might have changed their strategy in a similar situation due to randomness and a single swap crossover corresponds to the player not knowing the exact state they are in due to incomplete information, for instance.\nJust as in case of defining crossover operators for pairs of rollouts, thanks to the assumption that all the states in a population of rollouts are formally distinct (see definition 2.5), it is easy to extend definition 2.7 to the entire populations of rollouts. In view of remark 2.5, to get the most informative picture out of the sequence of parallel rollouts one would want to run the genetic programming routine without selection and mutation and using only the crossover operators specified above for as long as possible and then, in order to evaluate a certain move α, collect the weighted average of the terminal values (i. e. the values assigned to the terminal labels via some rational-valued assignment function) of all the rollouts starting with the move α which ever occurred in the process. We now describe precisely what the process is.\nDefinition 2.8. Given a population P and a transformation of the form χO, ~u,~v, there exists at most one pair of distinct rollouts in the population P , namely the pair of rollouts r1 and r2 such that the state ~u appears in r1 and the state ~v appears in r2. If such a pair exists, then we define the recombination transformation χO, ~u,~v(P ) = P\n′ where P ′ is the population obtained from P by replacing the pair of rollouts (r1, r2) with the pair χO, ~u,~v(r1, r2) as in definition 2.7. In any other case we do not make any change, i.e. χO, ~u,~v(P ) = P . The transformation νO, ~u,~v(P ) is defined in an entirely analogous manner with one more amendment: if the states ~u and ~v appear within the same individual (rollout), call it\nr = (α, ~s1, . . . , ~s2, . . . , ~u, . . . , ~v, . . . , ~sl−1, f),\nand the state ~u precedes the state ~v, then these states are interchanged obtaining the new rollout\nr′ = (α, ~s1, . . . , ~s2, . . . , ~v, . . . , ~u, . . . , ~sl−1, f).\nOf course, it could be that the state v precedes the state u instead, in which case the definition would be analogous: if\nr = (α, ~s1, . . . , ~s2, . . . , ~v, . . . , ~u, . . . , ~sl−1, f)\nthen replace the rollout r with the rollout\nr′ = (α, ~s1, . . . , ~s2, . . . , ~u, . . . , ~v, . . . , ~sl−1, f).\nExample 2.6. Continuing with example 2.4, applying the crossover transformation χ3, 3d, 3b to the population we obtain the population on figure 3.\nRemark 2.6. It is very important for the main theorem of our paper that each of the crossover transformations χO, ~u,~v and νO, ~u,~v is a bijection on their common domain, that is the set of all populations of rollouts at the specified chance node. As a matter of fact, the reader can easily verify by direct computation from definitions 2.8 and 2.7 that each of the transformations χO, ~u,~v and νO, ~u,~v is an involution on its domain, i.e. ∀O ∈ C and x, y ∈ O we have χ2O, ~u,~v = ν2O, ~u,~v = 1 where 1 is the identity transformation."
    }, {
      "heading" : "3 Geiringer and Geiringer-like Theorems for POMDPs and MCT.",
      "text" : ""
    }, {
      "heading" : "3.1 The Main Idea Of the Current Work",
      "text" : "Suppose a certain initial population of rollouts has been simulated during a simulation stage of the MCT. Although the rollouts have been simulated independently, similar states encountered during the simulations\nare likely to repeat in a number of settings. Assume now we were to run a GP (genetic programming) routine performing swaps (crossovers/recombinations) of rollouts in accordance with definitions 2.7 and 2.8 without any selection or mutation. Clearly the swaps correspond to potential populations of rollouts that could have been simulated just as likely, provided that something different in the environment (and/or opponent’s hand) has taken place. Intuitively speaking, if we were to run the GP longer and longer time, we would be getting significantly more enriched information about potential outcomes and hence improve the quality of the payoff estimates. The central idea behind results such as the main theorem of this article (a special case where the similarity relation is an equivalence relation (i.e. C is a partition of S) has been established in [3]) is that one can actually anticipate the long term (or limiting) frequency of occurrence of various rollouts provided such a genetic programming routine has ran. This type of predictions is what the Geiringer-like theorems are about. In [7] a rather general simple and powerful theorem (named “finite population Geiringer theorem”) has been established in the setting of Markov chains (populations being the states of the Markov chain: more on this in the next section) which tells us that under certain conditions that are satisfied by most recombination operators, the stationary distribution of this Markov chain is uniform. Furthermore, a methodology has been developed to derive what we call “Geiringer-like” theorems that address the limiting frequency of occurrence of various schemata (in our case subsets of rollouts: more on this in the upcoming subsection 3.4). Based on such a theorem it is not hard to invent efficient parallel dynamic algorithms that estimate the expected action payoff values based on the sample obtained after the entire “infinite time” run of the GP routine described above. It may be worthwhile to mention that “homologous recombination” (translating into the setting of MCT this would mean that the similarity classes may occur only at the same heights of the corresponding rollouts) versions of a Geiringer-like theorem have been obtained previously in the setting of genetic programming using the methodology appearing in [7] (see [8]). A version of Geiringer-like theorem with non-homologous recombination remained an open question and it has been established recently in [3] in a very similar setting as in the current article. While the Geiringer-like theorem in [3] is already rather interesting and powerful, it is limited to the case when the notion of similarity is measured via an equivalence relation, which does not allow any degree of similarity: any two states are either similar or not, but there is no way to judge how similar they are and every state (with the corresponding actions) of the same similarity class is evaluated indistinguishably. In the current article, we point out that this limitation can be easily alleviated to allow practically any notion of similarity among the states (i.e. an arbitrary set cover of the set of states) and, at the same time, the statement and the proof of the corresponding Geiringer like theorem are somewhat simplified. In the next section we will establish a generalization of the finite population Geiringer theorem for POMDPs in [3] that will allow us to derive the corresponding generalization of the Geiringer-like\ntheorem of [3]."
    }, {
      "heading" : "3.2 Specializing the Finite Population Geiringer Theorem to the setting of Monte Carlo Sampling for POMDPs",
      "text" : "Definition 3.1. Let n = {1, 2, . . . , n} denote the set of first n natural numbers. Consider any probability distribution µ on the set of all finite sequences of crossover transformations F = ⋃∞ n=1 Fn ∪ {1} where\nFn = ({χO, ~u,~v |O ∈ C and ~u, ~v ∈ O}∪\n∪{νO, ~u,~v |O ∈ C and ~u, ~v ∈ O})n\nwhich assigns a positive probability to the singleton sequences6 and to the identity element 1. (i.e. to every element of the subset F1 ∪ {1}. Given a sequence of transformations ~Θ = {ΘOj , ~uj , ~vj}nj=1 where each Θ is either χ or ν (i.e. ∀ j either ΘOj , ~uj , ~vj = χOj , ~uj , ~vj or ΘOj , ~uj , ~vj = νOj , ~uj , ~vj ), consider the transformation\nΘ̃ = ΘOn, ~un, ~vn ◦ΘOn−1, ~un−1, ~vn−1 ◦ . . . ◦ΘO2, ~u2, ~v2 ◦ΘO1, ~u1, ~v1\non the set of all populations starting at the specified chance node obtained by composing all the transformations in the sequence ~Θ. The identity element 1 stands for the identity map on the set of all possible populations of rollouts. Now define the Markov transition Matrix Mµ on the set of all populations of rollouts (see definition 2.5) as follows: given populations X and Y of the same size k, the probability of obtaining the population Y from the population X after performing a single crossover stage, pX→Y = µ(SX→Y ) where\nSX→Y = {Γ |Γ ∈ F and T (Γ)(X) = Y }\nwhere\nT (Γ) =\n{ Θ̃ if Γ = ~Θ\nThe identity map if Γ = 1.\nRemark 3.1. Evidently the map T : F → PP introduced at the end of definition 3.1 can be regarded as a random variable on the set F described at the beginning of definition 3.1 where P denotes the set of all populations of rollouts containing k individuals so that PP is the set of all endomorphisms (functions with the same domain and codomain) on P and the probability measure µT on P\nP is the “pushforward” measure induced by T , i.e. µT (S) = µ(T\n−1(S)).7 To alleviate the complexity of verbal (or written) presentation we will usually abuse the language and use the set F in place of PP so that a transformation F ∈ PP is identified with the entire set T−1(F ) ∈ F . For example,\nif we write µ({F |F ∈ F and F (X) = Y })\nwe mean µ({Γ |Γ ∈ F and T (Γ)(X) = Y }).\nIt may be worth pointing out that the set T−1 is not necessarily a singleton, i.e. the map T is usually not one-to-one (for instance, given any O ∈ C and any ~u, ~v ∈ O the sequence of the form ~Θ = (χO, ~u,~v, χO, ~u,~v) or of the form ~Θ = (νO, ~u,~v, νO, ~u,~v) both induce identity transformation on the set of populations of rollouts. Indeed, χO, ~u,~v ◦ χO, ~u,~v = νO, ~u,~v ◦ νO, ~u,~v = 1 since performing a swap at identical positions twice brings back the original population of rollouts.)\nRemark 3.2. Notice that any concatenation of sequences in F (which is what corresponds to the composition of the corresponding functions) stays in F . In other words, the family of maps induced by F is closed under composition.\n6This technical assumption may be altered in various manner as long as the induced Markov chain remains irreducible. 7The sigma algebra on PP is the one generated by T with respect to the sigma-algebra that is originally chosen on F , however\nin practical applications the sets involved are finite and so all the sigma-algebras can be safely assumed to be power sets.\nOf course, running the Markov process induced by the transition matrix in definition 3.1 infinitely long is impossible, but fortunately one does not have to do it. The central idea of the current paper is that the limiting outcome as time goes to infinity can be predicted exactly using the Geiringer-like theory and the desired evaluations of moves can be well-estimated at rather little computational cost in most cases. As pointed out in remark 3.1 above, each of the transformations ΘO, ~u,~v is an involution and, in particular, is bijective. Therefore, every composition of these transformations is a bijection as well. We deduce, thereby, that the family F consists of bijections only (see remark 3.1). The finite population Geiringer theorem (see [7]) now applies and tells us the following:\nDefinition 3.2. Given populations P and Q of rollouts at a specified state in question as in definition 2.5, we say that P ∼ Q if there is a transformation F ∈ F such that Q = F (P ).\nExample 3.1. The populations P and Q and R displayed in figures 2, 3 and 4 respectively are equivalent in the sense of definition 3.2 since Q = χ3, 3d, 3b(P ), R = ν5, 5a, 5b ◦ χ5, 5a, 5b ◦ χ4, 4a, 4b(Q)\nTheorem 3.1 (Geiringer Theorem for POMDPs). The relation ∼ introduced in definition 3.2 is an equivalence relation. Given a population P of rollouts at a specified state in question, the restriction of the Markov transition matrix introduced in definition 3.1 to the equivalence class [P ] of the population P under ∼ is a well-defined Markov transition matrix which induces an irreducible and aperiodic Markov chain on [P ] and the unique stationary distribution of this Markov chain is the uniform distribution on [P ].8\nKnowing that the limiting frequency of occurrence of a any two given populations Q1 and Q2 ∈ [P ] is the same, it is sometimes possible to compute the limiting frequency of occurrence of any specific rollout and even certain subsets of rollouts using the machinery developed in [7], [8] and enhanced further in [3].\nTo state and derive these “Geiringer-like” results we need to introduce the appropriate notions of schemata (see, for instance, [12] and [13]) here."
    }, {
      "heading" : "3.3 Schemata for MCT Algorithm",
      "text" : "Definition 3.3. Given a state (s, ~α) in question (see definition 2.3), a rollout Holland-Poli schema is a sequence consisting of entries from the set~α∪ C ∪ {#} ∪Σ of the form h = {xi}ki=1 for some k ∈ N such that for k > 1 we have x1 ∈ ~α, xi ∈ C when 1 < i < k represents a similarity class of states, and xk ∈ {#}∪Σ could\n8In fact, thanks to the application of the classical contraction mapping principle9 analyzed in section 6 of [3]) the stationary distribution is uniform in a rather strong sense as discussed in theorem 23 and example 24 of [3].\nrepresent either a terminal label if it is a member of the set of terminal labels Σ, or any substring defining a valid rollout if it is a # sign.10 For k = 1 there is a unique schema of the form #. Every schema uniquely\ndetermines a set of rollouts Rh =  {(x1, ~s2, ~s3, . . . , ~sk−1, xk) |~si ∈ xi for 2 < i < k − 1} if k > 1 and xk ∈ Σ {(x1, ~s2, ~s3, . . . , ~sk−1, ~tk, ~tk+1, . . . , f) |~si ∈ xi for 2 < i < k − 1, ~tj ∈ S} if k > 1 and xk = # the entire set of all possible rollouts if k = 1 or,\nequivalently, h = #.\nwhich fit the\nschema in the sense mentioned above. We will often abuse the language and use the same word schema to mean either the schema h as a formal sequence as above or schema as a set Rh of rollouts which fit the schema. For example, if h and h∗ is a schema, we will write h ∩ h∗ as a shorthand notation for Rh ∩ Rh∗ where ∩ denotes the usual intersection of sets. Just as in definition 2.4, we will say that k − 1, the number of states in the schema h, is the height of the schema h.\nExample 3.2. Continuing with example 2.1, consider the rollout Holland-Poli schema h = (β, 6, 3, 1, 4, #). Then the 3rd rollout in the population pictured in figure 4 starting with the action β fits the schema h while the rollout r = (β, 6c, 3a, 1c, 3a) does not since 3a = 1a = 2a /∈ 4 (see figure 1).\nThe notion of schema is useful for stating and proving Geiringer-like results largely thanks to the following notion of partial order.\nDefinition 3.4. Given schemata h and g we will write h > g either if h = # and g 6= # or h = (x1, x2, x3, . . . , xk−1, #) while g = (x1, x2, x3, . . . , xk−1, yk, yk+1, . . . , yl−1, yl) where yl could be either of the allowable values: a # or a terminal label f ∈ Σ. However, if yl = # then we require that l > k.\nAn obvious fact following immediately from definitions 3.3 and 3.4 is the following.\nProposition 3.2. Suppose we are given schemata h and g. Then h ≥ g =⇒ Sh ⊇ Sg.\nRemark 3.3. It may be worth pointing out that the converse of proposition 3.2 is false. Continuing with examples 2.1 and 3.2, consider, for instance, schemata h = (β, 6, 3, 1, 4, #) and g = (β, 6, 3, 1, 6, #). Evidently Sg ⊃ Sh yet the schemata h and g are incomparable in the sense of definition 3.4. Fortunately, it is only proposition 3.2 (and not the converse) that’s involved in deriving Geiringer-like theorems from theorem 3.1."
    }, {
      "heading" : "3.4 The Statement of Geiringer-like Theorems for the POMDPs",
      "text" : "In evolutionary computation Geiringer-like results address the limiting frequency of occurrence of a set of individuals fitting a certain schema (see [6], [7] and [8]). In this work our theory rests on the finite population model based on stationary distribution of the Markov chain of all populations potentially encountered in the process (see theorem 3.1). The “limiting frequency of occurrence” (rigorous definition appear in [3], [7] and [8]; an informal description is provided prior to the statement of the theorem in the current article) of a certain subset of individuals determined by a Holland-Poli schema h among all the populations in the equivalence class [P ] as time increases (i.e. as t → ∞), where P is the initial population of rollouts, will be expressed solely in terms of the initial population P and schema h. These quantities are defined below.\nDefinition 3.5. For any action under evaluation α, let α ↓ (P ) = {O |O ∈ C and at least one of the rollouts in the population P fits the Holland-Poli schema (α, O, #)}. Likewise, for an equivalence class O ∈ C define a set valued function on the populations of size b, as O ↓ (P ) = {T | ∃ states ~s ∈ O, ~t ∈ T and a rollout r in the population P such that r = (. . . , ~s, ~t, . . .) } ∪ {f | f ∈ Σ and ∃ a state ~s ∈ O and a rollout r in the\n10This notion of a schema is somewhat of a mixture between Holland’s and Poli’s notions.\npopulation P such that r = (. . . , ~s, f) }. In words, O ↓ (P ) is the collection of all equivalence classes in C together with the terminal labels which appear after the states from the equivalence class O in at least one of the rollouts from the population P .\nAs usual, we illustrate definition 3.5 with an example.\nExample 3.3. Continuing with examples 2.1 and 2.4, from figure 2 we see that the states following the action α are of types 1 and 3 and both of these similarity classes belong to the equivalence class 1 ∪ 3 ∪ 6 so that, according to definition 3.5, α ↓ (P ) = {1 ∪ 3 ∪ 6}. The only state following the action β is of type 6 and the expansion of 6 is, again, 1∪ 3∪ 6, so that β ↓ (P ) = {1∪ 3∪ 6}. The only state following the action γ is of type 5 and so γ ↓ (P ) = {5} = {5}. Various states from every equivalence class in C follow states of types 1, 3 and 6: for instance, 1c follows 3d and 5a follows 3c in the second rollout, while 7a follows 1a in the first rollout. No terminal label follows the equivalence class {1∪3∪6}. It follows then that 1∪3∪6 ↓= C. The only similarity class following states from the equivalence class 5 = 5 is 7. Terminal labels f2 and f4 follow states 5a in the second rollout and 5c in the 4th rollout. It follows than that 5 ↓ (P ) = {f2, 7, f4}. Analogously, 7 ↓ (P ) = {f1, f3, 5}.\nDefinition 3.6. Given a population P and equivalence classes O ∈ C and T ∈ O ↓ (P ) let Order(O ↓ T , P ) =\n= |{((O, a), (T , b)) | the segment ((O, a), (T , b))\nappears in one of the rollouts in the population P}|.\nLoosely speaking, Order(O ↓ T , P ) is the total number of times the equivalence class T follows the equivalence class O within the population of rollouts P .\nLet Order(O ↓ P ) = ∑ T∈O↓P Order(O ↓ T , P ) + |Σ ∩ (O ↓ T , (P ))|\ndenote the total number of states and terminal labels that follow the states from the equivalence class O in the population P .\nLikewise, given a population of rollouts P , an action α under evaluation and an equivalence class T ∈ α ↓ (P ), let\nOrder(α ↓ T , P ) = |{(α, (T , b)) | the segment (α, (T , b))\nappears in one of the rollouts in the population P}|.\nAlternatively, Order(α ↓ T , P ) is the number of rollouts in the population P fitting the rollout Holland schema (α, T , #).\nOrder(α ↓ (P )) = ∑\nT∈O↓P\nOrder(O ↓ T , P )\ndenotes the total number of states that follow the action under evaluation α in the population P .\nExample 3.4. Continuing with example 3.3, for the population P pictured in figure 2 and the set cover C displayed via a Venn diagram on figure 1, recall that α ↓ (P ) = β ↓ (P ) = {1 ∪ 3 ∪ 6} and notice that the total number of states from the only equivalence class 1∪ 3∪ 6 ∈ α ↓ that follows the action α is 2: the state 1a = 2a = 3a in the first rollout and the state 1c following the state 3d in the second rollout; while the total number of states in the only equivalence class 1∪3∪6 ∈ α ↓ that follows the action β is 1: the state 6c in the 3rd rollout. Thus Order(α ↓ 1∪3∪6, P ) = Order(α ↓ (P )) = 2 and Order(β ↓ 1∪3∪6, P ) = Order(β ↓ (P )) = 1. Likewise, Order(γ ↓ 5, P ) = Order(γ ↓ (P )) = 1. States from the equivalence class 1 ∪ 3 ∪ 6 follow their own kind 4 times in the population P : 1a = 2a = 3a follows 1b in the first rollout, 1c follows 3d and 4b = 3c = 6b follows 1c in the second rollout, while 4a = 3b = 6a follows 6c in the third rollout so that Order(1 ∪ 3 ∪ 6 ↓ 1 ∪ 3 ∪ 6, P ) = 4. The only state in the equivalence class 5 that follows a state from the equivalence class 1 ∪ 3 ∪ 6 is 5a in the second rollout, following the state 4b = 3c = 6b ∈ 1 ∪ 3 ∪ 6 so that Order(1 ∪ 3 ∪ 6 ↓ 5, P ) = 1. There are 2 states from the equivalence class 7, namely 7a and 7b, that follow the states from the equivalence class 1 ∪ 3 ∪ 6, namely 1a = 2a = 3a and 4a = 3b = 6a respectively, in the first and the third rollouts of the population P so that Order(1∪3∪6 ↓ 7, P ) = 2. No terminal label follows a\nstate from the equivalence class 1∪ 3∪ 6 and we deduce that Order(1∪ 3∪ 6 ↓ (P )) = 4 + 1 + 2 = 7. Recalling that 5 ↓ (P ) = {f2, 7, f4} and observing that the only state in the equivalence class 7 that follows a state from the equivalence class 5, namely the state 5b, is 7c, while |Σ ∩ {f2, 7, f4}| = |{f2, f4}| = 2 we deduce that Order(5 ↓ 7, P ) = 1 and Order(5 ↓ (P )) = 1 + 2 = 3. Likewise, the reader may compute the remaining numbers Order(7 ↓ 5, P ) = 1 and Order(7 ↓ (P )) = 1 + 2 = 3.\nObserve that applying any recombination transformation of the form χO,~s,~t or νO,~s,~t to a population P of rollouts neither removes any states from the population nor adds any new ones, and hence another important invariance property of the equivalent populations that opens the door for a lovely application of Markov inequality in the proof of the main theorem of the current article (see [3]) that follows from the same considerations is stated below.\nRemark 3.4. Given any population Q ∈ [P ], the total number of states in the population Q is the same as that in the population P . Apparently, as we already mentioned, the the total number of states in a population is the sum of the heights of all rollouts in that population (see definition 2.4 and 2.5). It follows then, that the sum of the heights of all rollouts within a population is an invariant quantity under the equivalence relation in definition 3.2. In other words, if Q ∼ P then the sum of the heights of the rollouts in the population Q is the same as the sum of the heights of the rollouts in the population P .\nThere is yet one more important notion, namely that of the “limiting frequency of occurrence” of a schema as one runs the genetic programming routine with recombination only we need to introduce to state the Geiringer-like results of the current paper. A rigorous definition in the most general framework appears in [3], [7] and [8]. The description below is sufficient to understand the statement of finite population Geiringer-like theorems.\nInformal Description of the Limiting Frequency of Occurrence: Given a schema h and a population P of size m, suppose we run the Markov process {Xn}∞n=0 on the populations in the equivalence class [P ] of the initial population of rollouts P as in definition 3.1.11 As discussed previously, this corresponds to “running the genetic programming routine forever” and each recombination models the changes in player’s strategies due to incomplete information, randomness personality etc. Up to time t a total of m · t individuals (counting repetitions) have been encountered. Among these a certain number, say h(t), fit the schema h in the sense of definition 3.3. We now let Φ(P, h, t) = h(t)m·t to be the proportion of these individuals fitting the schema h out of the total number of individuals encountered up to time t. Although it may be possible to derive the formulas for limt→∞Φ(P, h, t) in the most general case when the initial population of rollouts P is non-homologous12 (in other words when the states representing the same equivalence class may appear at various “heights” in the same population of rollouts: see definition 2.5), the formulas obtained in this manner would definitely be significantly more cumbersome and would not be as well suited for algorithm development13 as the limiting result with respect to “inflating” the initial population P in the sense described below. Remarkably, the formula for the limiting result in the general non-homologous initial population case coincides with the one for the homologous populations.\nDefinition 3.7. Given a population P = {rl(i)i }bi=1 of rollouts in the sense of definition 2.5, where\nri = {(αi, ~si1, ~si2, . . . , ~sil(i)−1, fi)}\nand a positive integer m, we first increase the size of the set of states S by a factor of m: formally, we update the set of states as follows:\nS := S ×m = {(~s, i) |~s ∈ S, i ∈ N and 1 ≤ i ≤ m}.\nLikewise, we also increase the terminal set of labels Σ by a factor of m so that\nΣ := Σ×m = {(f, i) | f ∈ Σ, i ∈ N and 1 ≤ i ≤ m}. 11In fact, such Markov chains don’t even have to be time homogenous: (see theorem 23 and example 24 of [3] for a detailed\nexposition. 12such exact formulas have been derived for the case of homologous recombination in the setting of GP: see [8] 13This is an open question, yet it’s practical importance is highly unclear\nCertainly, the set cover C of the original set S is naturally updated into the corresponding set cover of the updated set of states as\nC := {O |O := {(~s, i) |~s ∈ O, i ∈ N and 1 ≤ i ≤ m}}\nNow we let Pm = {rl(i)i, k }1≤i≤b and 1≤k≤m\nwhere r l(i) i, k = {(αi, (~s i 1, k), (~s i 2, k), . . . , (~s i l(i)−1, k), (fi, k))}.\nWe will say that the population Pm is an inflation of the population P by a factor of m.\nEssentially, a population Pm consists of m formally distinct copies of each rollout in the population P . Intuitively speaking, the stochastic information captured in the sample of rollouts comprising the population Pm (such as the frequency of obtaining a state in a similarity set O after a state in a similarity set T ) is the same as the one contained within the population P emphasized by the factor of m. In fact, the following rather important obvious facts make some of this intuition precise:\nProposition 3.3. Given a population P of rollouts and a positive integer m consider the inflation of the population P by a factor of m, Pm as in definition 3.7. Then the following are true:\nα ↓ (Pm) = α ↓ (P ), O ↓ (Pm) = O ↓ (P )\nwhile Order(O ↓ T , Pm) = m ·Order(O ↓ T , P ),\nNumb(α, Pm) = m ·Numb(α, P )\nand Order(O ↓, Pm) = m ·Order(O ↓, P ) (1)\nFor any population of rollouts Q let Total(Q) denote the total number of states in the population Q which is, of course, the same thing as the sum of the heights of all rollouts in the population Q. Then, clearly, Total(Pm) = m · Total(P ). In the special case when P is a homologous population, ∀m ∈ N so is the population Pm.\nRemark 3.5. We will use the same Holland-Poli schema h = (α,O1, O2, . . . , Ok−1, f) to model the corresponding sets of rollouts of the set of states S as of the set S inflated by a factor of m. Of course, Sh = S m h where Smh is the set of states inflated by a factor of m just as in proposition 3.3 above. Furthermore, it is important to point out that in the statement of the theorem below we use the sets O from the initial (non-inflated, or, alternatively, inflated by a factor of 1) population to express the limiting frequency of occurrence.\nWe are finally ready to state the main result of the current paper.\nTheorem 3.4 (The Geiringer-Like Theorem for MCT). Repeat verbatim the assumptions of theorem 3.114. Let\nh = (α, O1, O2, . . . , Ok−1, xk)\nwhere xk ∈ {#} ∪ Σ be a given Holland-Poli schema. For m ∈ N consider the random variable Φ(Pm, h, t) described in the paragraph just above (alternatively, a rigorous definition in the most general framework appears in [3], [7] and [8]) with respect to the Markov process Xmn where m indicates that the initial population of rollouts is the inflated population Pm as in definition 3.7. Then\nlim m→∞ lim t→∞\nΦ(Pm, h, t) = Numb(α, P ) b · k−1∏ q=1 |Oq| |Oq| ×\nOrder(α ↓ O1, P ) Order(α ↓, P ) · k−1∏ q=1 Order(Oq−1 ↓ Oq, P ) Order(Oq−1 ↓, P ) · LF(P, h) (2)\n14This theorem holds based on the same argument under the assumption of a more general theorem 23 of [3]\nwhere\nLF(P, h) =  1 if xk = #\n0 if xk = f ∈ Σ and f /∈ Ok−1 ↓ (P ) Fraction if xk = f ∈ Σ and f ∈ Ok−1 ↓Σ (P )\nwhere\nFraction = 1\nOrder(Ok−1 ↓, P ) (we write “LF” as short for “Last Factor”). Furthermore, in the special case when the initial population P is homologous (see definition 2.5), one does not need to take the limit as m → ∞ in the sense that limt→∞Φ(Pm, h, t) is a constant independent of m and its value is given by the right hand side of equation 2.\nRemark 3.6. Notice a simplification in the statement of theorem 3.4 here: unlike the case in [3], thanks to the assumption that the state space S contains no states that are not present in the initial population P , the denominators of the multiples in the right hand side of equation 2 are never 0. As mentioned before, this assumption does not reduce the generality since one can always shrink or enlarge the set of states S and modify the collection C of similarity sets according to the population of rollouts under consideration.\nExample 3.5. Continuing with examples 2.1, 2.4 and 3.4, consider the Holland-Poli rollout schema h = (β, 4, 7, 5, f2). Since the population P consists of exactly 4 rollouts, b = 4 and, since the action β occurs only once in the population P , Numb(β, P ) = 1. Then, according to theorem 3.4, we have\nlim m→∞ lim t→∞\nΦ(Pm, h, t) = 1 4 · |4| |1 ∪ 3 ∪ 6| · |7| |7| |5| |5| ×\n×Order(β ↓ (1 ∪ 3 ∪ 6), P ) Order(β ↓ (P )) · Order((1 ∪ 3 ∪ 6) ↓ 7, P ) Order((1 ∪ 3 ∪ 6) ↓ (P )) ×\n×Order(7 ↓ 5, P ) Order(7 ↓ (P )) · 1 Order(5 ↓ (P )) =\nafter plugging in values from example 3.4 =\n= 1 4 · 2 7 · 1 · 1 · 1 · 2 7 · 1 3 · 1 3 = 1 441 ."
    }, {
      "heading" : "3.5 Deriving Theorem 3.4 for the MCT algorithm",
      "text" : "The crucial step in establishing theorem 3.4 has been the observation that recombination operators can be defined over arbitrary set cover of the set of state-action pairs in a bijective manner so that the general finite population Geiringer theorem in [7] (it is also presented and extended for non-homogenous time Markov processes in [3]) applies. This result is stated in theorem 3.1 of the current article. We now know that the stationary distribution of the Markov chain over the set of all populations started with an initial population Pm that’s obtained by inflating a given population P by a factor of m, call it [Pm]F (see subsection 3.2 for the detailed description of the family of recombination transformations F and the associated Markov chain), is the uniform distribution over [Pm]. At the same time, we may consider the family of recombination transformations F defined with respect to the set cover C in place of C (the details of how this is done are presented in subsection 3.2). Since C is a partition of the set of states, we can now apply theorem 40 of [3] (the particular case of theorem 3.4) to deduce the following. Let [Pm]F denote the set of all populations that can be obtained from the population Pm after applying the transformations from the family F . Then, if\nh̄ = (α, O1, O2, . . . , Ok−1, xk) (3)\nis a given Holland-Poli rollout schema, we have\nlim m→∞ lim t→∞ Φ(Pm, h̄, t) =\n= Numb(α, P ) b · k−1∏ q=1 Order(Oq−1 ↓ Oq, P ) Order(Oq−1 ↓, P ) · LF(P, h) (4)\nwhere\nLF(P, h) =  1 if xk = #\n0 if xk = f ∈ Σ and f /∈ Ok−1 ↓ (P ) Fraction if xk = f ∈ Σ and f ∈ Ok−1 ↓Σ (P )\nand\nFraction = 1\nOrder(Ok−1 ↓, P ) Although there is a formal difference between the sets of populations [Pm]F and [Pm]F mainly due to distinct labeling policies, if we extend the notion of a Holland-Poli rollout schema in a natural way to the set of all possible rollouts from the populations in [Pm]F so that a rollout r fits the schema h̄ introduced in equation 3 if and only if it fits at least one schema of the form\nh = (α, T1, T2, . . . , Tk−1, xk)\nwhere Ti = Oi whenever 1 ≤ i ≤ k−1 (In other wards, the set of rollouts defined by the schema h̄ in equation 3 is the union of the sets of rollouts represented by the schemata the extension of the similarity classes of which are precisely the corresponding equivalence classes appearing in h̄), then we claim that ∀m ∈ N, the fraction of occurrence of the schema h̄ in the set of populations [Pm]F is the same as it is in the populations [Pm]F (of course, since the corresponding unique stationary distributions of the two Markov chains are uniform, it follows that ∀m ∈ N limt→∞ΦF (Pm, h̄, t) = limt→∞ ΦF (Pm, h̄, t)). To see the assertion in the previous sentence, consider the functions φ1 : [Pm]F → PEquivSchematam and φ2 : [Pm]F → P EquivSchemata m where the sets PEquivSchematam and P EquivSchemata\nm are obtained from the corresponding sets of populations in [Pm]F and in [Pm]F respectively by replacing every label of the form (O1, O2, . . . , Ol(~u) ~u) (where, of course, Oi ∈ {O |O ∈ C and ~u ∈ O}) with the corresponding label O1 (notice that whenever 1 ≤ i ≤ l(~u), we have Oi = O1 since ⋂l(~u) i=1 Oi ⊇ {~u} 6= ∅ so that all of the sets Oi are within the same equivalence class of the transitive closure of the symmetric and reflexive relation induced by the set cover C). The functions φ1 and φ2 are, essentially, the “projections” onto the sets P EquivSchemata m and P EquivSchemata\nm : given a population Q ∈ [Pm]F (or Q ∈ [Pm]F ), simply replace the labels of every rollout with the unique equivalence class label as described in the preceding sentence, thereby obtaining an element of PEquivSchematam (or P EquivSchemata\nm ). Notice that if we are given an initial population P of rollouts, the states can be labeled either according to the similarity relation C or C on the set of states. While these populations are formally distinct (in terms of labeling only: one of them is considered to be an initial population in the set [Pm]F while the other one is the corresponding initial population in the set [Pm]F ), let’s call them P and P , the corresponding images of these populations under the maps φ1 and φ2 are obviously identical. In fact, a lot more is true:\nLemma 3.5. ∀m ∈ N we have PEquivSchematam = P EquivSchemata m\n.\nProof. Since there are more possibilities for recombination when using the family of transformations F rather than the family of transformations F that only allows immediate swaps of sub-rollouts at the states that are subsets of a particular similarity set O ⊆ O, it is clear that\nPEquivSchematam ⊆ P EquivSchemata m .\nThe reverse inclusion follows from the definition of the transitive closure of a symmetric and reflexive relation. In fact, as mentioned in the sentence preceding the statement of lemma 3.5,\nPEquivSchematam ∩ P EquivSchemata m ⊇ {φ1(Pm) = φ2(Pm)} 6= ∅.\nSince every population U ∈ [Pm]F is obtained via a finite number of applications of the transformations of the form ΘO, ~u,~v ∈ F (see definition 3.1), by the principle of induction, it is sufficient to show that if we are given a population Q ∈ [Pm]F with φ1(Q) = φ2(Q), then ∀ transformation of the form ΘO, ~u,~v ∈ F , ∃ a finite sequence {ΘOj , ~uj , ~vj}kj=1 of crossover transformations in F such that φ2 ( ΘO, ~u,~v(Q) ) =\nφ1 ( ΘOk, ~uk, ~vk ◦ΘOk−1, ~uk−1, ~vk−1 ◦ . . . ◦ΘO1, ~u1, ~v1(Q) ) . (5)\nSince ~u ' ~v (see definition 2.1 and remark 2.1), ∃ a sequence of similarity classes O1, O2, . . . , Ol−1, Ol ∈ O with O1 = O and a corresponding sequence of states ~u = ~u1, ~u2, . . . , ~ul = ~v with ~u1 ∈ O1, and, whenever 1 < i ≤ l, ~ui ∈ Oi−1 ∩ Oi (evidently, in this case, ∀ i with 1 ≤ i ≤ l, we have Oi = O1 = O). Observing that the function φ1 (as well as φ2, of course), is invariant under the applications of the single swap crossover transformations (recall definitions 2.7 and 2.8) we deduce that φ1(Q) = φ1(Q1) where\nQ1 = νOl−1, ~ul, ~ul−1 ◦ νO3, ~u4, ~u3 ◦ . . . ◦ νO2, ~u3, ~u2(Q).\nAt the same time, the corresponding states ~u and ~v in the population Q1 are O1 similar (recall the beginning of\nsection 2) so that φ1 (Θ(O1, ~u, ~v)) (Q1) = φ2 ( ΘO, ~u,~v(Q) ) thereby producing a desired sequence of crossover transformations for the equality in 5 to hold and finishing the argument.\nEvidently, the number of rollouts fitting the schema h̄ in a population Q ∈ [Pm]F is the same as that in the population φ1(Q) ∈ PEquivSchematam (in fact, this is precisely the way to count them, according to the way φ1 is defined). Likewise, of course, the same holds for the population Q ∈ [Pm]F : the number of rollouts fitting the schema h̄ in the population Q is the same as the corresponding number in φ2(Q) ∈ P EquivSchemata\nm = P EquivSchemata m according to lemma 3.5. Evidently, the total number of states fitting a given similarity class O ∈ C (as well as these fitting its expansion, O) remains invariant after an application of any of the possible recombination transformations. Since the functions φ1 and φ2 are both invariant under the applications of the single-swap crossover transformations of the form νO, ~u, ~u, and, of course, every permutation is a composition of transpositions, for every population H ∈ PEquivSchematam = P EquivSchemata\nm the size of the pre-image φ−11 (H) = ∏ O∈C (m · |O|)! while φ −1 2 (H) = ∏ O∈C ( m · |O| ) !, it follows, in particular, that ∃ k depending only on the inflation factor m, such that ∀H ∈ PEquivSchematam = P EquivSchemata\nm we have φ−11 (H) = k · φ −1 2 (H). It is now apparent that the fraction of occurrence of rollouts fitting the schema h̄ out of the total number of rollouts in [Pm], is the same as that out of the total number of rollouts in [Pm] and is that out of PEquivSchematam = P EquivSchemata m . Thus, we have now shown the following intermediate fact:\nLemma 3.6. ∀m ∈ N we have\nlim t→∞ ΦF (Pm, h̄, t) = lim t→∞ ΦF (Pm, h̄, t)\nso that, in particular, the equality in 4 holds.\nThe remaining part of the argument proceeds in a very similar manner as the proof of theorem 40 in [3].15 Due to space limitations we provide only an outline of the argument reminding the cornerstones and the mathematical tools developed in [7] and largely enhanced in [3]. The first important step is the following fact (lemma 48 of [3]) that allows us to derive Geiringer-like results in terms of the fraction of populations where a rollout fitting a given schema h occurs in a specified position (say, the first individual) in the population out of the total number of populations in [Pm]F .\nLemma 3.7. Given a subset S ⊆ Ω of rollouts and an initial population of rollouts, P , under the assumptions of theorem 3.4, it is true that\nlim t→∞ Φ(S, Pm, t) = |V(Pm, S)| |[Pm]F |\nwhere the set V(Pm, S) is the set of populations in [Pm]F the first rollout of which, call it r1 ∈ S. 15Certainly, lemma 3.6 can be established by nearly repeating the derivation of theorem 40 in [3], yet the argument presented in the current paper is shorter.\nIn view of lemma 3.7, our goal is to estimate the ratio of the form |V(Pm, h)||[Pm]F | and, afterwards, to compute\nthe limit as m→∞. We accomplish this task step by step: combining lemmas 3.6 and 3.7 we deduce that\nlim m→∞ |V(Pm, h̄)| |[Pm]F | =\n= Numb(α, P ) b · k−1∏ q=1 Order(Oq−1 ↓ Oq, P ) Order(Oq−1 ↓, P ) · LF(P, h).\nCertainly we can write h̄ = h0 ⊇ h1 ⊇ . . . ⊇ hk−1 = h\nwhere hi = (α, O1, O2, . . . , Oi−1, Oi, Oi+1, Oi+2, . . . , Ok−1, xk)\nis the Holland-Poli schema with respect to the set cover C ∪ C. Now we can write\n|V(Pm, h)| |[Pm]F | = |V(Pm, hk−1)| |V(Pm, hk−2)| · |V(Pm, hk−2)| |V(Pm, hk−3)| · . . . · |V(Pm, h0)| |[Pm]F |\nas a “telescoping” product so that\nlim m→∞ |V(Pm, h)| |[Pm]F | =\n= ( k−2∏ i=1 lim m→∞ |V(Pm, hk−i)| |V(Pm, hk−i+1)| ) · lim m→∞ |V(Pm, h̄)| |[Pm]F | =\n= ( k−2∏ i=1 lim m→∞ |V(Pm, hk−i)| |V(Pm, hk−i+1)| ) ×\n×Numb(α, P ) b · k−1∏ q=1 Order(Oq−1 ↓ Oq, P ) Order(Oq−1 ↓, P ) · LF(P, h). (6)\nand, thanks to equation 6, all that remains to establish theorem 3.4 at this point is to show that ∀ i ∈ {1, 2, . . . , k − 1} we have\nlim m→∞ |V(Pm, hi)| |V(Pm, hi−1)| = |Oi| |Oi−1| . (7)\nThe main tools involved in deriving equation 7, just as in establishing theorem 40 in [3], are the Markov inequality and the lumping quotients of Markov chains technique in the same way as in [3]. The lumping quotient method modified for specific applications such as in the current paper, is described in details in subsection 5.3 of [3]. Rather than estimating the ratio\nRmi = |V(Pm, hi)| |V(Pm, hi−1)|\n(8)\ndirectly, it is more convenient to estimate the closely related ratio\nR̃mi = V(Pm, hi)\nV(Pm, hi−1 \\ hi) . (9)\nIndeed, an elementary algebraic manipulation shows that\nRmi = 1\n1 + 1 R̃mi\n. (10)\nThe way to estimate the ratio in equation 9, is to construct a Markov chain (possibly non-irreducible) having a symmetric Markov transition matrix, so that the uniform probability distribution is one of its stationary\ndistributions, call it πim on V(Pm, hi−1) and to express the ratio R̃mi in equation 9 in terms of the ratio of the corresponding probabilities under the uniform probability distribution πim:\nR̃mi = πim(V(Pm, hi))\nπim(V(Pm, hi−1 \\ hi)) .\nWe then make use of lemma 55 in subsection 5.3 of [3] to estimate the ratio R̃mi in terms of the ratios of the corresponding generalized transition probabilities between the subsets\n(1− δ)λ1 (1− δ)κ2 + δ ≤ R̃mi = πim (V(Pm, hi)) πim (V(Pm, hi−1 \\ hi)) ≤\n(1− δ)κ1 + δ (1− δ)λ2\n(11)\nwhere λ1, λ2, κ1 and κ2 are the corresponding bounds on the appropriate generalized transition probabilities (see subsection 5.3 of [3] for details), while 0 < δ 1 is an arbitrary given small constant and the inequality 11 holds ∀m > Mδ. For the sake of completeness, lemma 55 of [3] is stated below.\nLemma 3.8. Let {px→y}x, y∈X denote a Markov transition matrix over a finite state space X . Suppose π is a stationary distribution of this Markov chain (i.e. a fixed point of the associated Markov transition matrix) Suppose A and B ⊆ X is a complementary pair of subsets (i.e. A∩B = ∅ and A∪B = X ). Suppose further that U ⊆ X is such that\nπ(U ∩A) π(A) < δ < 1 and π(U ∩B) π(B) < δ < 1.\nAssume now that we find constants λ1, λ2, κ1 and κ2 such that ∀ b ∈ U c ∩ B we have λ1 ≤ pb→A ≤ κ1 and ∀ a ∈ U c ∩ A we have λ2 ≤ pa→B ≤ κ2. (given a state x ∈ X and a subset Y ∈ X , px→y = ∑ y∈Y px→y). Then we have (1− δ)λ1\n(1− δ)κ2 + δ ≤ π(A) π(B) ≤ (1− δ)κ1 + δ (1− δ)λ2\nSince the argument proceeds along exactly the same steps and ideas as the proof of theorem 40 presented in section 5 of [3], we provide only a very rough and brief outline within a few sentences. The Markov chain on the state space V(Pm, hi−1) is constructed as follows: given a population Q ∈ V(Pm, hi−1), the first rollout of P fits the schema hi−1 (so that, in particular, the i\nth state of this rollout, call it ~s ∈ Oi). Let Mobile(Q, i−1) denote the set of all states in Oi that do not appear within the first rollout in the population Q. Now select a state ~t ∈ Oi uniformly at random and apply the one point crossover transformation χOi,~s,~t to the population Q, thereby obtaining a new population χOi,~s,~t(Q) ∈ V(Pm, hi−1) that is different from Q if and only if ~s ∈ Mobile(Q, i−1). Due to the fact that recombination is non-homologous (i.e. it may take place at distinct hight of various rollouts) the height of the first rollout may be arbitrarily large and, at first glance, it seems that the set Mobile(Q, i − 1) may vary in size greatly from population to population, nonetheless, we make a crucial observation that as the inflation factor m → ∞, the sizes of each of the similarity sets O ∈ C and O ∈ C increase linearly by the factor of m in size, while the average height of the first rollout in a population stays constant and is the same as the average height of the population P (this is due to the fact that all recombination transformations preserve the total number of states within the population, and in particular, the average height of the population, and, at the same time, inflating a population by any factor m ∈ N also preserves the average height). A lovely application of the classical Markov inequality now shows that as the inflation factor m→∞, the probability that the first rollout contains a fixed (δ-size) fraction of states from any given similarity set O ∈ C (and, even more so, O ∈ C) goes to 0 (all of the technical details are entirely analogous to the ones presented in section 5 of [3]). Now let A = V(Pm, hi), B = V(Pm, hi−1\\hi) and, for a given δ > 0 select M ∈ N large enough so that ∀m > M\nπim ( V(Pm, hi) ∩ U δ·const(i)m ) πim(V(Pm, hi−1)) < δ (12)\nand\nπim ( V(Pm, hi−1 \\ hi) ∩ U δ·const(i)m ) πim(V(Pm, hi−1)) < δ (13)\nwhere U δ·const(i) m denotes the set of all populations in [Pm]F with the property that the height of the first rollout in such populations is at least M = E(H1)(const(i)·δ)2 and H1 denotes the random variable measuring the height of the first rollout in a population selected from the set [Pm]F uniformly at random, while const(i) > 0 depends only on the schema h and the initial population P of rollouts.16 It is easy to see from the construction of this auxiliary Markov chain, that the transition matrix {pQ→R}Q and R∈V(Pm, hi−1) is symmetric so that the uniform probability distribution πim is a stationary distribution of this Markov chain, and, furthermore, ∀ population Q ∈ V(Pm, hi−1 \\ hi) \\ Uδ·const(i)m we have\nλ1 = |Oi| − δ |Oi| =\n= m · |Oi| −m · δ m · |Oi| ≤ m · |Oi| −Mobile(Q, i− 1) m · |Oi| =\npQ→V(Pm, hi) ≤ m · |Oi| m · |Oi| = |Oi| |Oi| = κ1 (14)\nand, likewise, ∀ population Q ∈ V(Pm, hi) \\ Uδ·const(i)m we have\nλ2 = |Oi| − |Oi| − δ\n|Oi| =\n= m · (|Oi| − |Oi|)−m · δ m · |Oi| = m · (|Oi \\Oi|)−m · δ m · |Oi| ≤\n≤ m · (|Oi| − |Oi|)−Mobile(Q, i− 1) m · |Oi| = pQ→V(Pm, hi) ≤\n≤ m · (|Oi| − |Oi|) m · |Oi| = |Oi| − |Oi| |Oi| = κ2 (15)\nso that lemma 3.8 immediately yields the bounds\n|Oi|−δ |Oi| (1− δ)\n(1− δ) |Oi|−|Oi||Oi| + δ ≤ π\ni m (V(Pm, hi))\nπim (V(Pm, hi−1 \\ hi)) ≤\n(1− δ) |Oi||Oi| + δ\n(1− δ) |Oi|−|Oi|−δ|Oi| (16)\nGiven any δ > 0, the “sandwich” bounds in the inequality 16 hold for all sufficiently large m depending on the δ so that taking the limit of both sides as δ → 0 finally tells us that\nlim m→∞ |V(Pm, hi)| |V(Pm, hi−1 \\ hi)| =\n= lim m→∞ πim (V(Pm, hi)) πim (V(Pm, hi−1 \\ hi)) = |Oi| |Oi| − |Oi| (17)\nand equation 7 follows from equation 17 via equation 10 thereby finishing the proof of theorem 3.4.\n16We invite the reader to study section 5 of [3] to understand how the constants const(i) > 0 are selected and why the inequalities 12 and 13 hold."
    }, {
      "heading" : "4 Conclusions",
      "text" : "In the current paper we have significantly generalized a novel version of a finite population Geiringer-like theorem with non-homologous recombination established in [3] by allowing similarity relations on the set of state-action pairs to be modeled in terms of arbitrary set covers of the state-action space (not necessarily partitions induced by equivalence relations). This raises questions regarding further potential applications of Geiringer-like theorems for decision making to the design, of novel algorithms for pay-off-based clustering."
    } ],
    "references" : [ {
      "title" : "A schema theory based extension of geiringer’s theorem for linear gp and variable length gas under homologous crossover",
      "author" : [ "R. Stephens C. Wright A. Poli", "J. Rowe" ],
      "venue" : "In Foundations of Genetic Algorithms",
      "citeRegEx" : "6",
      "shortCiteRegEx" : "6",
      "year" : 2003
    }, {
      "title" : "A schema-based version of geiringer theorem for nonlinear genetic programming with homologous crossover",
      "author" : [ "B. Mitavskiy", "J. Rowe" ],
      "venue" : "In Foundations of Genetic Algorithms",
      "citeRegEx" : "8",
      "shortCiteRegEx" : "8",
      "year" : 2005
    } ],
    "referenceMentions" : [ {
      "referenceID" : 0,
      "context" : "Since the main idea is motivated by Geiringer theorem which is originated from population genetics ([5]) and later has also been involved in evolutionary computation theory ([6], [7] and [8]) we shall exploit the terminology of the evolutionary computation community here.",
      "startOffset" : 174,
      "endOffset" : 177
    }, {
      "referenceID" : 1,
      "context" : "Since the main idea is motivated by Geiringer theorem which is originated from population genetics ([5]) and later has also been involved in evolutionary computation theory ([6], [7] and [8]) we shall exploit the terminology of the evolutionary computation community here.",
      "startOffset" : 187,
      "endOffset" : 190
    }, {
      "referenceID" : 1,
      "context" : "Nonetheless, when dealing with finite-population Geiringer-like theorems it is convenient for technical reasons (see also [7] and [8]) to assume the ordered multiset model i.",
      "startOffset" : 130,
      "endOffset" : 133
    }, {
      "referenceID" : 1,
      "context" : "It may be worthwhile to mention that “homologous recombination” (translating into the setting of MCT this would mean that the similarity classes may occur only at the same heights of the corresponding rollouts) versions of a Geiringer-like theorem have been obtained previously in the setting of genetic programming using the methodology appearing in [7] (see [8]).",
      "startOffset" : 360,
      "endOffset" : 363
    }, {
      "referenceID" : 1,
      "context" : "Knowing that the limiting frequency of occurrence of a any two given populations Q1 and Q2 ∈ [P ] is the same, it is sometimes possible to compute the limiting frequency of occurrence of any specific rollout and even certain subsets of rollouts using the machinery developed in [7], [8] and enhanced further in [3].",
      "startOffset" : 283,
      "endOffset" : 286
    }, {
      "referenceID" : 0,
      "context" : "In evolutionary computation Geiringer-like results address the limiting frequency of occurrence of a set of individuals fitting a certain schema (see [6], [7] and [8]).",
      "startOffset" : 150,
      "endOffset" : 153
    }, {
      "referenceID" : 1,
      "context" : "In evolutionary computation Geiringer-like results address the limiting frequency of occurrence of a set of individuals fitting a certain schema (see [6], [7] and [8]).",
      "startOffset" : 163,
      "endOffset" : 166
    }, {
      "referenceID" : 1,
      "context" : "The “limiting frequency of occurrence” (rigorous definition appear in [3], [7] and [8]; an informal description is provided prior to the statement of the theorem in the current article) of a certain subset of individuals determined by a Holland-Poli schema h among all the populations in the equivalence class [P ] as time increases (i.",
      "startOffset" : 83,
      "endOffset" : 86
    }, {
      "referenceID" : 1,
      "context" : "A rigorous definition in the most general framework appears in [3], [7] and [8].",
      "startOffset" : 76,
      "endOffset" : 79
    }, {
      "referenceID" : 1,
      "context" : "12such exact formulas have been derived for the case of homologous recombination in the setting of GP: see [8] 13This is an open question, yet it’s practical importance is highly unclear",
      "startOffset" : 107,
      "endOffset" : 110
    }, {
      "referenceID" : 1,
      "context" : "For m ∈ N consider the random variable Φ(Pm, h, t) described in the paragraph just above (alternatively, a rigorous definition in the most general framework appears in [3], [7] and [8]) with respect to the Markov process X n where m indicates that the initial population of rollouts is the inflated population Pm as in definition 3.",
      "startOffset" : 181,
      "endOffset" : 184
    } ],
    "year" : 2014,
    "abstractText" : "A popular current research trend deals with expanding the Monte-Carlo tree search sampling methodologies to the environments with uncertainty and incomplete information. Recently a finite population version of Geiringer theorem with nonhomologous recombination has been adopted to the setting of Monte-Carlo tree search to cope with randomness and incomplete information by exploiting the entrinsic similarities within the state space of the problem. The only limitation of the new theorem is that the similarity relation was assumed to be an equivalence relation on the set of states. In the current paper we lift this “curtain of limitation” by allowing the similarity relation to be modeled in terms of an arbitrary set cover of the set of state-action pairs.",
    "creator" : "LaTeX with hyperref package"
  }
}