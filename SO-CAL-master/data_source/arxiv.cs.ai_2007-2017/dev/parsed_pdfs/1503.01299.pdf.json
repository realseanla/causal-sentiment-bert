{
  "name" : "1503.01299.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Telling cause from effect in deterministic linear dynamical systems",
    "authors" : [ "Naji Shajarisales", "Dominik Janzing", "Bernhard Schölkopf", "Michel Besserve" ],
    "emails" : [ "michel.besserve}@tuebingen.mpg.de" ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :1\n50 3.\n01 29\n9v 1\n[ cs\n.A I]\nInferring a cause from its effect using observed time series data is a major challenge in natural\nand social sciences. Assuming the effect is generated by the cause trough a linear system,\nwe propose a new approach based on the hypothesis that nature chooses the “cause” and the\n“mechanism that generates the effect from the cause” independent of each other. We therefore\npostulate that the power spectrum of the time series being the cause is uncorrelated with the\nsquare of the transfer function of the linear filter generating the effect. While most causal\ndiscovery methods for time series mainly rely on the noise, our method relies on asymmetries of\nthe power spectral density properties that can be exploited even in the context of deterministic\nsystems. We describe mathematical assumptions in a deterministic model under which the\ncausal direction is identifiable with this approach. We also discuss the method’s performance\nunder the additive noise model and its relationship to Granger causality. Experiments show\nencouraging results on synthetic as well as real-world data. Overall, this suggests that the\npostulate of Independence of Cause and Mechanism is a promising principle for causal inference\non empirical time series."
    }, {
      "heading" : "1 Introduction",
      "text" : "A major challenge in the study of complex natural systems is to infer the causal relationships between elementary characteristics of these systems. This provides key information to understand the underlying mechanisms at play and possibly allows to intervene on them to influence the overall behavior of the system. While causal knowledge is traditionally built by performing experiments, boiling down to modifying a carefully selected parameter of the system and analyzing the resulting changes, many natural systems do not allow such interventions without tremendous cost or complexity. For example, it is very difficult to influence the activity of a specific brain region without influencing other properties of the neural system [15]. Causal inference methods have been developed to avoid such intervention and infer the causal relationships from observational data only\n[23, 18]. To be able to build such knowledge without interventions, these approaches have to rely on key assumptions pertaining to the mechanisms generating the observed data.\nThe framework of causality in [23, 18] has originally addressed this question by modelling observations as i.i.d. random variables. However, observed data from complex natural system are often not i.i.d. and time dependent information reflects key aspects of those systems. Most causal inference methods for time series, including the most widely used Granger causality [8], assume the data is generated from a stochastic model through a structural equation linking past values to future ones through an i.i.d. additive noise term, the “innovation of the process” [8, 19]. While these methods can successfully estimate the causal relationships when empirical data is generated according to the model assumptions, the results can be misleading when the model is misspecified. In particular, this is the case when unknown time lags are introduced in the measured time series.\nIn this paper, we introduce a new approach to inferring causal directions in time series, the Spectral Independence Criterion (SIC). The idea behind SIC, as well as several new approaches to causal inference [7, 11, 10, 26], is to rely on the ‘philosophical’ principle that the cause and the mechanism that generates the cause from the effect are chosen independently by Nature. Thus, these two objects should not contain any information about each other [12, 14, 21]. Here, we refer to this abstract principle as the postulate of Independence of Cause and Mechanism (ICM). The above mentioned methods relying on ICM refer to different domains and rely on quite different formalizations of the concept of “independence”. SIC formalizes the ICM postulate in the context where both cause and effect are stationary time series and the cause generates the effect trough a linear time invariant filter. The SIC postulate assumes that the frequency spectrum of the cause does not correlate with the transfer function of the filter. This assumption is justified by its connection to the Trace Method [10] and by a generative model of the system. Under this postulate, we prove that SIC can tell the causal direction of the system from its anticausal counterpart. Moreover, we elaborate on the connection between this novel framework and linear Granger causality, showing they are exploiting fundamentally different information from the observed data. In addition, superiority to Granger causality is shown analytically in the context of time series measurements perturbed by an unknown time lag. We perform extensive experimental comparisons, both on simulated and real datasets. In particular, we show that our approach outperforms Granger causality to estimate the direction of causation between to structures of rat hippocampus using Local Field Potential (LFP) recordings.\nOverall, the proposed method offers a new approach to causal inference for time series data with identifiability results, and shows unprecedented robustness to measurement delays. The promising empirical results suggest the SIC postulate is a reasonable assumption for empirical data, and that it should be further exploited to develop novel causal inference techniques."
    }, {
      "heading" : "2 Spectral Independence Criterion (SIC)",
      "text" : ""
    }, {
      "heading" : "2.1 Notations and model description",
      "text" : "We refer to a sequence of real or complex numbers a = {at, t ∈ Z} as a deterministic time series. Its discrete Fourier transform is defined by\nâ(ν) = ∑\nt∈Z\nat exp(−i2πνt), ν ∈ [−1/2, 1/2] =: I\nThe energy of the deterministic time series is the squared l2 norm: ‖a‖22 = ∑ t |at| 2. For ease of notation we will also use the Z-transform of a\nã(z) = ∑\nt∈Z\natz −t, z ∈ C\nsuch that â(ν) = ã(exp(i2πν)).\nWe assume that the causal mechanism is given by a (deterministic) Linear Time Invariant (LTI)\nfilter. That is, the causal mechanism is formalized by the convolution\ny = {yt} = { ∑\nτ∈Z\nxt−τhτ } = x ∗ h, (1)\nwhere h denotes the impulse response, x the input time series and y the output. We will assume that the filter satisfies the Bounded Input Bounded Output (BIBO) stability property [20], which boils down to the condition ‖h‖1 < +∞. Under this assumption, the Fourier transform ĥ is well defined and we call it the transfer function of the system.\nWe assume that the input time series x is a sample drawn from a stochastic process, {Xt, t ∈ Z}. For a given index t, Xt represents the random variable at index t. We use {Xt} or simply X to represent the complete stochastic process. We useXt:s to indicate the random vector corresponding to the restriction of the time series to the integer interval [t .. s]. We use Xt:s to indicate the random vector corresponding to the restriction of the time series to the integer interval [t .. s]. Assuming X is a zero mean stationary process (in this paper, stationary will always stand for weakly or wide-sense stationary [5]), we will denote by Cxx(τ) = E[XtXt+τ ] the autocovariance function of the process and assume it is absolutely summable. Then, we can define its Power Spectral Density (PSD) Sxx = Ĉxx. Under these assumptions, the power of the process P (X) = E(|Xt| 2) is finite and P (X) = ∫ 1/2 −1/2 Sxx(ν)dν, such that Sxx belongs to L 1. Moreover, we recall the following basic properties for our model:\nProposition 1. Assume the weakly stationary input X is filtered by the BIBO linear system of impulse response h to provide the output Y. Then ‖h‖22 < +∞, ĥ ∈ L ∞ and Y is weakly stationary with summable autocovariance such that\nSyy(ν) = |ĥ(ν)| 2Sxx(ν), ν ∈ I (2)\nProof. Results from elementary properties of the Fourier transform and Proposition 3.1.2. in [5].\nIf such a linear filtering relationship exists for X as input and Y as output, but not in the opposite way, we can use this information to infer that X is causing Y and not the other way round. If there are such impulse responses exist for both directions, say hX→Y and hY→X, their Fourier transforms are related by\nĥX→Y = 1\nĥY→X ,\nand we have to resort to a more refined criterion for the causal inference. We will assume this situation in the remaining of the paper."
    }, {
      "heading" : "2.2 Definition of SIC",
      "text" : "Assume we are given the two processes X := {Xt, t ∈ Z} and Y := {Yt, t ∈ Z}. Moreover, we assume that exactly one of the following two alternatives is true: (1) X causes Y or (2) Y causes X. We assume that there are no unobserved common causes of X and Y. Our causal inference problem thus reduces to a binary decision. In the spirit of ICM, we assume that in case (1), X and h should not contain information about each other and our Spectral Indpendance Criterion (SIC) assumes that the input power does not correlate with the amplifying factor, that is,\n〈Sxx|ĥ| 2〉 = 〈Sxx〉〈|ĥ| 2〉 , (3)\nwhere 〈f〉 = ∫ I f(ν)dν denotes the average over the unit frequency interval I. Note that the left hand side of (eq. (3)) is the average intensity of the output signal {Yt, t ∈ Z} over all frequencies. Hence, SIC states that the average output intensity is the same as amplifying all frequencies by the average amplifying factor. To motivate why we call (eq. (3)) an independence condition we note that the difference between the left and the right hand side can be written as a covariance:\n〈Sxx · |ĥ| 2〉 − 〈Sxx〉〈|ĥ| 2〉 = Cov ( Sxx, |ĥ| 2 ) .\nwere we consider Sxx and |ĥ| 2 as functions of the random variable ν uniformly distributed on I. As a consequence statistical independence between those random variables implies that (eq. (3)) is satisfied.\nNote that the criterion (eq. (3)) can be rephrased in terms of the power spectra of X and Y\nalone using (eq. (2)), which are closer to observable quantities than ĥ:\nPostulate 1 (Spectral Independence Criterion). If Y is generated from X by a linear deterministic translation invariant system then we have:\n〈Syy〉 = 〈Sxx〉〈Syy/Sxx〉 . (4)"
    }, {
      "heading" : "2.3 Quantifying violation of SIC",
      "text" : "This motivates us to define a measure of dependence between the input PSD on one hand and transfer function of the mechanism on the other hand. To asses to what degree such a relation\nholds we introduce a scale invariant expression ρX→Y, that we call the spectral dependency ratio (SDR) from X to Y:\nρX→Y := 〈Syy〉\n〈Sxx〉〈Syy/Sxx〉 (5)\nHere, the value 1 means independence, which becomes more obvious by rewriting (eq. (5)) as\nρX→Y = Cov[Sxx, |ĥ|\n2]\n〈Sxx〉〈Syy/Sxx〉 + 1 .\nFinally, we note that ρX→Y can be written in terms of total power and energy:\nρX→Y = P (Y)\nP (X)||h||22\nWe then define ρY→X by exchanging the roles of X and Y:\nρY→X := 〈Sxx〉\n〈Syy〉〈Sxx/Syy〉 (6)"
    }, {
      "heading" : "2.4 Identifiability results",
      "text" : "In order to identify the true causal direction from SIC, it is necessary to show that ρX→Y and ρY→X take characteristic values that are informative about this inference problem. The following first result shows explicitly how dependence measures in both directions are related:\nProposition 2. (Forward-backward inequality) For a given linear filter with input PSD Sxx, output PSD Syy and a non-constant modulus transfer function ĥ we have\nρX→Y.ρY→X < 1 . (7)\nMoreover, if ∃α > 0, ∀ν ∈ I, |ĥ(ν)|2 ≤ (2− α)‖h‖22 ,\nthen\nρX→Y.ρY→X ≤\n 1 + α ∫\nI\n( |ĥ(ν)|2 − ‖h‖22\n‖h‖22\n)2 dν   −1 < 1 . (8)\nProof of this proposition is given in supplementary material. Note that ‖h‖22 corresponds to the mean value of the transfer function due to Parseval’s theorem. According to equation eq. (8), the less constant |ĥ|2 is, the more the product of the independence measures will be inferior to 1. Assuming the SIC postulate is satisfied in the forward direction such that ρX→Y = 1, it follows naturally that ρY→X < 1. The two causal directions can thus be distinguished well whenever the transfer function deviates significantly from its mean value such that ρX→YρY→X is bounded away from 1. We then infer the causal direction to be the one with the largest ρ value.\nTo further support that SDR values can be used empirically for causal inference, we need the SIC postulate to be approximately satisfied (see (eq. (4))) in systems generated according\nto the ICM principle. We now describe a model where h is generated by some random process, independently of X. To this end, assume we start with a Finite Impulse Response (FIR) h, that is, hτ = 0 for all τ ≥ m, for some m. Then h is given by m real numbers b1, . . . , bm such that\nhi = bi i = 0, . . . ,m− 1 .\nWe then apply an orthogonal transformation U, randomly drawn from the orthogonal group O(m) according to the ‘uniform distribution’ on O(m), that is, the Haar measure. In this way, we generate a new impulse response function\nh′i := (Ub)i i = 0, . . . ,m− 1 . (9)\nSince orthogonal transformations preserve the Euclidean norm by definition, they preserve the energy of the filter. Our procedure thus chooses a random filter among the set of filters having the same support of length m and the same energy. We now show that for large m the resulting filter will approximately satisfy SIC with high probability:\nTheorem 1. (concentration of measure for FIR filters) For some fixed Sxx, let ρ U X→Y be the dependence measure obtained for h′ in (eq. (9)). If U is chosen from the Haar measure on O(m), then for any given ε\n|ρUX→Y − 1| ≤ 2ε\nP (X) max ν Sxx(ν) .\nwith probability δ := 1 − exp(κ(m − 1)ε2) where κ is a positive global constant independent of m, ε, X and Y.\nProof of this theorem is provided in supplementary material. This result provides a justification for using SIC provided that the dimension of the vector of filter coefficients m is large enough. The relevance of m will be investigated in practice in the experimental section."
    }, {
      "heading" : "2.5 Relation to the Trace Condition",
      "text" : "We now describe the relation between SIC and a causal inference tool called Trace Method [10]. Let X and Y be n-dimensional variables, related by the linear structural equation\nY = AX + E ,\nwhere A is an m × n structure matrix and E is a n-dimensional noise variable independent of X . [10] postulate the following independence condition between the covariance matrix of input distribution ΣX and A:\nPostulate 2 (Trace Condition).\nτm(AΣXA T ) = τn(ΣX)τn(A TA) , (10)\napproximately, where τn(B) denotes the renormalized trace tr(B)/n.\nThe postulate can be justified by random matrix theory with large m when A and ΣX are independently chosen according to priors satisfying appropriate symmetry assumptions [10]. In the association between SIC and trace method we only consider square matrices and therefore m = n.\nTo quantify the violation of (eq. (10)) we introduce the following quantity:\nDefnition 1 (Tracial Dependency Ratio (TDR)). The tracial dependency ratio is given by\nrX→Y := τn(AΣXA\nT )\nτn(ΣX)τn(ATA) . (11)\nWe thus can see that the tracial ratio plays a role analog to our spectral dependency ratio ρ in the finite dimensional case. We can actually show that SIC can be viewed as a limit case of the Trace Condition by defining the following truncated system.\nDefnition 2. To any given infinite dimensional linear system X 7→ Y = h ∗ X, the truncated system of order N is defined by zeroing the input and the output values for integers k such that −N ≤ k < N :\nX ′ N = X−N :N−1 7→ Y ′ N = (h ∗X ′ N )−N :N−1,\nNote that in this definition for each N , the vectors Y′−N :N−1 are inherently different. The mapping defined in this way is linear and can be written as Y′ = HX′ with [H ]ij = hi−j , such that the trace method can be applied to it. We then have the following result showing that SIC can be obtained from the Trace Condition as an appropriate limit:\nTheorem 2. Let rX′ N →Y′ N represent the tracial ratio for the truncated systems of order N for a given linear system with SDR ρX→Y. Then\nlim N→∞ rX′ N →Y′ N = ρX→Y\nThe proof, together with two necessary lemmas is available in supplementary material."
    }, {
      "heading" : "3 SIC for vector autoregressive models",
      "text" : "SIC and Granger causality rely on completely different assumptions but both apply to linear time series models. In this section, we study the classical Vector Autoregressive (VAR) model used in Granger causality from the SIC perspective to better understand the relation."
    }, {
      "heading" : "3.1 VAR model",
      "text" : "We assume the observed time series are generated by a VAR model such that x Granger causes y.\nXt = ∑\nk\nakXt−k + ǫt (12)\nYt = ∑\nk\nbkYt−k + ∑\nk\nckXt−k + ξt (13)\nBoth noise terms ǫ and ξ in this expression are i.i.d normal noises."
    }, {
      "heading" : "3.2 Applying SIC to VAR models",
      "text" : "We want to rewrite this expression such that Y is obtained from X by a deterministic linear time invariant filter. We observe that the VAR model can be cast as linear time invariant filter if we neglect the additive noise ξ. Indeed, then the mechanism is the following ARX (AutoRegressive with eXogenous input) model [13].\nYt = ∑\nk\nbkYt−k + ∑\nk\nckXt−k (14)\nUsing basic properties of the Z-transform, we can derive the following analytic expressions of the input PSD Sxx:\nSxx(ν) = |n̂(ν)| 2 = |ñ(exp(2πiν))|2 ,\nwith\nñ(z) = 1\n1− ∑\nk akz −k\n.\nMoreover, the transfer function corresponding to the mechanism in equation eq. (14) is\nm̃(z) =\n∑ k ckz −k\n1− ∑\nk bkz −k\nAs a consequence, testing SIC on the VAR model in the forward direction amounts (when neglecting the filtered noise ξ), to test independence between\n|ĥ(ν)|2 = |m̃(exp(2πiν))|2 (15)\nand\nSxx(ν) = |ñ(exp(2πiν)| 2 , (16)\nwhich are parametrized by the coefficients {bk, ck} and {ak} respectively. We conjecture that a concentration of measure result similar to Theorem 1 holds stating that independent choice of the coefficients from an appropriate symmetric distribution typically yields small correlations between (eq. (15)) and (eq. (16)). This will be tested empirically in the Experiments section. Additionally, the robustness of our approach to noise in the VAR model will be addressed extensively in a longer version of this manuscript."
    }, {
      "heading" : "3.3 Comparison of SIC and Granger causality",
      "text" : "The bivariate VAR model above is the typical model where Granger causality works. To recall the idea of the latter, note that it infers that there is an influence from X to Y whenever predicting Y from its past is improved by accounting for the past of X. Rephrasing this in terms of conditional independences, X is inferred to cause Y whenever Yt is not conditionally independent\nof Xt−1, Xt−2, . . . , given Yt−1, Yt−2, . . . . Within the context of the above linear model, knowing Xt−1, Xt−2, . . . reduces the variance of Yt, given Yt−1, Yt−2, . . . because then the noise νt is the only remaining source of uncertainty. Without knowing Xt−1, Xt−2, . . . , we have additional uncertainty due to the contribution of ǫt−1, ǫt−2, . . . .\nSIC, on the other hand, does not rely on detecting whether X helps in improving the prediction of Y. As demonstrated above, SIC applied to a bivariate VAR model boils down to quantifying independence between two linear filters defined by set of coefficients, the filter generating the input with transfer function n̂ and the filter of the mechanism with transfer function m̂. This is a completely different concept. One can easily imagine that the coefficients {bk, ck} and {ak} can be hand-designed such that the functions (eq. (15)) and (eq. (16)) are correlated. This would spoil SIC, but leave Granger unaffected. On the other hand, the following subsection describes a scenario where Granger fails but SIC still works."
    }, {
      "heading" : "3.4 Sensitivity to Time Lag",
      "text" : "Consider two time series {Xt} and {Yt} where {Xt} is a white noise and\n∀t ∈ Z, Yt = cYt−1 +Xt−1,\nfor a given c. It can be easily seen that this type of input and output can be simulated using an IIR filter with (a1, a2) = (1, c) and b1 = 1 in (eq. (17)) and the rest of the coefficients are zero (please refer to the definition of coefficients in section section 4.1). The infinite DAG for this causal structure can be seen in fig. 1.\nNow if there would be a measurement delay of length k for Y, the observed values will be a new time series, say Ỹ, where Ỹt = Yt−k. Although the ground truth is X → Ỹ independent of k, Granger causality only infers the correct causal structure if k ≤ 0 (where there is a lag in measurement of X, but not Y). However SIC always infers the correct direction (except when c = 0 and the time structure is spoiled). This is because the PSD of the white noise X is constant and depends only on the total power, i.e,\nSxx(ν) = Var(Xt) = P{X} ,\nfor all ν ∈ [−1/2, 1/2]. and obviously, this constant remains the same for the lagged time series. Thus, SIC correctly identifies the causal structure (except when c = 0 in which case the dependence to time is completely spoiled)."
    }, {
      "heading" : "4 Experiments",
      "text" : "In this section we study our causal inference algorithm using synthetic experiments and apply it to several real world data sets."
    }, {
      "heading" : "4.1 Synthetic Data: ARMA filters and processes",
      "text" : "We designed synthetic experiments to assess the validity of the SIC approach. The data generating process is as follows. The LTI system S modeling the mechanism is chosen among the family of ARMA(FO,BO) filters with parameters (a,b) defined by input-output difference equation:\nyn = 1 a0 ( FO∑\ni=0\nbixn−i + BO∑\nj=1\najyn−j). (17)\nFor these filters FO is known as the feedforward order and BO is the feedback order. ai’s and bi’s are known as feedback and feedforward coefficients respectively. Note that when FO(S) = 0, the system is called and autoregressive filter. Alternatively, BO(S) = 0 corresponds to the family of Finite Impulse Response (FIR) or Moving Average filters. Whenever BO(S) 6= 0, the filter has Infinite Impulse Response (IIR). The input of the causal model will be chosen among the family of ARMA(FO,BO) processes, which are generated by filtering an i.i.d noise input with an ARMA(FO,BO) filter. We thus chose two filters S and S ′, with parameters (a,b) and (a′,b′) respectively. To simulate a cause effect pair X,Y, we generated the cause X by applying S to a normally distributed i.i.d noise. Then, we generated Y by applying S ′ to X. The feedforward and feedback orders of both systems S and S ′ were chosen identical in all experiments.\nIn each trial all the elements of vectors a, a′, b and b′ except the first ones (i.e. a0, b0, a ′ 0, b ′ 0 which were fixed to one) were sampled from an isotropic multidimensional Gaussian distribution with variance 0.01. Coefficients are sampled using rejection sampling such that only BIBO-stable filters are kept.\nWe simulated sequences of length 10000. The PSD of X and Y were estimated using Welch’s method [24]. We repeated this experiment 1000 times. Figure fig. 2 shows an example of the distribution of ρX→Y and ρY→X and of their difference using FO(S) = BO(S) = FO(S ′) = BO(S ′) = 5.\nThe SDR for the correct direction of is concentrated around one, while in the wrong direction the estimator stays less inferior to one for most of its probability mass (in this example %97.3). This results in a positive difference between SDR for most of the probability mass. Accordingly, our inference algorithm based on the sign of this difference algorithm 1 will select the correct direction in most of the cases.\nBased on this inference algorithm, we test the effect of the filter orders on the performance of the method, where we evaluate the performance of each setting of FO(S ′) and BO(S ′) over 1000 trials. We varied the orders between 2 and 21 and compared the performance of the cases FO(S ′) = BO(S ′), FO(S ′) = 0 and BO(S ′) = 0. Considering that the experiments are independent and\nbased on the assumption that our method is successful with probability p where p has a binomial distribution, we calculated confidence intervals using Wilson’s score interval [25] where α = 0.05 (and therefore zα/2 = 1.96). The performance increases rapidly with filter order, as can be seen in the plots of fig. 3. Moreover, the feedforward filter coefficients seem the most beneficial to the approach, since their absence leads to the worst performance ( fig. 3 red line)."
    }, {
      "heading" : "4.2 Real World Examples",
      "text" : "We tried our method over several examples of real data where the ground truth about the causal structure of the data is known a priori and the data is labeled in a way that the ground truth is X → Y. In the first two examples we plotted the difference of SDR in both directions as a function of the window length used in Welch method which can be seen in fig. 4."
    }, {
      "heading" : "4.2.1 Gas Furnace [4]",
      "text" : "This dataset consists in 296 time points, with X the gas rate consumed by a gas furnace and Y the produced rate of CO2. fig. 4 shows ρX→Y − ρY→X against the window length, which was ranging from 50 to 150 points. As illustrated, the difference is always positive and our method is able to correctly infer the right causal direction independent of window length. TiMiNO and Granger causality correctly identified the ground truth in this case as well [19].\nAlgorithm 1 SIC Inference\n1: procedure SIC Inference(X,Y) 2: Sxx ← spectrum of X 3: Syy ← spectrum of Y 4: Calculate ρX→Y and ρY→X using (eq. (5)) 5: Inference Step: 6: if ρX→Y > ρY→X then 7: return X → Y 8: else 9: return Y → X"
    }, {
      "heading" : "4.2.2 Old Faithful Geyser [2]",
      "text" : "N = 298 : X contains the duration of an eruption and Y is the time interval to the next eruption of the Old Faithful geyser. Figure fig. 4 represents the difference in SDRs as a function of win-\ndow length with the same configuration as the gas furnace experiment. Again the correct causal direction is inferred by our method independently from the window length as illustrated in fig. 4. In this case TiMiNO correctly identifies the cause from effect but neither linear nor non-linear Granger causality infer the correct causal direction [19]."
    }, {
      "heading" : "4.2.3 LFP recordings of the Rat Hippocampus",
      "text" : "It is known that contrary to neocortex where connectivity between areas is bidirectional, monosynaptic connections between several regions of the hippocampus are mostly unidirectional [1]. An important example of such connectivity is between the CA3 and CA1 subfields [1]. Despite this anatomical fact, a study of causality based on Local Field Potential (LFP) recordings of CA1 and CA3 of the hippocampus of the rat during sleep reports that Granger causality infers strong bidirectional relations between the two areas [3]. [3] explains the possible reasons of such result as feedback loops involving cortex and medial septum, and diffuse connections going from CA1 to CA3.\nTo do a comparison with Granger causality, we applied our framework to recordings from those regions using a publicly available dataset1 [16, 17]. LFP’s were recorded using a 8 shank probe having 64 channels downsampled to 1252Hz. Shanks were attributed by experimentalists to the CA1 and CA3 areas (leaving 32 channels for each area). For more information on the details of gathered data please refer to [17]. We used the data for rat “vvp01” during a period of sleep and a period of active behaviour in a linear environment. We applied linear Granger causality using\n1http://crcns.org/data-sets/hc\nan implementation from the statsmodel Python library2. We considered a forced decision scheme for Granger causality (to make it comparable to our method), were we select the correct Granger causal direction as the one having the lowest p-value for the null hypothesis of absence of causal influence. Following the usual methodology of causality analysis [3, 6] we divided the duration of ten minutes into 300 intervals of two seconds (N = 2504) to reduce the effect of nonstationarity in data analysis, and performed SIC causal inference on each interval for each electrode pair. We took two different approaches to report assess the performance of methods: one, based on a majority vote over all 300 intervals for each channel pair, and two, by assessing the average performance based on individual time intervals. The results are plotted as histograms in fig. 5 and they show that SIC clearly outperforms Granger causality on this dataset. The confidence intervals are once again based on Wilson score but obviously this time the in dependancy assumption between the trials is not well justified, specially for pooling all the results.\n2Statsmodels: Statistical library for Python. More details on null hypothesis for Granger causality can be found\non the website."
    }, {
      "heading" : "4.2.4 Characterizing the Echo",
      "text" : "The echo effect of a room over a sound generated in the room can be well estimated by a convolution of the real signal with a function known as room impulse response function. In this experiment we used an open source database of room Impulse Response Function (IRF) available at the Open AIR library3. We chose the IRFs for Elevden Hall, Elevden, Suffolk, England and Hamilton Mausoleum, Hamilton, Scotland. We convolved these signals with 30±5 seconds segments of two classical music pieces: the first movement of Vivaldi’s Winter Concerto consisting of 9190656 data points, and the Lacrimosa of Mozart’s Requiem, consisting of 8842752 points, both ‘.wav’ files with the rate of 44100Hz. Regardless of the segment the SDR in forward direction is considerably larger than the SDR in the backward direction as can be seen in fig. 6. In another experiment we used a computer\nto play the musical pieces above in an academic Lecture Hall (labelled as “Hall” in plots) and in an office room (labelled as “Room” in plots) and recorded the echoed version in the environment. In a series of different tests, we split the data into 9, 17, 33, 65, 129 pieces, and we ignored the last piece so that all the pieces would have an equal length. In each test we averaged the performance of our causal inference method over all the segments and plotted this performance against the size of the window length in Welch method. The window size was varied between 500 and half of the length of the music segment length (which is dependent on the number of segments). The results can be found in fig. 7 and show a very good performance of the approach for large window lengths .\n3Open AIR: Open source library for acoustic IRFs."
    }, {
      "heading" : "5 Conclusion",
      "text" : "We have introduced a causal discovery method for time series based on the SIC postulate, assuming a LTI relationship for a given pair of time series X and Y, such that either X → Y or Y → X. Theoretical justifications are provided for this postulate to lead to identifiability. Interestingly, the method provides and extension of the recently proposed Trace Method approach to the time series setting. Encouraging experimental results have been also presented on real world and synthetic data. Specially this method proved to be more effective than linear Granger causality on LFP recordings from CA1 and CA3 hippocampal areas of rat’s brain, assuming a ground truth causal direction from CA3 to CA1 based on anatomy. We suggest that this method can provide a new\nperspective for causal inference in time series based on assumptions fundamentally different from Granger causality. We will address the existence of confounders, establish a statistical significance test (for example using a procedure inspired by [26]), and extend this method to multivariate time series in future work."
    }, {
      "heading" : "6 Proof of Proposition 2",
      "text" : "Lemma 1. For f ∈ L2(I) positive, non-constant, such that 1/f ∈ L2(I), we have ∫\nI\nf(x)2dx.\n∫\nI\n1\nf(x)2 dx > 1\nProof. Using Cauchy-Schwartz inequality for the scalar product\n〈f(x) , 1\nf(x) 〉 =\n∫\nI\nf(x). 1\nf(x) dx = 1 .\nInequality is strict since f and 1/f are not collinear (otherwise f would be constant). Lemma 2. Let f ∈ L1(I) be positive, non-constant, such that 1/f ∈ L1(I) and ∫ I f(x)dx = 1.\nAssume ∃α > 0, ∀x ∈ I, f(x) ≤ 2− α ,\nthen ∫\nI\nf(x)dx.\n∫\nI\n1\nf(x) dx ≥ 1 + α\n∫\nI\n(f(x)− 1)2dx\nProof. We denote s(x) = f(x)− 1. Then ∫ I s(x)dx = 0 and\n∫\nI\nf(x)dx.\n∫\nI\n1\nf(x) dx− 1 =\n∫\nI\n−s(x)\n1 + s(x) dx\nFor x > −1, we have\n−x\n1 + x ≥ x2 − x3 − x. (18)\nThe function on the l.h.s. of (eq. (18)) is convex because its second order derivative 2(1+x)3 is positive and using its tangent in x = 0, we get ∫\nI\nf(x)dx.\n∫\nI\n1\nf(x) dx− 1 ≥\n∫\nI\ns(x)2(1− s(x))dx\nSince 1− s(x) = 2− f(x) ≥ α > 0, ∫\nI\nf(x)dx.\n∫\nI\n1\nf(x) dx− 1 ≥ α\n∫\nI\ns(x)2dx\nProof of Proposition 2. By using the definition of Spectral Dependency Ratios and Lemma 1 we get\nρX→YρY→X = 1\n〈|ĥ|2〉〈1/|ĥ|2〉 < 1\nMoreover, applying Lemma 2 to f = |ĥ|2/ ∫ I |ĥ| 2 = |ĥ|2/‖h‖22 we get inequality eq. (8)."
    }, {
      "heading" : "7 Proof of Theorem 1",
      "text" : "To prove this theorem we rely on a theorem from [10] and a corollary that we derive from it.\nTheorem 3 (concentration of measure for finite dimensional linear relationships). [10] Suppose Σ is a given covariance matrix and suppose A ∈ Mn×m(R) is also a given matrix. Then if one generates ΣX = UΣU ⊤ by uniformly choosing an orthogonal matrix U from O(n) then ΣX together with A, satisfies trace condition in probability when n tends to infinity. More precisely for a given ε there exist δ := 1− exp(κ(n− 1)ε2), κ being a constant where\n|τm(AΣXA ⊤)− τn(ΣX)τm(AA ⊤)| = |τm(AUΣU ⊤A⊤)− τn(Σ)τm(AA ⊤)| ≤ 2ε‖Σ‖‖AA⊤‖\nholds with probability δ.\nIn the above theorem (and the rest of the document), ‖.‖ applied to a matrix will refer to the\noperator norm. The following corollary is a direct consequence of the previous theorem:\nCorollary 1. Suppose Σ is a given covariance matrix and suppose A ∈ Mn×m(R) is also a given matrix. Then if one generates AU = AU by uniformly choosing an orthogonal matrix U from O(n) then AU together with Σ, satisfies trace condition in probability when n tends to infinity More precisely for a given ε there exist δ := 1− exp(κ(n− 1)ε2), κ being a constant where\n|τm(AUΣA ⊤ U )− τn(ΣX)τm(AA ⊤)| =\n|τm(AUΣU ⊤A⊤)− τn(Σ)τm(AA ⊤)| ≤ 2ε‖Σ‖‖AA⊤‖\nholds with probability δ.\nTo prove the main theorem we will also need two lemmas that are stated below.\nLemma 3. [22] For a given Hermitian matrix H and any principal submatrix of H, H ′, their spectral radius ρs satisfies\nρs(H) ≥ ρs(H ′).\nLemma 4. [9] Let f : [− 12 , 1 2 ) → R f ∈ L 1 be a bounded function and suppose tk is its Fourier series coefficients, i.e.\ntk =\n∫ 1 2\n− 1 2\nf(ν)ei2πkνdν, t ∈ Z.\nConsider Toeplitz matrices Tn defined as\n[Tn]ij = ti−j i, j ∈ {0, ..., n− 1}\nwith eigenvalues τn,k(0 ≤ k ≤ n− 1). Then if ti are absolutely summable we get:\nmin x∈[− 1 2 , 1 2 ) f(x) ≤ τn,i ≤ max x∈[− 1 2 , 1 2 ) f(x)\nProof of Theorem 1. Without loss of generality and for the sake of simplicity we only consider the positive indices of the time series and we take the filter to be causal; other cases can be treated in a similar way. Then the following relation holds between input and output of the filter:\n∀i, 0 ≤ i ≤ N − 1 Yi =\nm−1∑\nj=0\nbjXi−j\nFormulated in terms of matrices the above relation can be represented as   Y0 Y1 ...\nYN−2 YN−1\n  = B   X−m+1 X−m+2 ...\nXN−2 XN−1\n  ,\nwhere B is a N × (N +m− 1) matrix as follows:   bm−1 bm−2 · · · b0 0 · · · 0 0 0 bm−1 · · · b1 b0 · · · 0 0 . . .\n0 0 · · · bm−1 · · · b1 b0 0 0 0 · · · 0 bm−1 · · · b1 b0\n \nWe define ΣiX ∈ Mm×m(R) to be the covariance matrices as follows:\n∀i 0 ≤ i ≤ N − 1 0 ≤ j, k ≤ m− 1 [ΣiX ]jk =\nCov(Xi+j , Xi+k)\nSince the time series that we are dealing with are weakly stationary it is obvious that ΣiX is independent of i. If we take ΣX0:N−1 ,ΣY0:N−1 ∈ MN×N(R) to be the covariance matrices for X0:N−1 and Y0:N−1 respectively, then we have\nΣY0:N−1 = BΣX−m+1:N−1B ⊤\nAlso define ΣUY0:N−1 to be the covariance matrix of the output for FIR S ′ with b′ = U⊤b. Also assume the spectrum of the output for this filter is SUyy. One can write diagonal elements of ΣY0:N−1 and ΣUY0:N−1 based on the above equation as follows:\n[ΣY0:N−1]ii = b ⊤ΣiXb, [Σ U Y0:N−1 ]ii = b ⊤UΣiXU ⊤b\nand therefore the normalized traces of ΣY0:N−1 and Σ U Y0:N−1 can be written as\nτN (ΣY0:N−1) = 1\nN b⊤\nN−1∑\ni=0\nΣiXb,\nτN (Σ U Y0:N−1) =\n1\nN b⊤U\nN−1∑\ni=0\nΣiXU ⊤b\nDefine Σ := ∑N−1\ni=0 Σ i X = Σ 0 X . Taking A = b ⊤ in corollary corollary 1 for a randomly selected U\nwe get\n| 1\nN b⊤UΣU⊤b−\n1\nN τm(Σ)〈b,b〉| ≤ 2ε‖Σ‖\n√ 〈b,b〉\nand therefore\n|τN (Σ U Y0:N−1)−\n1\nN τm(Σ)‖b‖\n2 2| ≤ 2ε‖Σ‖‖b‖ 2 2 (19)\nwith probability δ. On the other hand the elements of diagonals of ΣiX ’s are CX(0). Therefore:\n1\nN τm(Σ) =\nmNCX(0)\nmN = P (X)\nSince ΣiX ’s are principal submatrices of ΣX0:N−1 therefore by corollary lemma 3\n‖Σ‖ = ρ(Σ) = ‖ 1\nN\nN−1∑\ni=0\nΣiX‖ ≤ 1\nN\nN−1∑\ni=0\n‖ΣiX‖ ≤ ρ(ΣX0:N−1).\nBecause CX(τ)’s are absolutely summable we apply lemma lemma 4 and we get\nρ(ΣX0:N−1) ≤ max ν Sxx(ν),\nsuch that inequality eq. (19) can be rewritten\n| τN (Σ U Y0:N−1 )\nP (X)‖b‖22 − 1| ≤ 2\nε\nP (X) ‖Σ‖\nwhich completes the proof."
    }, {
      "heading" : "8 Proof of Theorem 2",
      "text" : "In this section we give a proof that the TDR (see eq. eq. (11)) asymptotically approaches the SDR (see eq. eq. (5)). We first state and prove two lemmas that are used to derive this result. As before suppose {Xt} and {Yt} are given input and output of an LTI filter that are related through the impulse response function {ht}. According to the definition of the truncated linear systems\n(see definition definition 2) of order N for the linear system above we get the following matrix relationship:\n  Y ′−N Y ′−N+1 ...\nY ′N−2 Y ′N−1\n  =   h0 h−1 · · · h−2N+1 h1 h0 · · · h−2N+2 ...\nh2N−2 h2N−3 · · · h−1 h2N−1 h2N−2 · · · h0\n    X−N X−N+1 ...\nXN−2 XN−1\n  .\nIf we name the vector on the left as yN , the matrix as H N and the right vector as xN then the associated TDR yields:\nrxN→yN = τN (ΣyN )\nτN (ΣxN )τ2N (H NHN\nT )\n(20)\nDefine TN := τ2N (H NHN ⊤ ). Now we show that TN converges to ‖h‖ 2 2 the energy of the impulse response.\nLemma 5. Assume ‖h‖22 < +∞, then\nlim N→+∞\nTN = ‖h‖ 2 2\nProof. First lets simplify the expression for TN :\nTN := τ2N (H NHN ⊤ ) =\n1\n2N\n∑\ni,j\n[HN ]2ij =\n2N−1∑\nk=−2N+1\n|hk| 2 2N − |k|\n2N =\n−1∑\nk=−2N+1\n|hk| 2 2N − |k|\n2N +\n2N−1∑\nk=0\n|hk| 2 2N − |k|\n2N . (21)\nIt is easy to see that TN is an increasing sequence of N . Moreover it is bounded by\n∞∑\n−∞\n|hk| 2 < ∞.\nTherefore this series converges. In order to show that it converges to ‖h‖2, we first notice that for a given ε, there exist m0 ∈ N such that\n∀m > m0 |\nm∑\nk=−m\n|hk| 2 − ‖h‖2| < ε. (22)\nNow take Nm0 > m02\nm0+1|hm0 | 2\nε . We have\nNm0 > m02\nm0+1|hm0 | 2\nε ⇒\n|hm0 | 2m0\n2Nm0 <\nε\n2m0+2 .\nSame can be done for any 0 ≤ k ≤ m0, i.e. there exist Nk such that:\n|hk| 2k\n2Nk <\nε\n2k+2\nNow take Nmax = max{N0, N1, ..., Nm0}+ 1. Then obviously we get:\n∣∣∣∣|hk|2 − |hk| 2(2Nmax − k)\n2Nmax\n∣∣∣∣ < ε\n2k+2\nAnd therefore:\nm0∑\nk=0\n∣∣∣∣|hk|2 − |hk| 2(2Nmax − k)\n2Nmax\n∣∣∣∣ < m0∑\nk=0\nε\n2k+2 <\nε 2 . (23)\nSimilar results hold for the first sum term in (eq. (21)) and by taking the maximum of two Nmax’s (say N ′max) and considering the fact that TN is increasing and by the application of triangular inequality for (eq. (22)), we can easily infer that\n∀N > N ′max ∣∣TN − ‖h‖2 ∣∣ < ε.\nIn order to get the main result, we also need to prove that Y ′k’s in (section 8) are asymptotically\nconverging to Yk’s in the following sense:\nLemma 6. Suppose an LTI filter S with zero mean weakly stationary processes as input ({Xt}) and output ({Yt}) and impulse response function {ht} has been given. Then for the truncated linear systems we have:\nlim N→∞ |τ(ΣY−N :N−1)− τ(ΣY ′ −N :N−1 )| = 0,\nProof. For simplicity of calculations we name 2N dimensional random vectors Y ′−N :N−1 and Y−N :N−1 as Y ′ and Y and their covariance matrices with ΣY ′ and ΣY respectively. Then we have: ∣∣∣τ(ΣY−N :N−1)− τ(ΣY ′ −N :N−1 ) ∣∣∣ = ∣∣∣τ(E(Y Y ⊤))− τ(E(Y ′Y ′⊤)) ∣∣∣ ∗= 1\n2N\n∣∣E(Y ⊤Y )− E(Y ′⊤Y ′) ∣∣ =\n1\n2N\n∣∣E ( (Y − Y ′)⊤(Y + Y ′) )∣∣ ≤ 1 2N E ∣∣(Y − Y ′)⊤(Y + Y ′) ∣∣ ≤ 1\n2N E\n(√ (Y − Y ′)⊤(Y − Y ′)× √ (Y + Y ′)⊤(Y + Y ′) ) ≤\n1\n2N\n√ E((Y − Y ′)⊤(Y − Y ′)) × √ E((Y + Y ′)⊤(Y + Y ′)) =\n√ 1\n2N E((Y − Y ′)⊤(Y − Y ′))×\n√ 1\n2N E((Y + Y ′)⊤(Y + Y ′))\n∗∗ = √ τ(ΣY −Y ′) √ τ(ΣY +Y ′)\nwhere (*) and (**) follows from the fact that one can take trace (or normalized trace) into expectation and vice versa, and moreover from the fact that tr(AB) = tr(BA) for any two matrices\nthat their multiplication is well defined. The inequalities are the result of the application of Cauchy-Schwartz inequality for covariances of random variables. First we show that √ τ(ΣY +Y ′) is bounded as a function of N . Define {h (j) t } as follows\nh (j) t =\n{ 2ht if −N ≤ t+ j ≤ N − 1\nht otherwise .\nWe can bound each element of diagonal of ΣY +Y ′ as follows\n[ΣY +Y ′ ]jj = E [ (Yj + Y ′ j ) 2 ] = E [ ( ∞∑\nl=−∞\nXj−lh (j) l )\n2 ] ≤ E [ ( ∞∑\nl=−∞\n|Xj−l||h (j) l |)\n2 ] ≤\n4E [ ( ∞∑\nl=−∞\n|Xj−l||hl|) 2 ] = 4CY (0),\nand therefore τ(ΣY +Y ′) is bounded.\nNow we show that each element of diagonal of ΣY −Y ′ tends to zero when N tends to infinity\nwhich will complete the proof. With overload of notation, in this case define {h (j) t } as follows\nh (j) t =\n{ 0 if −N ≤ t+ j ≤ N − 1\nht otherwise.\nThen for the j-th element of diagonal of ΣY−Y ′ we have\n[ΣY −Y ′ ]jj = E [ (Yj − Y ′ j ) 2 ] = E [ ( ∞∑\nl=−∞\nXj−lh (j) l )\n2 ] = E [ ( ∑\nl≥N−j l<−N−j\nXj−lhl) 2 ]\nSince autocorrelation function attains its maximum at t = 0 and\n∀i, j ∈ Z, E(XiXj) ≤ √ E(X2i )E(X 2 j )\nwe get:\n∀i, j ∈ Z, E(XiXj) ≤ E(X 2 0 ).\nAs a result we have:\n[ΣY−Y ′ ]jj = E [ ( ∑\nl≥N−j l<−N−j\nXj−lhl) 2 ] ≤\n∑\nl,l′≥N−j l,l′<−N−j\nE(X20 )hlhl′ = E(X 2 0 )\n∑\nl,l′≥N−j l,l′<−N−j\nhlhl′ ≤\nE(X20 )( ∑\nl≥N−j l<−N−j\nhl) 2 ≤ E(X20 )(\n∑\nl≥N−j l<−N−j\n|hl|) 2\nNow since {ht} is absolutely convergent, it follows that [ΣY−Y ′ ]jj can be arbitrarily reduced by increasing N . Then it follows that τ(ΣY −Y ′) approaches to zero when N tends to infinity.\nFinally to complete the proof of the theorem regarding the asymptotic behaviour of trace condition in the truncated linear systems and the equivalence of trace condition (see postulate postulate 2) to SIC, we need one of the convergence theorems due to Szegö:\nTheorem 4 (Szegö’s convergence theorem). [9] Let f : [− 12 , 1 2 ) → R f ∈ L 1 be a bounded function and suppose tk’s are its Fourier series coefficients, i.e.\ntk =\n∫ 1 2\n− 1 2\nf(ν)ei2πkνdν, t ∈ Z.\nConsider Toeplitz matrices Tn defined as\n[Tn]ij = ti−j i, j ∈ {0, ..., n− 1}\nwith eigenvalues τn,k(0 ≤ k ≤ n − 1). Then if Tn’s are Hermitian, i.e. ti = t̄i for any i, then for any continuous function F we have:\nlim n→∞\n1 n\nn−1∑\nk=0\nF (τn,k) =\n∫ 1 2\n− 1 2\nF (f(ν))dν\nWe are ready to state our convergence theorem:\nTheorem 5. For a given truncated linear time series, rX′ N →Y′ N asymptotically approaches to the spectral values of time series on infinite domain. As a result the spectral density based estimator coincides with the trace based estimator in the limit, and more precisely\nlim N→∞ τ(ΣxN) =\n1 2∫\n− 1 2\nSxx(ν)dν, lim N→∞ τ(ΣyN) =\n1 2∫\n− 1 2\nSyy(ν)dν,\nand lim N→∞ TN =\n1 2∫\n− 1 2\n|ĥ(ν)|2dν,\nwhere TN is defined as in (eq. (21)). And eventually:\nlim n→∞ rX′ N →Y′ N = ρX→Y lim n→∞ rY′ N →X′ N = ρY→X\nProof. Both ΣxN and ΣyN are hermitian Toeplitz matrices and based on theorem theorem 4 where F has been chosen as identity function and also applying lemma lemma 6 we get:\nlim N→∞ τ(ΣxN) =\n1 2∫\n− 1 2\nSxx(ν)dν (24)\nlim N→∞ τ(ΣyN) =\n1 2∫\n− 1 2\nSyy(ν)dν (25)\nMoreover by Plancherel’s theorem and lemma lemma 5 it follows that:\nlim N→∞\nTN = ‖h‖ 2 2 =\n1 2∫\n− 1 2\n|ĥ(ν)|2dν (26)\nThis theorem therefore shows that the trace ratios calculated for windowed version of time series are nothing but estimates of the spectral ratios and therefore justifies that these two different methods for causal inference are indeed consistent with each other."
    } ],
    "references" : [ ],
    "referenceMentions" : [ ],
    "year" : 2015,
    "abstractText" : "<lb>Inferring a cause from its effect using observed time series data is a major challenge in natural<lb>and social sciences. Assuming the effect is generated by the cause trough a linear system,<lb>we propose a new approach based on the hypothesis that nature chooses the “cause” and the<lb>“mechanism that generates the effect from the cause” independent of each other. We therefore<lb>postulate that the power spectrum of the time series being the cause is uncorrelated with the<lb>square of the transfer function of the linear filter generating the effect. While most causal<lb>discovery methods for time series mainly rely on the noise, our method relies on asymmetries of<lb>the power spectral density properties that can be exploited even in the context of deterministic<lb>systems. We describe mathematical assumptions in a deterministic model under which the<lb>causal direction is identifiable with this approach. We also discuss the method’s performance<lb>under the additive noise model and its relationship to Granger causality. Experiments show<lb>encouraging results on synthetic as well as real-world data. Overall, this suggests that the<lb>postulate of Independence of Cause and Mechanism is a promising principle for causal inference<lb>on empirical time series.",
    "creator" : "LaTeX with hyperref package"
  }
}